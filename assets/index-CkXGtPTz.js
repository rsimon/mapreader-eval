import{g as vn,O as Pn,n as Un,H as Hn}from"./dep-annotorious-BWTC6M25.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var le={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/var Dn=le.exports,He;function Fn(){return He||(He=1,function(t,e){((n,r)=>{t.exports=r()})(Dn,function n(){var r=typeof self<"u"?self:typeof window<"u"?window:r!==void 0?r:{},i,s=!r.document&&!!r.postMessage,o=r.IS_PAPA_WORKER||!1,u={},l=0,a={};function p(f){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(h){var y=H(h);y.chunkSize=parseInt(y.chunkSize),h.step||h.chunk||(y.chunkSize=null),this._handle=new x(y),(this._handle.streamer=this)._config=y}).call(this,f),this.parseChunk=function(h,y){var w=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<w){let N=this._config.newline;N||(v=this._config.quoteChar||'"',N=this._handle.guessLineEndings(h,v)),h=[...h.split(N).slice(w)].join(N)}this.isFirstChunk&&_(this._config.beforeFirstChunk)&&(v=this._config.beforeFirstChunk(h))!==void 0&&(h=v),this.isFirstChunk=!1,this._halted=!1;var w=this._partialLine+h,v=(this._partialLine="",this._handle.parse(w,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(h=v.meta.cursor,w=(this._finished||(this._partialLine=w.substring(h-this._baseIndex),this._baseIndex=h),v&&v.data&&(this._rowCount+=v.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),o)r.postMessage({results:v,workerId:a.WORKER_ID,finished:w});else if(_(this._config.chunk)&&!y){if(this._config.chunk(v,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=v=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(v.data),this._completeResults.errors=this._completeResults.errors.concat(v.errors),this._completeResults.meta=v.meta),this._completed||!w||!_(this._config.complete)||v&&v.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),w||v&&v.meta.paused||this._nextChunk(),v}this._halted=!0},this._sendError=function(h){_(this._config.error)?this._config.error(h):o&&this._config.error&&r.postMessage({workerId:a.WORKER_ID,error:h,finished:!1})}}function d(f){var h;(f=f||{}).chunkSize||(f.chunkSize=a.RemoteChunkSize),p.call(this,f),this._nextChunk=s?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(y){this._input=y,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(h=new XMLHttpRequest,this._config.withCredentials&&(h.withCredentials=this._config.withCredentials),s||(h.onload=A(this._chunkLoaded,this),h.onerror=A(this._chunkError,this)),h.open(this._config.downloadRequestBody?"POST":"GET",this._input,!s),this._config.downloadRequestHeaders){var y,w=this._config.downloadRequestHeaders;for(y in w)h.setRequestHeader(y,w[y])}var v;this._config.chunkSize&&(v=this._start+this._config.chunkSize-1,h.setRequestHeader("Range","bytes="+this._start+"-"+v));try{h.send(this._config.downloadRequestBody)}catch(N){this._chunkError(N.message)}s&&h.status===0&&this._chunkError()}},this._chunkLoaded=function(){h.readyState===4&&(h.status<200||400<=h.status?this._chunkError():(this._start+=this._config.chunkSize||h.responseText.length,this._finished=!this._config.chunkSize||this._start>=(y=>(y=y.getResponseHeader("Content-Range"))!==null?parseInt(y.substring(y.lastIndexOf("/")+1)):-1)(h),this.parseChunk(h.responseText)))},this._chunkError=function(y){y=h.statusText||y,this._sendError(new Error(y))}}function m(f){(f=f||{}).chunkSize||(f.chunkSize=a.LocalChunkSize),p.call(this,f);var h,y,w=typeof FileReader<"u";this.stream=function(v){this._input=v,y=v.slice||v.webkitSlice||v.mozSlice,w?((h=new FileReader).onload=A(this._chunkLoaded,this),h.onerror=A(this._chunkError,this)):h=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var v=this._input,N=(this._config.chunkSize&&(N=Math.min(this._start+this._config.chunkSize,this._input.size),v=y.call(v,this._start,N)),h.readAsText(v,this._config.encoding));w||this._chunkLoaded({target:{result:N}})},this._chunkLoaded=function(v){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(v.target.result)},this._chunkError=function(){this._sendError(h.error)}}function T(f){var h;p.call(this,f=f||{}),this.stream=function(y){return h=y,this._nextChunk()},this._nextChunk=function(){var y,w;if(!this._finished)return y=this._config.chunkSize,h=y?(w=h.substring(0,y),h.substring(y)):(w=h,""),this._finished=!h,this.parseChunk(w)}}function $(f){p.call(this,f=f||{});var h=[],y=!0,w=!1;this.pause=function(){p.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){p.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(v){this._input=v,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){w&&h.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),h.length?this.parseChunk(h.shift()):y=!0},this._streamData=A(function(v){try{h.push(typeof v=="string"?v:v.toString(this._config.encoding)),y&&(y=!1,this._checkIsFinished(),this.parseChunk(h.shift()))}catch(N){this._streamError(N)}},this),this._streamError=A(function(v){this._streamCleanUp(),this._sendError(v)},this),this._streamEnd=A(function(){this._streamCleanUp(),w=!0,this._streamData("")},this),this._streamCleanUp=A(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function x(f){var h,y,w,v,N=Math.pow(2,53),O=-N,E=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,P=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,b=this,D=0,C=0,F=!1,R=!1,M=[],S={data:[],errors:[],meta:{}};function J(K){return f.skipEmptyLines==="greedy"?K.join("").trim()==="":K.length===1&&K[0].length===0}function V(){if(S&&w&&(xt("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),w=!1),f.skipEmptyLines&&(S.data=S.data.filter(function(X){return!J(X)})),at()){let X=function(rt,ft){_(f.transformHeader)&&(rt=f.transformHeader(rt,ft)),M.push(rt)};if(S)if(Array.isArray(S.data[0])){for(var K=0;at()&&K<S.data.length;K++)S.data[K].forEach(X);S.data.splice(0,1)}else S.data.forEach(X)}function tt(X,rt){for(var ft=f.header?{}:[],et=0;et<X.length;et++){var st=et,B=X[et],B=((G,Z)=>(lt=>(f.dynamicTypingFunction&&f.dynamicTyping[lt]===void 0&&(f.dynamicTyping[lt]=f.dynamicTypingFunction(lt)),(f.dynamicTyping[lt]||f.dynamicTyping)===!0))(G)?Z==="true"||Z==="TRUE"||Z!=="false"&&Z!=="FALSE"&&((lt=>{if(E.test(lt)&&(lt=parseFloat(lt),O<lt&&lt<N))return 1})(Z)?parseFloat(Z):P.test(Z)?new Date(Z):Z===""?null:Z):Z)(st=f.header?et>=M.length?"__parsed_extra":M[et]:st,B=f.transform?f.transform(B,st):B);st==="__parsed_extra"?(ft[st]=ft[st]||[],ft[st].push(B)):ft[st]=B}return f.header&&(et>M.length?xt("FieldMismatch","TooManyFields","Too many fields: expected "+M.length+" fields but parsed "+et,C+rt):et<M.length&&xt("FieldMismatch","TooFewFields","Too few fields: expected "+M.length+" fields but parsed "+et,C+rt)),ft}var nt;S&&(f.header||f.dynamicTyping||f.transform)&&(nt=1,!S.data.length||Array.isArray(S.data[0])?(S.data=S.data.map(tt),nt=S.data.length):S.data=tt(S.data,0),f.header&&S.meta&&(S.meta.fields=M),C+=nt)}function at(){return f.header&&M.length===0}function xt(K,tt,nt,X){K={type:K,code:tt,message:nt},X!==void 0&&(K.row=X),S.errors.push(K)}_(f.step)&&(v=f.step,f.step=function(K){S=K,at()?V():(V(),S.data.length!==0&&(D+=K.data.length,f.preview&&D>f.preview?y.abort():(S.data=S.data[0],v(S,b))))}),this.parse=function(K,tt,nt){var X=f.quoteChar||'"',X=(f.newline||(f.newline=this.guessLineEndings(K,X)),w=!1,f.delimiter?_(f.delimiter)&&(f.delimiter=f.delimiter(K),S.meta.delimiter=f.delimiter):((X=((rt,ft,et,st,B)=>{var G,Z,lt,z;B=B||[",","	","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var L=0;L<B.length;L++){for(var Tt,St=B[L],dt=0,Ot=0,_t=0,wt=(lt=void 0,new I({comments:st,delimiter:St,newline:ft,preview:10}).parse(rt)),It=0;It<wt.data.length;It++)et&&J(wt.data[It])?_t++:(Tt=wt.data[It].length,Ot+=Tt,lt===void 0?lt=Tt:0<Tt&&(dt+=Math.abs(Tt-lt),lt=Tt));0<wt.data.length&&(Ot/=wt.data.length-_t),(Z===void 0||dt<=Z)&&(z===void 0||z<Ot)&&1.99<Ot&&(Z=dt,G=St,z=Ot)}return{successful:!!(f.delimiter=G),bestDelimiter:G}})(K,f.newline,f.skipEmptyLines,f.comments,f.delimitersToGuess)).successful?f.delimiter=X.bestDelimiter:(w=!0,f.delimiter=a.DefaultDelimiter),S.meta.delimiter=f.delimiter),H(f));return f.preview&&f.header&&X.preview++,h=K,y=new I(X),S=y.parse(h,tt,nt),V(),F?{meta:{paused:!0}}:S||{meta:{paused:!1}}},this.paused=function(){return F},this.pause=function(){F=!0,y.abort(),h=_(f.chunk)?"":h.substring(y.getCharIndex())},this.resume=function(){b.streamer._halted?(F=!1,b.streamer.parseChunk(h,!0)):setTimeout(b.resume,3)},this.aborted=function(){return R},this.abort=function(){R=!0,y.abort(),S.meta.aborted=!0,_(f.complete)&&f.complete(S),h=""},this.guessLineEndings=function(rt,X){rt=rt.substring(0,1048576);var X=new RegExp(k(X)+"([^]*?)"+k(X),"gm"),nt=(rt=rt.replace(X,"")).split("\r"),X=rt.split(`
`),rt=1<X.length&&X[0].length<nt[0].length;if(nt.length===1||rt)return`
`;for(var ft=0,et=0;et<nt.length;et++)nt[et][0]===`
`&&ft++;return ft>=nt.length/2?`\r
`:"\r"}}function k(f){return f.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function I(f){var h=(f=f||{}).delimiter,y=f.newline,w=f.comments,v=f.step,N=f.preview,O=f.fastMode,E=null,P=!1,b=f.quoteChar==null?'"':f.quoteChar,D=b;if(f.escapeChar!==void 0&&(D=f.escapeChar),(typeof h!="string"||-1<a.BAD_DELIMITERS.indexOf(h))&&(h=","),w===h)throw new Error("Comment character same as delimiter");w===!0?w="#":(typeof w!="string"||-1<a.BAD_DELIMITERS.indexOf(w))&&(w=!1),y!==`
`&&y!=="\r"&&y!==`\r
`&&(y=`
`);var C=0,F=!1;this.parse=function(R,M,S){if(typeof R!="string")throw new Error("Input must be a string");var J=R.length,V=h.length,at=y.length,xt=w.length,K=_(v),tt=[],nt=[],X=[],rt=C=0;if(!R)return dt();if(O||O!==!1&&R.indexOf(b)===-1){for(var ft=R.split(y),et=0;et<ft.length;et++){if(X=ft[et],C+=X.length,et!==ft.length-1)C+=y.length;else if(S)return dt();if(!w||X.substring(0,xt)!==w){if(K){if(tt=[],z(X.split(h)),Ot(),F)return dt()}else z(X.split(h));if(N&&N<=et)return tt=tt.slice(0,N),dt(!0)}}return dt()}for(var st=R.indexOf(h,C),B=R.indexOf(y,C),G=new RegExp(k(D)+k(b),"g"),Z=R.indexOf(b,C);;)if(R[C]===b)for(Z=C,C++;;){if((Z=R.indexOf(b,Z+1))===-1)return S||nt.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:tt.length,index:C}),Tt();if(Z===J-1)return Tt(R.substring(C,Z).replace(G,b));if(b===D&&R[Z+1]===D)Z++;else if(b===D||Z===0||R[Z-1]!==D){st!==-1&&st<Z+1&&(st=R.indexOf(h,Z+1));var lt=L((B=B!==-1&&B<Z+1?R.indexOf(y,Z+1):B)===-1?st:Math.min(st,B));if(R.substr(Z+1+lt,V)===h){X.push(R.substring(C,Z).replace(G,b)),R[C=Z+1+lt+V]!==b&&(Z=R.indexOf(b,C)),st=R.indexOf(h,C),B=R.indexOf(y,C);break}if(lt=L(B),R.substring(Z+1+lt,Z+1+lt+at)===y){if(X.push(R.substring(C,Z).replace(G,b)),St(Z+1+lt+at),st=R.indexOf(h,C),Z=R.indexOf(b,C),K&&(Ot(),F))return dt();if(N&&tt.length>=N)return dt(!0);break}nt.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:tt.length,index:C}),Z++}}else if(w&&X.length===0&&R.substring(C,C+xt)===w){if(B===-1)return dt();C=B+at,B=R.indexOf(y,C),st=R.indexOf(h,C)}else if(st!==-1&&(st<B||B===-1))X.push(R.substring(C,st)),C=st+V,st=R.indexOf(h,C);else{if(B===-1)break;if(X.push(R.substring(C,B)),St(B+at),K&&(Ot(),F))return dt();if(N&&tt.length>=N)return dt(!0)}return Tt();function z(_t){tt.push(_t),rt=C}function L(_t){var wt=0;return wt=_t!==-1&&(_t=R.substring(Z+1,_t))&&_t.trim()===""?_t.length:wt}function Tt(_t){return S||(_t===void 0&&(_t=R.substring(C)),X.push(_t),C=J,z(X),K&&Ot()),dt()}function St(_t){C=_t,z(X),X=[],B=R.indexOf(y,C)}function dt(_t){if(f.header&&!M&&tt.length&&!P){var wt=tt[0],It=Object.create(null),fe=new Set(wt);let Pe=!1;for(let Xt=0;Xt<wt.length;Xt++){let Mt=wt[Xt];if(It[Mt=_(f.transformHeader)?f.transformHeader(Mt,Xt):Mt]){let te,Ue=It[Mt];for(;te=Mt+"_"+Ue,Ue++,fe.has(te););fe.add(te),wt[Xt]=te,It[Mt]++,Pe=!0,(E=E===null?{}:E)[te]=Mt}else It[Mt]=1,wt[Xt]=Mt;fe.add(Mt)}Pe&&console.warn("Duplicate headers found and renamed."),P=!0}return{data:tt,errors:nt,meta:{delimiter:h,linebreak:y,aborted:F,truncated:!!_t,cursor:rt+(M||0),renamedHeaders:E}}}function Ot(){v(dt()),tt=[],nt=[]}},this.abort=function(){F=!0},this.getCharIndex=function(){return C}}function Y(f){var h=f.data,y=u[h.workerId],w=!1;if(h.error)y.userError(h.error,h.file);else if(h.results&&h.results.data){var v={abort:function(){w=!0,U(h.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:j,resume:j};if(_(y.userStep)){for(var N=0;N<h.results.data.length&&(y.userStep({data:h.results.data[N],errors:h.results.errors,meta:h.results.meta},v),!w);N++);delete h.results}else _(y.userChunk)&&(y.userChunk(h.results,v,h.file),delete h.results)}h.finished&&!w&&U(h.workerId,h.results)}function U(f,h){var y=u[f];_(y.userComplete)&&y.userComplete(h),y.terminate(),delete u[f]}function j(){throw new Error("Not implemented.")}function H(f){if(typeof f!="object"||f===null)return f;var h,y=Array.isArray(f)?[]:{};for(h in f)y[h]=H(f[h]);return y}function A(f,h){return function(){f.apply(h,arguments)}}function _(f){return typeof f=="function"}return a.parse=function(f,h){var y=(h=h||{}).dynamicTyping||!1;if(_(y)&&(h.dynamicTypingFunction=y,y={}),h.dynamicTyping=y,h.transform=!!_(h.transform)&&h.transform,!h.worker||!a.WORKERS_SUPPORTED)return y=null,a.NODE_STREAM_INPUT,typeof f=="string"?(f=(w=>w.charCodeAt(0)!==65279?w:w.slice(1))(f),y=new(h.download?d:T)(h)):f.readable===!0&&_(f.read)&&_(f.on)?y=new $(h):(r.File&&f instanceof File||f instanceof Object)&&(y=new m(h)),y.stream(f);(y=(()=>{var w;return!!a.WORKERS_SUPPORTED&&(w=(()=>{var v=r.URL||r.webkitURL||null,N=n.toString();return a.BLOB_URL||(a.BLOB_URL=v.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",N,")();"],{type:"text/javascript"})))})(),(w=new r.Worker(w)).onmessage=Y,w.id=l++,u[w.id]=w)})()).userStep=h.step,y.userChunk=h.chunk,y.userComplete=h.complete,y.userError=h.error,h.step=_(h.step),h.chunk=_(h.chunk),h.complete=_(h.complete),h.error=_(h.error),delete h.worker,y.postMessage({input:f,config:h,workerId:y.id})},a.unparse=function(f,h){var y=!1,w=!0,v=",",N=`\r
`,O='"',E=O+O,P=!1,b=null,D=!1,C=((()=>{if(typeof h=="object"){if(typeof h.delimiter!="string"||a.BAD_DELIMITERS.filter(function(M){return h.delimiter.indexOf(M)!==-1}).length||(v=h.delimiter),typeof h.quotes!="boolean"&&typeof h.quotes!="function"&&!Array.isArray(h.quotes)||(y=h.quotes),typeof h.skipEmptyLines!="boolean"&&typeof h.skipEmptyLines!="string"||(P=h.skipEmptyLines),typeof h.newline=="string"&&(N=h.newline),typeof h.quoteChar=="string"&&(O=h.quoteChar),typeof h.header=="boolean"&&(w=h.header),Array.isArray(h.columns)){if(h.columns.length===0)throw new Error("Option columns is empty");b=h.columns}h.escapeChar!==void 0&&(E=h.escapeChar+O),h.escapeFormulae instanceof RegExp?D=h.escapeFormulae:typeof h.escapeFormulae=="boolean"&&h.escapeFormulae&&(D=/^[=+\-@\t\r].*$/)}})(),new RegExp(k(O),"g"));if(typeof f=="string"&&(f=JSON.parse(f)),Array.isArray(f)){if(!f.length||Array.isArray(f[0]))return F(null,f,P);if(typeof f[0]=="object")return F(b||Object.keys(f[0]),f,P)}else if(typeof f=="object")return typeof f.data=="string"&&(f.data=JSON.parse(f.data)),Array.isArray(f.data)&&(f.fields||(f.fields=f.meta&&f.meta.fields||b),f.fields||(f.fields=Array.isArray(f.data[0])?f.fields:typeof f.data[0]=="object"?Object.keys(f.data[0]):[]),Array.isArray(f.data[0])||typeof f.data[0]=="object"||(f.data=[f.data])),F(f.fields||[],f.data||[],P);throw new Error("Unable to serialize unrecognized input");function F(M,S,J){var V="",at=(typeof M=="string"&&(M=JSON.parse(M)),typeof S=="string"&&(S=JSON.parse(S)),Array.isArray(M)&&0<M.length),xt=!Array.isArray(S[0]);if(at&&w){for(var K=0;K<M.length;K++)0<K&&(V+=v),V+=R(M[K],K);0<S.length&&(V+=N)}for(var tt=0;tt<S.length;tt++){var nt=(at?M:S[tt]).length,X=!1,rt=at?Object.keys(S[tt]).length===0:S[tt].length===0;if(J&&!at&&(X=J==="greedy"?S[tt].join("").trim()==="":S[tt].length===1&&S[tt][0].length===0),J==="greedy"&&at){for(var ft=[],et=0;et<nt;et++){var st=xt?M[et]:et;ft.push(S[tt][st])}X=ft.join("").trim()===""}if(!X){for(var B=0;B<nt;B++){0<B&&!rt&&(V+=v);var G=at&&xt?M[B]:B;V+=R(S[tt][G],B)}tt<S.length-1&&(!J||0<nt&&!rt)&&(V+=N)}}return V}function R(M,S){var J,V;return M==null?"":M.constructor===Date?JSON.stringify(M).slice(1,25):(V=!1,D&&typeof M=="string"&&D.test(M)&&(M="'"+M,V=!0),J=M.toString().replace(C,E),(V=V||y===!0||typeof y=="function"&&y(M,S)||Array.isArray(y)&&y[S]||((at,xt)=>{for(var K=0;K<xt.length;K++)if(-1<at.indexOf(xt[K]))return!0;return!1})(J,a.BAD_DELIMITERS)||-1<J.indexOf(v)||J.charAt(0)===" "||J.charAt(J.length-1)===" ")?O+J+O:J)}},a.RECORD_SEP="",a.UNIT_SEP="",a.BYTE_ORDER_MARK="\uFEFF",a.BAD_DELIMITERS=["\r",`
`,'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!s&&!!r.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=I,a.ParserHandle=x,a.NetworkStreamer=d,a.FileStreamer=m,a.StringStreamer=T,a.ReadableStreamStreamer=$,r.jQuery&&((i=r.jQuery).fn.parse=function(f){var h=f.config||{},y=[];return this.each(function(N){if(!(i(this).prop("tagName").toUpperCase()==="INPUT"&&i(this).attr("type").toLowerCase()==="file"&&r.FileReader)||!this.files||this.files.length===0)return!0;for(var O=0;O<this.files.length;O++)y.push({file:this.files[O],inputElem:this,instanceConfig:i.extend({},h)})}),w(),this;function w(){if(y.length===0)_(f.complete)&&f.complete();else{var N,O,E,P,b=y[0];if(_(f.before)){var D=f.before(b.file,b.inputElem);if(typeof D=="object"){if(D.action==="abort")return N="AbortError",O=b.file,E=b.inputElem,P=D.reason,void(_(f.error)&&f.error({name:N},O,E,P));if(D.action==="skip")return void v();typeof D.config=="object"&&(b.instanceConfig=i.extend(b.instanceConfig,D.config))}else if(D==="skip")return void v()}var C=b.instanceConfig.complete;b.instanceConfig.complete=function(F){_(C)&&C(F,b.file,b.inputElem),v()},a.parse(b.file,b.instanceConfig)}}function v(){y.splice(0,1),w()}}),o&&(r.onmessage=function(f){f=f.data,a.WORKER_ID===void 0&&f&&(a.WORKER_ID=f.workerId),typeof f.input=="string"?r.postMessage({workerId:a.WORKER_ID,results:a.parse(f.input,f.config),finished:!0}):(r.File&&f.input instanceof File||f.input instanceof Object)&&(f=a.parse(f.input,f.config))&&r.postMessage({workerId:a.WORKER_ID,results:f,finished:!0})}),(d.prototype=Object.create(p.prototype)).constructor=d,(m.prototype=Object.create(p.prototype)).constructor=m,(T.prototype=Object.create(T.prototype)).constructor=T,($.prototype=Object.create(p.prototype)).constructor=$,a})}(le)),le.exports}var Yn=Fn();const jn=vn(Yn);var pe,De;function Xn(){if(De)return pe;De=1;let t=/[-+]?([0-9]*\.[0-9]+|[0-9]+)([eE][-+]?[0-9]+)?/,e=new RegExp("^"+t.source+"(\\s"+t.source+"){1,}");const n=i=>{let s=i.split(";"),o=s.pop(),u=(s.shift()||"").split("=").pop(),l=0;function a(A){let _=o.substring(l).match(A);return _?(l+=_[0].length,_[0]):null}function p(A){return A&&u.match(/\d+/)&&(A.crs={type:"name",properties:{name:"urn:ogc:def:crs:EPSG::"+u}}),A}function d(){a(/^\s*/)}function m(){d();let A=0,_=[],f=[_],h=_,y;for(;y=a(/^(\()/)||a(/^(\))/)||a(/^(,)/)||a(e);){if(y==="(")f.push(h),h=[],f[f.length-1].push(h),A++;else if(y===")"){if(h.length===0||(h=f.pop(),!h))return null;if(A--,A===0)break}else if(y===",")h=[],f[f.length-1].push(h);else if(!y.split(/\s/g).some(isNaN))Array.prototype.push.apply(h,y.split(/\s/g).map(parseFloat));else return null;d()}return A!==0?null:_}function T(){let A=[],_,f;for(;f=a(e)||a(/^(,)/);)f===","?(A.push(_),_=[]):f.split(/\s/g).some(isNaN)||(_||(_=[]),Array.prototype.push.apply(_,f.split(/\s/g).map(parseFloat))),d();if(_)A.push(_);else return null;return A.length?A:null}function $(){if(!a(/^(point(\sz)?)/i)||(d(),!a(/^(\()/)))return null;let A=T();return!A||(d(),!a(/^(\))/))?null:{type:"Point",coordinates:A[0]}}function x(){if(!a(/^(multipoint(\sz)?)/i))return null;d(),o="MULTIPOINT ("+o.substring(o.indexOf("(")+1,o.length-1).replace(/\(/g,"").replace(/\)/g,"")+")";let _=m();return _?(d(),{type:"MultiPoint",coordinates:_}):null}function k(){if(!a(/^(multilinestring(\sz)?)/i))return null;d();let A=m();return A?(d(),{type:"MultiLineString",coordinates:A}):null}function I(){if(!a(/^(linestring(\sz)?)/i)||(d(),!a(/^(\()/)))return null;let A=T();return!A||!a(/^(\))/)?null:{type:"LineString",coordinates:A}}function Y(){if(!a(/^(polygon(\sz)?)/i))return null;d();let A=m();return A?{type:"Polygon",coordinates:A}:null}function U(){if(!a(/^(multipolygon(\sz)?)/i))return null;d();let A=m();return A?{type:"MultiPolygon",coordinates:A}:null}function j(){let A=[],_;if(!a(/^(geometrycollection)/i)||(d(),!a(/^(\()/)))return null;for(;_=H();)A.push(_),d(),a(/^(,)/),d();return a(/^(\))/)?{type:"GeometryCollection",geometries:A}:null}function H(){return $()||I()||Y()||x()||k()||U()||j()}return p(H())},r=i=>{i.type==="Feature"&&(i=i.geometry);function s(d){return d.join(" ")}function o(d){return d.map(s).join(", ")}function u(d){return d.map(o).map(a).join(", ")}function l(d){return d.map(u).map(a).join(", ")}function a(d){return"("+d+")"}let p=i;switch(p.type){case"Point":return p.coordinates&&p.coordinates.length===3?"POINT Z ("+s(p.coordinates)+")":"POINT ("+s(p.coordinates)+")";case"LineString":return p.coordinates&&p.coordinates[0]&&p.coordinates[0].length===3?"LINESTRING Z ("+o(p.coordinates)+")":"LINESTRING ("+o(p.coordinates)+")";case"Polygon":return p.coordinates&&p.coordinates[0]&&p.coordinates[0][0]&&p.coordinates[0][0].length===3?"POLYGON Z ("+u(p.coordinates)+")":"POLYGON ("+u(p.coordinates)+")";case"MultiPoint":return p.coordinates&&p.coordinates[0]&&p.coordinates[0].length===3?"MULTIPOINT Z ("+o(p.coordinates)+")":"MULTIPOINT ("+o(p.coordinates)+")";case"MultiLineString":return p.coordinates&&p.coordinates[0]&&p.coordinates[0][0]&&p.coordinates[0][0].length===3?"MULTILINESTRING Z ("+u(p.coordinates)+")":"MULTILINESTRING ("+u(p.coordinates)+")";case"MultiPolygon":return p.coordinates&&p.coordinates[0]&&p.coordinates[0][0]&&p.coordinates[0][0]&&p.coordinates[0][0][0].length===3?"MULTIPOLYGON Z ("+l(p.coordinates)+")":"MULTIPOLYGON ("+l(p.coordinates)+")";case"GeometryCollection":return"GEOMETRYCOLLECTION ("+p.geometries.map(r).join(", ")+")";default:throw new Error("stringify requires a valid GeoJSON Feature or geometry object as input")}};return pe={parse:n,stringify:r},pe}var zn=Xn(),Gn=Object.defineProperty,qn=(t,e,n)=>e in t?Gn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,pt=(t,e,n)=>qn(t,typeof e!="symbol"?e+"":e,n);function jt(){}function we(t,e){for(const n in e)t[n]=e[n];return t}function Tn(t){return t()}function Fe(){return Object.create(null)}function Nt(t){t.forEach(Tn)}function gt(t){return typeof t=="function"}function Qt(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Bn(t){return Object.keys(t).length===0}function Zn(t,e,n,r){if(t){const i=On(t,e,n,r);return t[0](i)}}function On(t,e,n,r){return t[1]&&r?we(n.ctx.slice(),t[1](r(e))):n.ctx}function Kn(t,e,n,r){if(t[2]&&r){const i=t[2](r(n));if(e.dirty===void 0)return i;if(typeof i=="object"){const s=[],o=Math.max(e.dirty.length,i.length);for(let u=0;u<o;u+=1)s[u]=e.dirty[u]|i[u];return s}return e.dirty|i}return e.dirty}function Wn(t,e,n,r,i,s){if(i){const o=On(e,n,r,s);t.p(o,i)}}function Qn(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let r=0;r<n;r++)e[r]=-1;return e}return-1}function Ye(t){const e={};for(const n in t)n[0]!=="$"&&(e[n]=t[n]);return e}function oe(t){return t??""}function ut(t,e){t.appendChild(e)}function Q(t,e,n){t.insertBefore(e,n||null)}function W(t){t.parentNode&&t.parentNode.removeChild(t)}function ue(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function q(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function En(t){return document.createTextNode(t)}function Et(){return En(" ")}function se(){return En("")}function ot(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function c(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Vn(t){return Array.from(t.childNodes)}function je(t,e,n){t.classList.toggle(e,!!n)}function Jn(t,e,{bubbles:n=!1,cancelable:r=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:r})}let ne;function ee(t){ne=t}function wn(){if(!ne)throw new Error("Function called outside component initialization");return ne}function $n(t){wn().$$.on_mount.push(t)}function Me(){const t=wn();return(e,n,{cancelable:r=!1}={})=>{const i=t.$$.callbacks[e];if(i){const s=Jn(e,n,{cancelable:r});return i.slice().forEach(o=>{o.call(t,s)}),!s.defaultPrevented}return!0}}function vt(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(r=>r.call(this,e))}const qt=[],Xe=[];let Zt=[];const ze=[],bn=Promise.resolve();let $e=!1;function Nn(){$e||($e=!0,bn.then(An))}function Rn(){return Nn(),bn}function be(t){Zt.push(t)}const de=new Set;let zt=0;function An(){if(zt!==0)return;const t=ne;do{try{for(;zt<qt.length;){const e=qt[zt];zt++,ee(e),tr(e.$$)}}catch(e){throw qt.length=0,zt=0,e}for(ee(null),qt.length=0,zt=0;Xe.length;)Xe.pop()();for(let e=0;e<Zt.length;e+=1){const n=Zt[e];de.has(n)||(de.add(n),n())}Zt.length=0}while(qt.length);for(;ze.length;)ze.pop()();$e=!1,de.clear(),ee(t)}function tr(t){if(t.fragment!==null){t.update(),Nt(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(be)}}function er(t){const e=[],n=[];Zt.forEach(r=>t.indexOf(r)===-1?e.push(r):n.push(r)),n.forEach(r=>r()),Zt=e}const ce=new Set;let Yt;function Kt(){Yt={r:0,c:[],p:Yt}}function Wt(){Yt.r||Nt(Yt.c),Yt=Yt.p}function it(t,e){t&&t.i&&(ce.delete(t),t.i(e))}function ht(t,e,n,r){if(t&&t.o){if(ce.has(t))return;ce.add(t),Yt.c.push(()=>{ce.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}function Ht(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function Rt(t){t&&t.c()}function $t(t,e,n){const{fragment:r,after_update:i}=t.$$;r&&r.m(e,n),be(()=>{const s=t.$$.on_mount.map(Tn).filter(gt);t.$$.on_destroy?t.$$.on_destroy.push(...s):Nt(s),t.$$.on_mount=[]}),i.forEach(be)}function bt(t,e){const n=t.$$;n.fragment!==null&&(er(n.after_update),Nt(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function nr(t,e){t.$$.dirty[0]===-1&&(qt.push(t),Nn(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Vt(t,e,n,r,i,s,o=null,u=[-1]){const l=ne;ee(t);const a=t.$$={fragment:null,ctx:[],props:s,update:jt,not_equal:i,bound:Fe(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:Fe(),dirty:u,skip_bound:!1,root:e.target||l.$$.root};o&&o(a.root);let p=!1;if(a.ctx=n?n(t,e.props||{},(d,m,...T)=>{const $=T.length?T[0]:m;return a.ctx&&i(a.ctx[d],a.ctx[d]=$)&&(!a.skip_bound&&a.bound[d]&&a.bound[d]($),p&&nr(t,d)),m}):[],a.update(),p=!0,Nt(a.before_update),a.fragment=r?r(a.ctx):!1,e.target){if(e.hydrate){const d=Vn(e.target);a.fragment&&a.fragment.l(d),d.forEach(W)}else a.fragment&&a.fragment.c();e.intro&&it(t.$$.fragment),$t(t,e.target,e.anchor),An()}ee(l)}class Jt{constructor(){pt(this,"$$"),pt(this,"$$set")}$destroy(){bt(this,1),this.$destroy=jt}$on(e,n){if(!gt(n))return jt;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(e){this.$$set&&!Bn(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const rr="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(rr);var kt=(t=>(t.ELLIPSE="ELLIPSE",t.MULTIPOLYGLON="MULTIPOLYGON",t.POLYGON="POLYGON",t.RECTANGLE="RECTANGLE",t))(kt||{});const he=(t,e)=>e,Lt=t=>{let e=1/0,n=1/0,r=-1/0,i=-1/0;return t.forEach(([s,o])=>{e=Math.min(e,s),n=Math.min(n,o),r=Math.max(r,s),i=Math.max(i,o)}),{minX:e,minY:n,maxX:r,maxY:i}},Ne=t=>{let e=0,n=t.length-1;for(let r=0;r<t.length;r++)e+=(t[n][0]+t[r][0])*(t[n][1]-t[r][1]),n=r;return Math.abs(.5*e)},Re=(t,e,n)=>{let r=!1;for(let i=0,s=t.length-1;i<t.length;s=i++){const o=t[i][0],u=t[i][1],l=t[s][0],a=t[s][1];u>n!=a>n&&e<(l-o)*(n-u)/(a-u)+o&&(r=!r)}return r},ir=(t,e=!0)=>{let n="M ";return t.forEach(([r,i],s)=>{s===0?n+=`${r},${i}`:n+=` L ${r},${i}`}),e&&(n+=" Z"),n},sr={area:t=>Math.PI*t.geometry.rx*t.geometry.ry,intersects:(t,e,n)=>{const{cx:r,cy:i,rx:s,ry:o}=t.geometry,u=0,l=Math.cos(u),a=Math.sin(u),p=e-r,d=n-i,m=l*p+a*d,T=a*p-l*d;return m*m/(s*s)+T*T/(o*o)<=1}};he(kt.ELLIPSE,sr);const or={area:t=>{const{polygons:e}=t.geometry;return e.reduce((n,r)=>{const[i,...s]=r.rings,o=Ne(i.points),u=s.reduce((l,a)=>l+Ne(a.points),0);return n+o-u},0)},intersects:(t,e,n)=>{const{polygons:r}=t.geometry;for(const i of r){const[s,...o]=i.rings;if(Re(s.points,e,n)){let u=!1;for(const l of o)if(Re(l.points,e,n)){u=!0;break}if(!u)return!0}}return!1}},ye=t=>{const e=t.reduce((n,r)=>[...n,...r.rings[0].points],[]);return Lt(e)},Gt=t=>t.rings.map(e=>ir(e.points)).join(" "),ar=t=>t.polygons.reduce((e,n)=>[...e,...n.rings.reduce((r,i)=>[...r,...i.points],[])],[]);he(kt.MULTIPOLYGLON,or);const lr={area:t=>{const e=t.geometry.points;return Ne(e)},intersects:(t,e,n)=>{const r=t.geometry.points;return Re(r,e,n)}};he(kt.POLYGON,lr);const cr={area:t=>t.geometry.w*t.geometry.h,intersects:(t,e,n)=>e>=t.geometry.x&&e<=t.geometry.x+t.geometry.w&&n>=t.geometry.y&&n<=t.geometry.y+t.geometry.h};he(kt.RECTANGLE,cr);const yt=" ";function ur(t){let e="";Array.isArray(t)||(t=[t]);for(let n=0;n<t.length;n++){const r=t[n];if(r.type===g.CLOSE_PATH)e+="z";else if(r.type===g.HORIZ_LINE_TO)e+=(r.relative?"h":"H")+r.x;else if(r.type===g.VERT_LINE_TO)e+=(r.relative?"v":"V")+r.y;else if(r.type===g.MOVE_TO)e+=(r.relative?"m":"M")+r.x+yt+r.y;else if(r.type===g.LINE_TO)e+=(r.relative?"l":"L")+r.x+yt+r.y;else if(r.type===g.CURVE_TO)e+=(r.relative?"c":"C")+r.x1+yt+r.y1+yt+r.x2+yt+r.y2+yt+r.x+yt+r.y;else if(r.type===g.SMOOTH_CURVE_TO)e+=(r.relative?"s":"S")+r.x2+yt+r.y2+yt+r.x+yt+r.y;else if(r.type===g.QUAD_TO)e+=(r.relative?"q":"Q")+r.x1+yt+r.y1+yt+r.x+yt+r.y;else if(r.type===g.SMOOTH_QUAD_TO)e+=(r.relative?"t":"T")+r.x+yt+r.y;else if(r.type===g.ARC)e+=(r.relative?"a":"A")+r.rX+yt+r.rY+yt+r.xRot+yt+ +r.lArcFlag+yt+ +r.sweepFlag+yt+r.x+yt+r.y;else throw new Error(`Unexpected command type "${r==null?void 0:r.type}" at index ${n}.`)}return e}function Ae([t,e],n){return[t*Math.cos(n)-e*Math.sin(n),t*Math.sin(n)+e*Math.cos(n)]}function At(...t){for(let e=0;e<t.length;e++)if(typeof t[e]!="number")throw new Error(`assertNumbers arguments[${e}] is not a number. ${typeof t[e]} == typeof ${t[e]}`);return!0}const Pt=Math.PI;function Ie(t,e,n){t.lArcFlag=t.lArcFlag===0?0:1,t.sweepFlag=t.sweepFlag===0?0:1;let{rX:r,rY:i}=t;const{x:s,y:o}=t;if(Math.abs(r)<1e-10||Math.abs(i)<1e-10){t.rX=0,t.rY=0,t.cX=(e+s)/2,t.cY=(n+o)/2,t.phi1=0,t.phi2=0;return}r=Math.abs(t.rX),i=Math.abs(t.rY);const u=t.xRot/180*Pt,[l,a]=Ae([(e-s)/2,(n-o)/2],-u),p=Math.pow(l,2)/Math.pow(r,2)+Math.pow(a,2)/Math.pow(i,2);1<p&&(r*=Math.sqrt(p),i*=Math.sqrt(p)),t.rX=r,t.rY=i;const d=Math.pow(r,2)*Math.pow(a,2)+Math.pow(i,2)*Math.pow(l,2),m=(t.lArcFlag!==t.sweepFlag?1:-1)*Math.sqrt(Math.max(0,(Math.pow(r,2)*Math.pow(i,2)-d)/d)),T=r*a/i*m,$=-i*l/r*m,x=Ae([T,$],u);t.cX=x[0]+(e+s)/2,t.cY=x[1]+(n+o)/2,t.phi1=Math.atan2((a-$)/i,(l-T)/r),t.phi2=Math.atan2((-a-$)/i,(-l-T)/r),t.sweepFlag===0&&t.phi2>t.phi1&&(t.phi2-=2*Pt),t.sweepFlag===1&&t.phi2<t.phi1&&(t.phi2+=2*Pt),t.phi1*=180/Pt,t.phi2*=180/Pt}function Ge(t,e,n){At(t,e,n);const r=t*t+e*e-n*n;if(0>r)return[];if(r===0)return[[t*n/(t*t+e*e),e*n/(t*t+e*e)]];const i=Math.sqrt(r);return[[(t*n+e*i)/(t*t+e*e),(e*n-t*i)/(t*t+e*e)],[(t*n-e*i)/(t*t+e*e),(e*n+t*i)/(t*t+e*e)]]}const Ft=Math.PI/180;function qe(t,e,n){return(1-n)*t+n*e}function Be(t,e,n,r){return t+Math.cos(r/180*Pt)*e+Math.sin(r/180*Pt)*n}function Ze(t,e,n,r){const i=e-t,s=n-e,o=r-n,u=3*i+3*o-6*s,l=(s-i)*6,a=3*i;return Math.abs(u)<1e-6?Math.abs(l)<1e-6?[]:[-a/l]:hr(l/u,a/u,1e-6)}function Ke(t,e,n,r,i){const s=1-i,o=s*s*s,u=3*s*s*i,l=3*s*i*i,a=i*i*i;return t*o+e*u+n*l+r*a}function hr(t,e,n=1e-6){const r=t*t/4-e;if(r<-n)return[];if(r<=n)return[-t/2];const i=Math.sqrt(r);return[-(t/2)-i,-(t/2)+i]}function fr(t,e,n){t.cX||Ie(t,e,n);const r=t.xRot/180*Pt;if(Math.abs(t.rX)<1e-10||Math.abs(t.rY)<1e-10)return[{relative:t.relative,type:g.CURVE_TO,x1:e+(t.x-e)/3,y1:n+(t.y-n)/3,x2:e+2*(t.x-e)/3,y2:n+2*(t.y-n)/3,x:t.x,y:t.y}];const i=Math.min(t.phi1,t.phi2),s=Math.max(t.phi1,t.phi2),o=s-i,u=Math.ceil(o/90),l=new Array(u);let a=e,p=n;const d=(m,T)=>{const[$,x]=Ae([m*t.rX,T*t.rY],r);return[t.cX+$,t.cY+x]};for(let m=0;m<u;m++){const T=qe(t.phi1,t.phi2,m/u),$=qe(t.phi1,t.phi2,(m+1)/u),x=$-T,k=4/3*Math.tan(x*Ft/4),I=Math.cos(T*Ft)-k*Math.sin(T*Ft),Y=Math.sin(T*Ft)+k*Math.cos(T*Ft),U=Math.cos($*Ft),j=Math.sin($*Ft),H=U+k*j,A=j-k*U,_=d(I,Y),f=d(H,A),h=d(U,j),y={relative:t.relative,type:g.CURVE_TO,x:h[0],y:h[1],x1:_[0],y1:_[1],x2:f[0],y2:f[1]};t.relative&&(y.x1-=a,y.y1-=p,y.x2-=a,y.y2-=p,y.x-=a,y.y-=p),a=h[0],p=h[1],l[m]=y}return l}function me(t,e,n){const r=e[0]-t[0],i=e[1]-t[1],s=n[0]-t[0],o=n[1]-t[1],u=r*o-i*s;if(!(Math.abs(u)<1e-10))return!1;const l=r*s+i*o,a=r*r+i*i,p=s*s+o*o;return 0<=l&&l<=p&&a<=p}function pr(t,e=!0){if(t.length<2)return t;const n=mt.INFO((s,o,u)=>({...s,x:s.x??o,y:s.y??u,relative:s.relative??!1})),r=[];let i=[];for(const s of t){const o=n(s);o.type===g.MOVE_TO&&i.length>0&&(e?r.push(...ae(i)):r.unshift(...ae(i)),i=[]),i.push(o)}return i.length>0&&(e?r.push(...ae(i)):r.unshift(...ae(i))),r}function ae(t){var e;const n=((e=t[t.length-1])==null?void 0:e.type)===g.CLOSE_PATH,r=n?t.length-2:t.length-1,i=[{type:g.MOVE_TO,relative:!1,x:t[r].x,y:t[r].y}];for(let s=r;s>0;s--){const o=t[s],u=t[s-1];if(o.relative)throw new Error("Relative command are not supported convert first with `toAbs()`");switch(o.type){case g.HORIZ_LINE_TO:i.push({type:g.HORIZ_LINE_TO,relative:!1,x:u.x});break;case g.VERT_LINE_TO:i.push({type:g.VERT_LINE_TO,relative:!1,y:u.y});break;case g.LINE_TO:case g.MOVE_TO:i.push({type:g.LINE_TO,relative:!1,x:u.x,y:u.y});break;case g.CURVE_TO:i.push({type:g.CURVE_TO,relative:!1,x:u.x,y:u.y,x1:o.x2,y1:o.y2,x2:o.x1,y2:o.y1});break;case g.SMOOTH_CURVE_TO:throw new Error("Unsupported command: S (smooth cubic bezier)");case g.SMOOTH_QUAD_TO:throw new Error("Unsupported command: T (smooth quadratic bezier)");case g.ARC:throw new Error("Unsupported command: A (arc)");case g.QUAD_TO:throw new Error("Unsupported command: Q (quadratic bezier)")}}return n&&i.push({type:g.CLOSE_PATH}),i}function dr(t=1e13){At(t);function e(n){return Math.round(n*t)/t}return function(n){return"x1"in n&&typeof n.x1<"u"&&(n.x1=e(n.x1)),"y1"in n&&typeof n.y1<"u"&&(n.y1=e(n.y1)),"x2"in n&&typeof n.x2<"u"&&(n.x2=e(n.x2)),"y2"in n&&typeof n.y2<"u"&&(n.y2=e(n.y2)),"x"in n&&typeof n.x<"u"&&(n.x=e(n.x)),"y"in n&&typeof n.y<"u"&&(n.y=e(n.y)),"rX"in n&&typeof n.rX<"u"&&(n.rX=e(n.rX)),"rY"in n&&typeof n.rY<"u"&&(n.rY=e(n.rY)),n}}function Cn(){return Ct((t,e,n)=>(t.relative&&(typeof t.x1<"u"&&(t.x1+=e),typeof t.y1<"u"&&(t.y1+=n),typeof t.x2<"u"&&(t.x2+=e),typeof t.y2<"u"&&(t.y2+=n),typeof t.x<"u"&&(t.x+=e),typeof t.y<"u"&&(t.y+=n),t.relative=!1),t))}function yr(){return Ct((t,e,n)=>(t.relative||(typeof t.x1<"u"&&(t.x1-=e),typeof t.y1<"u"&&(t.y1-=n),typeof t.x2<"u"&&(t.x2-=e),typeof t.y2<"u"&&(t.y2-=n),typeof t.x<"u"&&(t.x-=e),typeof t.y<"u"&&(t.y-=n),t.relative=!0),t))}function mr(t=!0,e=!0,n=!0,r=!0){return Ct((i,s,o,u,l)=>{if(isNaN(u)&&!(i.type&g.MOVE_TO))throw new Error("path must start with moveto");if(e&&i.type&g.HORIZ_LINE_TO&&(i.type=g.LINE_TO,i.y=i.relative?0:o),n&&i.type&g.VERT_LINE_TO&&(i.type=g.LINE_TO,i.x=i.relative?0:s),t&&i.type&g.CLOSE_PATH&&(i.type=g.LINE_TO,i.x=i.relative?u-s:u,i.y=i.relative?l-o:l),i.type&g.ARC&&(i.rX===0||i.rY===0)&&(i.type=g.LINE_TO,delete i.rX,delete i.rY,delete i.xRot,delete i.lArcFlag,delete i.sweepFlag),r&&i.type&g.QUAD_TO){const a=[s,o],p=i.relative?[s+i.x1,o+i.y1]:[i.x1,i.y1],d=i.relative?[s+i.x,o+i.y]:[i.x,i.y];me(a,p,d)&&(i.type=g.LINE_TO,delete i.x1,delete i.y1)}if(r&&i.type&g.CURVE_TO){const a=[s,o],p=i.relative?[s+i.x1,o+i.y1]:[i.x1,i.y1],d=i.relative?[s+i.x2,o+i.y2]:[i.x2,i.y2],m=i.relative?[s+i.x,o+i.y]:[i.x,i.y];me(a,p,m)&&me(a,d,m)&&(i.type=g.LINE_TO,delete i.x1,delete i.y1,delete i.x2,delete i.y2)}return i})}function Sn(){let t=NaN,e=NaN,n=NaN,r=NaN;return Ct((i,s,o)=>(i.type&g.SMOOTH_CURVE_TO&&(i.type=g.CURVE_TO,t=isNaN(t)?s:t,e=isNaN(e)?o:e,i.x1=i.relative?s-t:2*s-t,i.y1=i.relative?o-e:2*o-e),i.type&g.CURVE_TO?(t=i.relative?s+i.x2:i.x2,e=i.relative?o+i.y2:i.y2):(t=NaN,e=NaN),i.type&g.SMOOTH_QUAD_TO&&(i.type=g.QUAD_TO,n=isNaN(n)?s:n,r=isNaN(r)?o:r,i.x1=i.relative?s-n:2*s-n,i.y1=i.relative?o-r:2*o-r),i.type&g.QUAD_TO?(n=i.relative?s+i.x1:i.x1,r=i.relative?o+i.y1:i.y1):(n=NaN,r=NaN),i))}function Mn(){let t=NaN,e=NaN;return Ct((n,r,i)=>{if(n.type&g.SMOOTH_QUAD_TO&&(n.type=g.QUAD_TO,t=isNaN(t)?r:t,e=isNaN(e)?i:e,n.x1=n.relative?r-t:2*r-t,n.y1=n.relative?i-e:2*i-e),n.type&g.QUAD_TO){t=n.relative?r+n.x1:n.x1,e=n.relative?i+n.y1:n.y1;const s=n.x1,o=n.y1;n.type=g.CURVE_TO,n.x1=((n.relative?0:r)+s*2)/3,n.y1=((n.relative?0:i)+o*2)/3,n.x2=(n.x+s*2)/3,n.y2=(n.y+o*2)/3}else t=NaN,e=NaN;return n})}function Ct(t){let e=0,n=0,r=NaN,i=NaN;return function(s){if(isNaN(r)&&!(s.type&g.MOVE_TO))throw new Error("path must start with moveto");const o=t(s,e,n,r,i);return s.type&g.CLOSE_PATH&&(e=r,n=i),"x"in s&&typeof s.x<"u"&&(e=s.relative?e+s.x:s.x),"y"in s&&typeof s.y<"u"&&(n=s.relative?n+s.y:s.y),s.type&g.MOVE_TO&&(r=e,i=n),o}}function gr(t=0){At(t);let e=NaN,n=NaN,r=NaN,i=NaN;return Ct((s,o,u,l,a)=>{const p=Math.abs;let d=!1,m=0,T=0;if(s.type&g.SMOOTH_CURVE_TO&&(m=isNaN(e)?0:o-e,T=isNaN(n)?0:u-n),s.type&(g.CURVE_TO|g.SMOOTH_CURVE_TO)?(e=s.relative?o+s.x2:s.x2,n=s.relative?u+s.y2:s.y2):(e=NaN,n=NaN),s.type&g.SMOOTH_QUAD_TO?(r=isNaN(r)?o:2*o-r,i=isNaN(i)?u:2*u-i):s.type&g.QUAD_TO?(r=s.relative?o+s.x1:s.x1,i=s.relative?u+s.y1:s.y2):(r=NaN,i=NaN),s.type&g.LINE_COMMANDS||s.type&g.ARC&&(s.rX===0||s.rY===0||!s.lArcFlag)||s.type&g.CURVE_TO||s.type&g.SMOOTH_CURVE_TO||s.type&g.QUAD_TO||s.type&g.SMOOTH_QUAD_TO){const $=typeof s.x>"u"?0:s.relative?s.x:s.x-o,x=typeof s.y>"u"?0:s.relative?s.y:s.y-u;m=isNaN(r)?typeof s.x1>"u"?m:s.relative?s.x:s.x1-o:r-o,T=isNaN(i)?typeof s.y1>"u"?T:s.relative?s.y:s.y1-u:i-u;const k=typeof s.x2>"u"?0:s.relative?s.x:s.x2-o,I=typeof s.y2>"u"?0:s.relative?s.y:s.y2-u;p($)<=t&&p(x)<=t&&p(m)<=t&&p(T)<=t&&p(k)<=t&&p(I)<=t&&(d=!0)}return s.type&g.CLOSE_PATH&&p(o-l)<=t&&p(u-a)<=t&&(d=!0),d?[]:s})}function Dt(t,e,n,r,i,s){return At(t,e,n,r,i,s),Ct((o,u,l,a)=>{const p=o.x1,d=o.x2,m=o.relative&&!isNaN(a),T=typeof o.x<"u"?o.x:m?0:u,$=typeof o.y<"u"?o.y:m?0:l;o.type&g.HORIZ_LINE_TO&&e!==0&&(o.type=g.LINE_TO,o.y=o.relative?0:l),o.type&g.VERT_LINE_TO&&n!==0&&(o.type=g.LINE_TO,o.x=o.relative?0:u),typeof o.x<"u"&&(o.x=o.x*t+$*n+(m?0:i)),typeof o.y<"u"&&(o.y=T*e+o.y*r+(m?0:s)),typeof o.x1<"u"&&(o.x1=o.x1*t+o.y1*n+(m?0:i)),typeof o.y1<"u"&&(o.y1=p*e+o.y1*r+(m?0:s)),typeof o.x2<"u"&&(o.x2=o.x2*t+o.y2*n+(m?0:i)),typeof o.y2<"u"&&(o.y2=d*e+o.y2*r+(m?0:s));function x(I){return I*I}const k=t*r-e*n;if(typeof o.xRot<"u"&&(t!==1||e!==0||n!==0||r!==1))if(k===0)delete o.rX,delete o.rY,delete o.xRot,delete o.lArcFlag,delete o.sweepFlag,o.type=g.LINE_TO;else{const I=o.xRot*Math.PI/180,Y=Math.sin(I),U=Math.cos(I),j=1/x(o.rX),H=1/x(o.rY),A=x(U)*j+x(Y)*H,_=2*Y*U*(j-H),f=x(Y)*j+x(U)*H,h=A*r*r-_*e*r+f*e*e,y=_*(t*r+e*n)-2*(A*n*r+f*t*e),w=A*n*n-_*t*n+f*t*t,v=(Math.atan2(y,h-w)+Math.PI)%Math.PI/2,N=Math.sin(v),O=Math.cos(v);o.rX=Math.abs(k)/Math.sqrt(h*x(O)+y*N*O+w*x(N)),o.rY=Math.abs(k)/Math.sqrt(h*x(N)-y*N*O+w*x(O)),o.xRot=v*180/Math.PI}return typeof o.sweepFlag<"u"&&0>k&&(o.sweepFlag=+!o.sweepFlag),o})}function xr(t,e=0,n=0){At(t,e,n);const r=Math.sin(t),i=Math.cos(t);return Dt(i,r,-r,i,e-e*i+n*r,n-e*r-n*i)}function _r(t,e=0){return At(t,e),Dt(1,0,0,1,t,e)}function vr(t,e=t){return At(t,e),Dt(t,0,0,e,0,0)}function Tr(t){return At(t),Dt(1,0,Math.tan(t),1,0,0)}function Or(t){return At(t),Dt(1,Math.tan(t),0,1,0,0)}function Er(t=0){return At(t),Dt(-1,0,0,1,t,0)}function wr(t=0){return At(t),Dt(1,0,0,-1,0,t)}function $r(){return Ct((t,e,n)=>g.ARC===t.type?fr(t,t.relative?0:e,t.relative?0:n):t)}function br(){return Ct((t,e,n)=>(t.relative&&(e=0,n=0),g.ARC===t.type&&Ie(t,e,n),t))}function In(){return t=>({...t})}function Nr(){const t=In(),e=Cn(),n=Mn(),r=Sn(),i=Ct((s,o,u)=>{const l=r(n(e(t(s))));function a(d){d>i.maxX&&(i.maxX=d),d<i.minX&&(i.minX=d)}function p(d){d>i.maxY&&(i.maxY=d),d<i.minY&&(i.minY=d)}if(l.type&g.DRAWING_COMMANDS&&(a(o),p(u)),l.type&g.HORIZ_LINE_TO&&a(l.x),l.type&g.VERT_LINE_TO&&p(l.y),l.type&g.LINE_TO&&(a(l.x),p(l.y)),l.type&g.CURVE_TO){a(l.x),p(l.y);const d=Ze(o,l.x1,l.x2,l.x);for(const T of d)0<T&&1>T&&a(Ke(o,l.x1,l.x2,l.x,T));const m=Ze(u,l.y1,l.y2,l.y);for(const T of m)0<T&&1>T&&p(Ke(u,l.y1,l.y2,l.y,T))}if(l.type&g.ARC){a(l.x),p(l.y),Ie(l,o,u);const d=l.xRot/180*Math.PI,m=Math.cos(d)*l.rX,T=Math.sin(d)*l.rX,$=-Math.sin(d)*l.rY,x=Math.cos(d)*l.rY,[k,I]=l.phi1<l.phi2?[l.phi1,l.phi2]:-180>l.phi2?[l.phi2+360,l.phi1+360]:[l.phi2,l.phi1],Y=([H,A])=>{const _=Math.atan2(A,H)*180/Math.PI;return _<k?_+360:_},U=Ge($,-m,0).map(Y);for(const H of U)H>k&&H<I&&a(Be(l.cX,m,$,H));const j=Ge(x,-T,0).map(Y);for(const H of j)H>k&&H<I&&p(Be(l.cY,T,x,H))}return s});return i.minX=1/0,i.maxX=-1/0,i.minY=1/0,i.maxY=-1/0,i}const mt={ROUND:dr,TO_ABS:Cn,TO_REL:yr,NORMALIZE_HVZ:mr,NORMALIZE_ST:Sn,QT_TO_C:Mn,INFO:Ct,SANITIZE:gr,MATRIX:Dt,ROTATE:xr,TRANSLATE:_r,SCALE:vr,SKEW_X:Tr,SKEW_Y:Or,X_AXIS_SYMMETRY:Er,Y_AXIS_SYMMETRY:wr,A_TO_C:$r,ANNOTATE_ARCS:br,CLONE:In,CALCULATE_BOUNDS:Nr,REVERSE_PATH:pr};class Ln{round(e){return this.transform(mt.ROUND(e))}toAbs(){return this.transform(mt.TO_ABS())}toRel(){return this.transform(mt.TO_REL())}normalizeHVZ(e,n,r){return this.transform(mt.NORMALIZE_HVZ(e,n,r))}normalizeST(){return this.transform(mt.NORMALIZE_ST())}qtToC(){return this.transform(mt.QT_TO_C())}aToC(){return this.transform(mt.A_TO_C())}sanitize(e){return this.transform(mt.SANITIZE(e))}translate(e,n){return this.transform(mt.TRANSLATE(e,n))}scale(e,n){return this.transform(mt.SCALE(e,n))}rotate(e,n,r){return this.transform(mt.ROTATE(e,n,r))}matrix(e,n,r,i,s,o){return this.transform(mt.MATRIX(e,n,r,i,s,o))}skewX(e){return this.transform(mt.SKEW_X(e))}skewY(e){return this.transform(mt.SKEW_Y(e))}xSymmetry(e){return this.transform(mt.X_AXIS_SYMMETRY(e))}ySymmetry(e){return this.transform(mt.Y_AXIS_SYMMETRY(e))}annotateArcs(){return this.transform(mt.ANNOTATE_ARCS())}}const Rr=t=>t===" "||t==="	"||t==="\r"||t===`
`,We=t=>48<=t.charCodeAt(0)&&t.charCodeAt(0)<=57;class Ar extends Ln{constructor(){super(),pt(this,"curNumber",""),pt(this,"curCommandType",-1),pt(this,"curCommandRelative",!1),pt(this,"canParseCommandOrComma",!0),pt(this,"curNumberHasExp",!1),pt(this,"curNumberHasExpDigits",!1),pt(this,"curNumberHasDecimal",!1),pt(this,"curArgs",[])}finish(e=[]){if(this.parse(" ",e),this.curArgs.length!==0||!this.canParseCommandOrComma)throw new SyntaxError("Unterminated command at the path end.");return e}parse(e,n=[]){const r=i=>{n.push(i),this.curArgs.length=0,this.canParseCommandOrComma=!0};for(let i=0;i<e.length;i++){const s=e[i],o=this.curCommandType===g.ARC&&(this.curArgs.length===3||this.curArgs.length===4)&&this.curNumber.length===1&&(this.curNumber==="0"||this.curNumber==="1"),u=We(s)&&(this.curNumber==="0"&&s==="0"||o);if(We(s)&&!u){this.curNumber+=s,this.curNumberHasExpDigits=this.curNumberHasExp;continue}if(s==="e"||s==="E"){this.curNumber+=s,this.curNumberHasExp=!0;continue}if((s==="-"||s==="+")&&this.curNumberHasExp&&!this.curNumberHasExpDigits){this.curNumber+=s;continue}if(s==="."&&!this.curNumberHasExp&&!this.curNumberHasDecimal&&!o){this.curNumber+=s,this.curNumberHasDecimal=!0;continue}if(this.curNumber&&this.curCommandType!==-1){const l=Number(this.curNumber);if(isNaN(l))throw new SyntaxError(`Invalid number ending at ${i}`);if(this.curCommandType===g.ARC){if(this.curArgs.length===0||this.curArgs.length===1){if(0>l)throw new SyntaxError(`Expected positive number, got "${l}" at index "${i}"`)}else if((this.curArgs.length===3||this.curArgs.length===4)&&this.curNumber!=="0"&&this.curNumber!=="1")throw new SyntaxError(`Expected a flag, got "${this.curNumber}" at index "${i}"`)}this.curArgs.push(l),this.curArgs.length===Cr[this.curCommandType]&&(g.HORIZ_LINE_TO===this.curCommandType?r({type:g.HORIZ_LINE_TO,relative:this.curCommandRelative,x:l}):g.VERT_LINE_TO===this.curCommandType?r({type:g.VERT_LINE_TO,relative:this.curCommandRelative,y:l}):this.curCommandType===g.MOVE_TO||this.curCommandType===g.LINE_TO||this.curCommandType===g.SMOOTH_QUAD_TO?(r({type:this.curCommandType,relative:this.curCommandRelative,x:this.curArgs[0],y:this.curArgs[1]}),g.MOVE_TO===this.curCommandType&&(this.curCommandType=g.LINE_TO)):this.curCommandType===g.CURVE_TO?r({type:g.CURVE_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x2:this.curArgs[2],y2:this.curArgs[3],x:this.curArgs[4],y:this.curArgs[5]}):this.curCommandType===g.SMOOTH_CURVE_TO?r({type:g.SMOOTH_CURVE_TO,relative:this.curCommandRelative,x2:this.curArgs[0],y2:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===g.QUAD_TO?r({type:g.QUAD_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===g.ARC&&r({type:g.ARC,relative:this.curCommandRelative,rX:this.curArgs[0],rY:this.curArgs[1],xRot:this.curArgs[2],lArcFlag:this.curArgs[3],sweepFlag:this.curArgs[4],x:this.curArgs[5],y:this.curArgs[6]})),this.curNumber="",this.curNumberHasExpDigits=!1,this.curNumberHasExp=!1,this.curNumberHasDecimal=!1,this.canParseCommandOrComma=!0}if(!Rr(s)){if(s===","&&this.canParseCommandOrComma){this.canParseCommandOrComma=!1;continue}if(s==="+"||s==="-"||s==="."){this.curNumber=s,this.curNumberHasDecimal=s===".";continue}if(u){this.curNumber=s,this.curNumberHasDecimal=!1;continue}if(this.curArgs.length!==0)throw new SyntaxError(`Unterminated command at index ${i}.`);if(!this.canParseCommandOrComma)throw new SyntaxError(`Unexpected character "${s}" at index ${i}. Command cannot follow comma`);if(this.canParseCommandOrComma=!1,s==="z"||s==="Z"){n.push({type:g.CLOSE_PATH}),this.canParseCommandOrComma=!0,this.curCommandType=-1;continue}else if(s==="h"||s==="H")this.curCommandType=g.HORIZ_LINE_TO,this.curCommandRelative=s==="h";else if(s==="v"||s==="V")this.curCommandType=g.VERT_LINE_TO,this.curCommandRelative=s==="v";else if(s==="m"||s==="M")this.curCommandType=g.MOVE_TO,this.curCommandRelative=s==="m";else if(s==="l"||s==="L")this.curCommandType=g.LINE_TO,this.curCommandRelative=s==="l";else if(s==="c"||s==="C")this.curCommandType=g.CURVE_TO,this.curCommandRelative=s==="c";else if(s==="s"||s==="S")this.curCommandType=g.SMOOTH_CURVE_TO,this.curCommandRelative=s==="s";else if(s==="q"||s==="Q")this.curCommandType=g.QUAD_TO,this.curCommandRelative=s==="q";else if(s==="t"||s==="T")this.curCommandType=g.SMOOTH_QUAD_TO,this.curCommandRelative=s==="t";else if(s==="a"||s==="A")this.curCommandType=g.ARC,this.curCommandRelative=s==="a";else throw new SyntaxError(`Unexpected character "${s}" at index ${i}.`)}}return n}transform(e){return Object.create(this,{parse:{value(n,r=[]){const i=Object.getPrototypeOf(this).parse.call(this,n);for(const s of i){const o=e(s);Array.isArray(o)?r.push(...o):r.push(o)}return r}}})}}const ct=class Ce extends Ln{constructor(e){super(),pt(this,"commands"),typeof e=="string"?this.commands=Ce.parse(e):this.commands=e}encode(){return Ce.encode(this.commands)}getBounds(){const e=mt.CALCULATE_BOUNDS();return this.transform(e),e}transform(e){const n=[];for(const r of this.commands){const i=e(r);Array.isArray(i)?n.push(...i):n.push(i)}return this.commands=n,this}reverse(e=!0){return this.commands=mt.REVERSE_PATH(this.commands,e),this}static encode(e){return ur(e)}static parse(e){const n=new Ar,r=[];return n.parse(e,r),n.finish(r),r}};pt(ct,"CLOSE_PATH",1),pt(ct,"MOVE_TO",2),pt(ct,"HORIZ_LINE_TO",4),pt(ct,"VERT_LINE_TO",8),pt(ct,"LINE_TO",16),pt(ct,"CURVE_TO",32),pt(ct,"SMOOTH_CURVE_TO",64),pt(ct,"QUAD_TO",128),pt(ct,"SMOOTH_QUAD_TO",256),pt(ct,"ARC",512),pt(ct,"LINE_COMMANDS",ct.LINE_TO|ct.HORIZ_LINE_TO|ct.VERT_LINE_TO),pt(ct,"DRAWING_COMMANDS",ct.HORIZ_LINE_TO|ct.VERT_LINE_TO|ct.LINE_TO|ct.CURVE_TO|ct.SMOOTH_CURVE_TO|ct.QUAD_TO|ct.SMOOTH_QUAD_TO|ct.ARC);let g=ct;const Cr={[g.MOVE_TO]:2,[g.LINE_TO]:2,[g.HORIZ_LINE_TO]:1,[g.VERT_LINE_TO]:1,[g.CLOSE_PATH]:0,[g.QUAD_TO]:4,[g.SMOOTH_QUAD_TO]:2,[g.CURVE_TO]:6,[g.SMOOTH_CURVE_TO]:4,[g.ARC]:7},Sr=[];for(let t=0;t<256;++t)Sr.push((t+256).toString(16).slice(1));typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const Mr=[];for(let t=0;t<256;++t)Mr.push((t+256).toString(16).slice(1));typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const Ir="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let Lr=(t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t|=0));for(;t--;)e+=Ir[n[t]&63];return e};Lr();const Le=(t,e=0)=>{const{minX:n,minY:r,maxX:i,maxY:s}=t;return{x:n-e,y:r-e,w:i-n+2*e,h:s-r+2*e}},Ut=typeof window>"u"||typeof navigator>"u"?!1:"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,kr=t=>({}),Qe=t=>({grab:t[0]});function Pr(t){let e,n,r,i;const s=t[8].default,o=Zn(s,t,t[7],Qe);return{c(){e=q("g"),o&&o.c(),c(e,"class","a9s-annotation selected")},m(u,l){Q(u,e,l),o&&o.m(e,null),n=!0,r||(i=[ot(e,"pointerup",t[2]),ot(e,"pointermove",t[1])],r=!0)},p(u,[l]){o&&o.p&&(!n||l&128)&&Wn(o,s,u,u[7],n?Kn(s,u[7],l,kr):Qn(u[7]),Qe)},i(u){n||(it(o,u),n=!0)},o(u){ht(o,u),n=!1},d(u){u&&W(e),o&&o.d(u),r=!1,Nt(i)}}}function Ur(t,e,n){let{$$slots:r={},$$scope:i}=e;const s=Me();let{shape:o}=e,{editor:u}=e,{transform:l}=e,{svgEl:a}=e,p,d,m;const T=k=>I=>{if(p=k,a){const{left:Y,top:U}=a.getBoundingClientRect(),j=I.clientX-Y,H=I.clientY-U;d=l.elementToImage(j,H)}else{const{offsetX:Y,offsetY:U}=I;d=l.elementToImage(Y,U)}m=o,I.target.setPointerCapture(I.pointerId),s("grab",I)},$=k=>{if(p){const[I,Y]=l.elementToImage(k.offsetX,k.offsetY),U=[I-d[0],Y-d[1]];n(3,o=u(m,p,U)),s("change",o)}},x=k=>{k.target.releasePointerCapture(k.pointerId),p=void 0,m=o,s("release",k)};return t.$$set=k=>{"shape"in k&&n(3,o=k.shape),"editor"in k&&n(4,u=k.editor),"transform"in k&&n(5,l=k.transform),"svgEl"in k&&n(6,a=k.svgEl),"$$scope"in k&&n(7,i=k.$$scope)},[T,$,x,o,u,l,a,i,r]}class ke extends Jt{constructor(e){super(),Vt(this,e,Ur,Pr,Qt,{shape:3,editor:4,transform:5,svgEl:6})}}function Hr(t){let e,n,r,i,s,o,u,l,a=t[3]&&Ve(t);return{c(){e=q("g"),n=q("circle"),a&&a.c(),i=q("circle"),c(n,"class","a9s-handle-buffer svelte-160z737"),c(n,"cx",t[0]),c(n,"cy",t[1]),c(n,"r",r=t[5]+6/t[2]),c(i,"class",s=oe(`a9s-handle-dot${t[3]?" selected":""}`)+" svelte-160z737"),c(i,"cx",t[0]),c(i,"cy",t[1]),c(i,"r",t[5]),c(e,"class",o=oe(`a9s-handle ${t[8].class||""}`.trim())+" svelte-160z737")},m(p,d){Q(p,e,d),ut(e,n),a&&a.m(e,null),ut(e,i),u||(l=[ot(n,"pointerenter",t[11]),ot(n,"pointerleave",t[12]),ot(n,"pointerdown",t[13]),ot(n,"pointerdown",t[6]),ot(n,"pointerup",t[14]),ot(n,"pointerup",t[7])],u=!0)},p(p,d){d&1&&c(n,"cx",p[0]),d&2&&c(n,"cy",p[1]),d&36&&r!==(r=p[5]+6/p[2])&&c(n,"r",r),p[3]?a?a.p(p,d):(a=Ve(p),a.c(),a.m(e,i)):a&&(a.d(1),a=null),d&8&&s!==(s=oe(`a9s-handle-dot${p[3]?" selected":""}`)+" svelte-160z737")&&c(i,"class",s),d&1&&c(i,"cx",p[0]),d&2&&c(i,"cy",p[1]),d&32&&c(i,"r",p[5]),d&256&&o!==(o=oe(`a9s-handle ${p[8].class||""}`.trim())+" svelte-160z737")&&c(e,"class",o)},d(p){p&&W(e),a&&a.d(),u=!1,Nt(l)}}}function Dr(t){let e,n,r,i,s,o,u,l,a;return{c(){e=q("g"),n=q("circle"),i=q("circle"),o=q("circle"),c(n,"cx",t[0]),c(n,"cy",t[1]),c(n,"r",r=t[5]*10),c(n,"class","a9s-touch-halo svelte-160z737"),je(n,"touched",t[4]),c(i,"cx",t[0]),c(i,"cy",t[1]),c(i,"r",s=t[5]+10/t[2]),c(i,"class","a9s-handle-buffer svelte-160z737"),c(o,"class","a9s-handle-dot svelte-160z737"),c(o,"cx",t[0]),c(o,"cy",t[1]),c(o,"r",u=t[5]+2/t[2]),c(e,"class","a9s-touch-handle")},m(p,d){Q(p,e,d),ut(e,n),ut(e,i),ut(e,o),l||(a=[ot(i,"pointerdown",t[9]),ot(i,"pointerup",t[10]),ot(i,"pointerdown",t[6]),ot(i,"pointerup",t[7])],l=!0)},p(p,d){d&1&&c(n,"cx",p[0]),d&2&&c(n,"cy",p[1]),d&32&&r!==(r=p[5]*10)&&c(n,"r",r),d&16&&je(n,"touched",p[4]),d&1&&c(i,"cx",p[0]),d&2&&c(i,"cy",p[1]),d&36&&s!==(s=p[5]+10/p[2])&&c(i,"r",s),d&1&&c(o,"cx",p[0]),d&2&&c(o,"cy",p[1]),d&36&&u!==(u=p[5]+2/p[2])&&c(o,"r",u)},d(p){p&&W(e),l=!1,Nt(a)}}}function Ve(t){let e,n;return{c(){e=q("circle"),c(e,"class","a9s-handle-selected svelte-160z737"),c(e,"cx",t[0]),c(e,"cy",t[1]),c(e,"r",n=t[5]+8/t[2])},m(r,i){Q(r,e,i)},p(r,i){i&1&&c(e,"cx",r[0]),i&2&&c(e,"cy",r[1]),i&36&&n!==(n=r[5]+8/r[2])&&c(e,"r",n)},d(r){r&&W(e)}}}function Fr(t){let e;function n(i,s){return Ut?Dr:Hr}let r=n()(t);return{c(){r.c(),e=se()},m(i,s){r.m(i,s),Q(i,e,s)},p(i,[s]){r.p(i,s)},i:jt,o:jt,d(i){i&&W(e),r.d(i)}}}function Yr(t,e,n){let r,{x:i}=e,{y:s}=e,{scale:o}=e,{selected:u=void 0}=e,l=!1;const a=I=>{I.pointerType==="touch"&&n(4,l=!0)},p=()=>n(4,l=!1);function d(I){vt.call(this,t,I)}function m(I){vt.call(this,t,I)}function T(I){vt.call(this,t,I)}function $(I){vt.call(this,t,I)}function x(I){vt.call(this,t,I)}function k(I){vt.call(this,t,I)}return t.$$set=I=>{n(8,e=we(we({},e),Ye(I))),"x"in I&&n(0,i=I.x),"y"in I&&n(1,s=I.y),"scale"in I&&n(2,o=I.scale),"selected"in I&&n(3,u=I.selected)},t.$$.update=()=>{t.$$.dirty&4&&n(5,r=4/o)},e=Ye(e),[i,s,o,u,l,r,a,p,e,d,m,T,$,x,k]}class Bt extends Jt{constructor(e){super(),Vt(this,e,Yr,Fr,Qt,{x:0,y:1,scale:2,selected:3})}}function jr(t){let e,n,r,i,s,o,u;return{c(){e=q("g"),n=q("circle"),i=q("circle"),s=q("circle"),c(n,"class","a9s-polygon-midpoint-buffer svelte-12ykj76"),c(n,"cx",t[0]),c(n,"cy",t[1]),c(n,"r",r=1.75*t[2]),c(i,"class","a9s-polygon-midpoint-outer svelte-12ykj76"),c(i,"cx",t[0]),c(i,"cy",t[1]),c(i,"r",t[2]),c(s,"class","a9s-polygon-midpoint-inner svelte-12ykj76"),c(s,"cx",t[0]),c(s,"cy",t[1]),c(s,"r",t[2]),c(e,"class","a9s-polygon-midpoint svelte-12ykj76")},m(l,a){Q(l,e,a),ut(e,n),ut(e,i),ut(e,s),o||(u=[ot(n,"pointerdown",t[5]),ot(n,"pointerdown",t[3])],o=!0)},p(l,a){a&1&&c(n,"cx",l[0]),a&2&&c(n,"cy",l[1]),a&4&&r!==(r=1.75*l[2])&&c(n,"r",r),a&1&&c(i,"cx",l[0]),a&2&&c(i,"cy",l[1]),a&4&&c(i,"r",l[2]),a&1&&c(s,"cx",l[0]),a&2&&c(s,"cy",l[1]),a&4&&c(s,"r",l[2])},d(l){l&&W(e),o=!1,Nt(u)}}}function Xr(t){let e;return{c(){e=q("circle"),c(e,"cx",t[0]),c(e,"cy",t[1]),c(e,"r",t[2])},m(n,r){Q(n,e,r)},p(n,r){r&1&&c(e,"cx",n[0]),r&2&&c(e,"cy",n[1]),r&4&&c(e,"r",n[2])},d(n){n&&W(e)}}}function zr(t){let e;function n(i,s){return Ut?Xr:jr}let r=n()(t);return{c(){r.c(),e=se()},m(i,s){r.m(i,s),Q(i,e,s)},p(i,[s]){r.p(i,s)},i:jt,o:jt,d(i){i&&W(e),r.d(i)}}}function Gr(t,e,n){let r,{x:i}=e,{y:s}=e,{scale:o}=e;const u=a=>{a.pointerType};function l(a){vt.call(this,t,a)}return t.$$set=a=>{"x"in a&&n(0,i=a.x),"y"in a&&n(1,s=a.y),"scale"in a&&n(4,o=a.scale)},t.$$.update=()=>{t.$$.dirty&16&&n(2,r=4/o)},[i,s,r,u,o,l]}class kn extends Jt{constructor(e){super(),Vt(this,e,Gr,zr,Qt,{x:0,y:1,scale:4})}}function ge(t){const e=t.slice(),n=e[10][e[6]];return e[28]=n.point,e}function Je(t,e,n){const r=t.slice();return r[28]=e[n],r[30]=n,r}function xe(t){const e=t.slice(),n=e[10][e[6]];return e[28]=n.point,e}function _e(t){const e=t.slice(),n=e[10][e[6]];return e[28]=n.point,e}function tn(t){let e,n,r,i;return{c(){e=q("circle"),c(e,"cx",n=t[28][0]),c(e,"cy",r=t[28][1]),c(e,"r",i=re/t[3]),c(e,"class","svelte-1h2slbm")},m(s,o){Q(s,e,o)},p(s,o){o[0]&1088&&n!==(n=s[28][0])&&c(e,"cx",n),o[0]&1088&&r!==(r=s[28][1])&&c(e,"cy",r),o[0]&8&&i!==(i=re/s[3])&&c(e,"r",i)},d(s){s&&W(e)}}}function en(t){let e,n,r,i,s,o,u,l,a,p;return{c(){e=q("mask"),n=q("rect"),u=q("circle"),c(n,"x",r=t[9].x),c(n,"y",i=t[9].y),c(n,"width",s=t[9].w),c(n,"height",o=t[9].h),c(n,"class","svelte-1h2slbm"),c(u,"cx",l=t[28][0]),c(u,"cy",a=t[28][1]),c(u,"r",p=re/t[3]),c(u,"class","svelte-1h2slbm"),c(e,"id",`${t[19]}-inner`),c(e,"class","a9s-polygon-editor-mask svelte-1h2slbm")},m(d,m){Q(d,e,m),ut(e,n),ut(e,u)},p(d,m){m[0]&512&&r!==(r=d[9].x)&&c(n,"x",r),m[0]&512&&i!==(i=d[9].y)&&c(n,"y",i),m[0]&512&&s!==(s=d[9].w)&&c(n,"width",s),m[0]&512&&o!==(o=d[9].h)&&c(n,"height",o),m[0]&1088&&l!==(l=d[28][0])&&c(u,"cx",l),m[0]&1088&&a!==(a=d[28][1])&&c(u,"cy",a),m[0]&8&&p!==(p=re/d[3])&&c(u,"r",p)},d(d){d&&W(e)}}}function nn(t){let e,n;return e=new Bt({props:{class:"a9s-corner-handle",x:t[28][0],y:t[28][1],scale:t[3],selected:t[8].includes(t[30])}}),e.$on("pointerenter",t[11]),e.$on("pointerleave",t[12]),e.$on("pointerdown",t[15]),e.$on("pointerdown",function(){gt(t[27](`HANDLE-${t[30]}`))&&t[27](`HANDLE-${t[30]}`).apply(this,arguments)}),e.$on("pointerup",t[16](t[30])),{c(){Rt(e.$$.fragment)},m(r,i){$t(e,r,i),n=!0},p(r,i){t=r;const s={};i[0]&32&&(s.x=t[28][0]),i[0]&32&&(s.y=t[28][1]),i[0]&8&&(s.scale=t[3]),i[0]&256&&(s.selected=t[8].includes(t[30])),e.$set(s)},i(r){n||(it(e.$$.fragment,r),n=!0)},o(r){ht(e.$$.fragment,r),n=!1},d(r){bt(e,r)}}}function rn(t){let e,n;return e=new kn({props:{x:t[28][0],y:t[28][1],scale:t[3]}}),e.$on("pointerdown",function(){gt(t[18](t[6]))&&t[18](t[6]).apply(this,arguments)}),{c(){Rt(e.$$.fragment)},m(r,i){$t(e,r,i),n=!0},p(r,i){t=r;const s={};i[0]&1088&&(s.x=t[28][0]),i[0]&1088&&(s.y=t[28][1]),i[0]&8&&(s.scale=t[3]),e.$set(s)},i(r){n||(it(e.$$.fragment,r),n=!0)},o(r){ht(e.$$.fragment,r),n=!1},d(r){bt(e,r)}}}function qr(t){let e,n,r,i,s,o,u,l,a,p,d,m,T,$,x,k,I,Y,U,j,H,A=t[6]!==void 0&&!t[7]&&tn(_e(t)),_=t[6]!==void 0&&!t[7]&&en(xe(t)),f=Ht(t[5].points),h=[];for(let v=0;v<f.length;v+=1)h[v]=nn(Je(t,f,v));const y=v=>ht(h[v],1,1,()=>{h[v]=null});let w=t[6]!==void 0&&!t[7]&&rn(ge(t));return{c(){e=q("defs"),n=q("mask"),r=q("rect"),l=q("polygon"),A&&A.c(),_&&_.c(),p=Et(),d=q("polygon"),T=Et(),$=q("polygon"),k=Et();for(let v=0;v<h.length;v+=1)h[v].c();I=Et(),w&&w.c(),Y=se(),c(r,"x",i=t[9].x),c(r,"y",s=t[9].y),c(r,"width",o=t[9].w),c(r,"height",u=t[9].h),c(r,"class","svelte-1h2slbm"),c(l,"points",a=t[5].points.map(sn).join(" ")),c(l,"class","svelte-1h2slbm"),c(n,"id",`${t[19]}-outer`),c(n,"class","a9s-polygon-editor-mask svelte-1h2slbm"),c(d,"class","a9s-outer"),c(d,"mask",`url(#${t[19]}-outer)`),c(d,"points",m=t[5].points.map(on).join(" ")),c($,"class","a9s-inner a9s-shape-handle"),c($,"mask",`url(#${t[19]}-inner)`),c($,"style",t[1]),c($,"points",x=t[5].points.map(an).join(" "))},m(v,N){Q(v,e,N),ut(e,n),ut(n,r),ut(n,l),A&&A.m(n,null),_&&_.m(e,null),Q(v,p,N),Q(v,d,N),Q(v,T,N),Q(v,$,N),Q(v,k,N);for(let O=0;O<h.length;O+=1)h[O]&&h[O].m(v,N);Q(v,I,N),w&&w.m(v,N),Q(v,Y,N),U=!0,j||(H=[ot(d,"pointerup",t[14]),ot(d,"pointerdown",function(){gt(t[27]("SHAPE"))&&t[27]("SHAPE").apply(this,arguments)}),ot($,"pointermove",t[13]),ot($,"pointerup",t[14]),ot($,"pointerdown",function(){gt(t[27]("SHAPE"))&&t[27]("SHAPE").apply(this,arguments)})],j=!0)},p(v,N){if(t=v,(!U||N[0]&512&&i!==(i=t[9].x))&&c(r,"x",i),(!U||N[0]&512&&s!==(s=t[9].y))&&c(r,"y",s),(!U||N[0]&512&&o!==(o=t[9].w))&&c(r,"width",o),(!U||N[0]&512&&u!==(u=t[9].h))&&c(r,"height",u),(!U||N[0]&32&&a!==(a=t[5].points.map(sn).join(" ")))&&c(l,"points",a),t[6]!==void 0&&!t[7]?A?A.p(_e(t),N):(A=tn(_e(t)),A.c(),A.m(n,null)):A&&(A.d(1),A=null),t[6]!==void 0&&!t[7]?_?_.p(xe(t),N):(_=en(xe(t)),_.c(),_.m(e,null)):_&&(_.d(1),_=null),(!U||N[0]&32&&m!==(m=t[5].points.map(on).join(" ")))&&c(d,"points",m),(!U||N[0]&2)&&c($,"style",t[1]),(!U||N[0]&32&&x!==(x=t[5].points.map(an).join(" ")))&&c($,"points",x),N[0]&134322472){f=Ht(t[5].points);let O;for(O=0;O<f.length;O+=1){const E=Je(t,f,O);h[O]?(h[O].p(E,N),it(h[O],1)):(h[O]=nn(E),h[O].c(),it(h[O],1),h[O].m(I.parentNode,I))}for(Kt(),O=f.length;O<h.length;O+=1)y(O);Wt()}t[6]!==void 0&&!t[7]?w?(w.p(ge(t),N),N[0]&192&&it(w,1)):(w=rn(ge(t)),w.c(),it(w,1),w.m(Y.parentNode,Y)):w&&(Kt(),ht(w,1,1,()=>{w=null}),Wt())},i(v){if(!U){for(let N=0;N<f.length;N+=1)it(h[N]);it(w),U=!0}},o(v){h=h.filter(Boolean);for(let N=0;N<h.length;N+=1)ht(h[N]);ht(w),U=!1},d(v){v&&(W(e),W(p),W(d),W(T),W($),W(k),W(I),W(Y)),A&&A.d(),_&&_.d(),ue(h,v),w&&w.d(v),j=!1,Nt(H)}}}function Br(t){let e,n;return e=new ke({props:{shape:t[0],transform:t[2],editor:t[17],svgEl:t[4],$$slots:{default:[qr,({grab:r})=>({27:r}),({grab:r})=>[r?134217728:0]]},$$scope:{ctx:t}}}),e.$on("change",t[20]),e.$on("grab",t[21]),e.$on("release",t[22]),{c(){Rt(e.$$.fragment)},m(r,i){$t(e,r,i),n=!0},p(r,i){const s={};i[0]&1&&(s.shape=r[0]),i[0]&4&&(s.transform=r[2]),i[0]&16&&(s.svgEl=r[4]),i[0]&134219754|i[1]&1&&(s.$$scope={dirty:i,ctx:r}),e.$set(s)},i(r){n||(it(e.$$.fragment,r),n=!0)},o(r){ht(e.$$.fragment,r),n=!1},d(r){bt(e,r)}}}const Zr=250,Kr=1e3,Wr=12,re=4.5,sn=t=>t.join(","),on=t=>t.join(","),an=t=>t.join(",");function Qr(t,e,n){let r,i,s;const o=Me();let{shape:u}=e,{computedStyle:l}=e,{transform:a}=e,{viewportScale:p=1}=e,{svgEl:d}=e,m,T=!1,$,x=[];const k=()=>n(7,T=!0),I=()=>n(7,T=!1),Y=O=>{if(x.length>0){n(6,m=void 0);return}const[E,P]=a.elementToImage(O.offsetX,O.offsetY),b=R=>Math.pow(R[0]-E,2)+Math.pow(R[1]-P,2),D=r.points.reduce((R,M)=>b(M)<b(R)?M:R),C=i.filter(R=>R.visible).reduce((R,M)=>b(M.point)<b(R.point)?M:R),F=Math.pow(Kr/p,2);b(D)<F||b(C.point)<F?n(6,m=i.indexOf(C)):n(6,m=void 0)},U=()=>{document.activeElement!==d&&d.focus()},j=()=>{n(8,x=[]),U()},H=O=>{n(7,T=!0),O.preventDefault(),O.stopPropagation(),$=performance.now()},A=O=>E=>{if(!$||Ut||performance.now()-$>Zr)return;const P=x.includes(O);E.metaKey||E.ctrlKey||E.shiftKey?P?n(8,x=x.filter(b=>b!==O)):n(8,x=[...x,O]):P&&x.length>1?n(8,x=[O]):P?n(8,x=[]):n(8,x=[O]),U()},_=(O,E,P)=>{U();let b;const D=O.geometry;x.length>1?b=D.points.map(([F,R],M)=>x.includes(M)?[F+P[0],R+P[1]]:[F,R]):E==="SHAPE"?b=D.points.map(([F,R])=>[F+P[0],R+P[1]]):b=D.points.map(([F,R],M)=>E===`HANDLE-${M}`?[F+P[0],R+P[1]]:[F,R]);const C=Lt(b);return{...O,geometry:{points:b,bounds:C}}},f=O=>async E=>{E.stopPropagation();const P=[...r.points.slice(0,O+1),i[O].point,...r.points.slice(O+1)],b=Lt(P);o("change",{...u,geometry:{points:P,bounds:b}}),await Rn();const D=[...document.querySelectorAll(".a9s-handle")][O+1];if(D!=null&&D.firstChild){const C=new PointerEvent("pointerdown",{bubbles:!0,cancelable:!0,clientX:E.clientX,clientY:E.clientY,pointerId:E.pointerId,pointerType:E.pointerType,isPrimary:E.isPrimary,buttons:E.buttons});D.firstChild.dispatchEvent(C)}},h=()=>{if(r.points.length<4)return;const O=r.points.filter((P,b)=>!x.includes(b)),E=Lt(O);o("change",{...u,geometry:{points:O,bounds:E}}),n(8,x=[])};$n(()=>{if(Ut)return;const O=E=>{(E.key==="Delete"||E.key==="Backspace")&&(E.preventDefault(),h())};return d.addEventListener("pointermove",Y),d.addEventListener("keydown",O),()=>{d.removeEventListener("pointermove",Y),d.removeEventListener("keydown",O)}});const y=`polygon-mask-${Math.random().toString(36).substring(2,12)}`;function w(O){vt.call(this,t,O)}function v(O){vt.call(this,t,O)}function N(O){vt.call(this,t,O)}return t.$$set=O=>{"shape"in O&&n(0,u=O.shape),"computedStyle"in O&&n(1,l=O.computedStyle),"transform"in O&&n(2,a=O.transform),"viewportScale"in O&&n(3,p=O.viewportScale),"svgEl"in O&&n(4,d=O.svgEl)},t.$$.update=()=>{t.$$.dirty[0]&1&&n(5,r=u.geometry),t.$$.dirty[0]&40&&n(10,i=Ut?[]:r.points.map((O,E)=>{const P=E===r.points.length-1?r.points[0]:r.points[E+1],b=(O[0]+P[0])/2,D=(O[1]+P[1])/2,C=Math.sqrt(Math.pow(P[0]-b,2)+Math.pow(P[1]-D,2))>Wr/p;return{point:[b,D],visible:C}})),t.$$.dirty[0]&40&&n(9,s=Le(r.bounds,re/p))},[u,l,a,p,d,r,m,T,x,s,i,k,I,Y,j,H,A,_,f,y,w,v,N]}class Vr extends Jt{constructor(e){super(),Vt(this,e,Qr,Br,Qt,{shape:0,computedStyle:1,transform:2,viewportScale:3,svgEl:4},null,[-1,-1])}}function Jr(t){let e,n,r,i,s,o,u,l,a,p,d,m,T,$,x,k,I,Y,U,j,H,A,_,f,h,y,w,v,N,O,E,P,b,D,C,F,R,M,S,J,V,at,xt,K,tt,nt,X,rt,ft,et,st,B,G,Z,lt;return nt=new Bt({props:{class:"a9s-corner-handle-topleft",x:t[5].x,y:t[5].y,scale:t[3]}}),nt.$on("pointerdown",function(){gt(t[12]("TOP_LEFT"))&&t[12]("TOP_LEFT").apply(this,arguments)}),rt=new Bt({props:{class:"a9s-corner-handle-topright",x:t[5].x+t[5].w,y:t[5].y,scale:t[3]}}),rt.$on("pointerdown",function(){gt(t[12]("TOP_RIGHT"))&&t[12]("TOP_RIGHT").apply(this,arguments)}),et=new Bt({props:{class:"a9s-corner-handle-bottomright",x:t[5].x+t[5].w,y:t[5].y+t[5].h,scale:t[3]}}),et.$on("pointerdown",function(){gt(t[12]("BOTTOM_RIGHT"))&&t[12]("BOTTOM_RIGHT").apply(this,arguments)}),B=new Bt({props:{class:"a9s-corner-handle-bottomleft",x:t[5].x,y:t[5].y+t[5].h,scale:t[3]}}),B.$on("pointerdown",function(){gt(t[12]("BOTTOM_LEFT"))&&t[12]("BOTTOM_LEFT").apply(this,arguments)}),{c(){e=q("defs"),n=q("mask"),r=q("rect"),l=q("rect"),T=Et(),$=q("rect"),U=Et(),j=q("rect"),h=Et(),y=q("rect"),O=Et(),E=q("rect"),C=Et(),F=q("rect"),J=Et(),V=q("rect"),tt=Et(),Rt(nt.$$.fragment),X=Et(),Rt(rt.$$.fragment),ft=Et(),Rt(et.$$.fragment),st=Et(),Rt(B.$$.fragment),c(r,"class","rect-mask-bg svelte-1njczvj"),c(r,"x",i=t[6].x),c(r,"y",s=t[6].y),c(r,"width",o=t[6].w),c(r,"height",u=t[6].h),c(l,"class","rect-mask-fg svelte-1njczvj"),c(l,"x",a=t[5].x),c(l,"y",p=t[5].y),c(l,"width",d=t[5].w),c(l,"height",m=t[5].h),c(n,"id",t[8]),c(n,"class","a9s-rectangle-editor-mask svelte-1njczvj"),c($,"class","a9s-outer"),c($,"mask",`url(#${t[8]})`),c($,"x",x=t[5].x),c($,"y",k=t[5].y),c($,"width",I=t[5].w),c($,"height",Y=t[5].h),c(j,"class","a9s-inner a9s-shape-handle"),c(j,"style",t[1]),c(j,"x",H=t[5].x),c(j,"y",A=t[5].y),c(j,"width",_=t[5].w),c(j,"height",f=t[5].h),c(y,"class","a9s-edge-handle a9s-edge-handle-top"),c(y,"x",w=t[5].x),c(y,"y",v=t[5].y),c(y,"height",1),c(y,"width",N=t[5].w),c(E,"class","a9s-edge-handle a9s-edge-handle-right"),c(E,"x",P=t[5].x+t[5].w),c(E,"y",b=t[5].y),c(E,"height",D=t[5].h),c(E,"width",1),c(F,"class","a9s-edge-handle a9s-edge-handle-bottom"),c(F,"x",R=t[5].x),c(F,"y",M=t[5].y+t[5].h),c(F,"height",1),c(F,"width",S=t[5].w),c(V,"class","a9s-edge-handle a9s-edge-handle-left"),c(V,"x",at=t[5].x),c(V,"y",xt=t[5].y),c(V,"height",K=t[5].h),c(V,"width",1)},m(z,L){Q(z,e,L),ut(e,n),ut(n,r),ut(n,l),Q(z,T,L),Q(z,$,L),Q(z,U,L),Q(z,j,L),Q(z,h,L),Q(z,y,L),Q(z,O,L),Q(z,E,L),Q(z,C,L),Q(z,F,L),Q(z,J,L),Q(z,V,L),Q(z,tt,L),$t(nt,z,L),Q(z,X,L),$t(rt,z,L),Q(z,ft,L),$t(et,z,L),Q(z,st,L),$t(B,z,L),G=!0,Z||(lt=[ot($,"pointerdown",function(){gt(t[12]("SHAPE"))&&t[12]("SHAPE").apply(this,arguments)}),ot(j,"pointerdown",function(){gt(t[12]("SHAPE"))&&t[12]("SHAPE").apply(this,arguments)}),ot(y,"pointerdown",function(){gt(t[12]("TOP"))&&t[12]("TOP").apply(this,arguments)}),ot(E,"pointerdown",function(){gt(t[12]("RIGHT"))&&t[12]("RIGHT").apply(this,arguments)}),ot(F,"pointerdown",function(){gt(t[12]("BOTTOM"))&&t[12]("BOTTOM").apply(this,arguments)}),ot(V,"pointerdown",function(){gt(t[12]("LEFT"))&&t[12]("LEFT").apply(this,arguments)})],Z=!0)},p(z,L){t=z,(!G||L&64&&i!==(i=t[6].x))&&c(r,"x",i),(!G||L&64&&s!==(s=t[6].y))&&c(r,"y",s),(!G||L&64&&o!==(o=t[6].w))&&c(r,"width",o),(!G||L&64&&u!==(u=t[6].h))&&c(r,"height",u),(!G||L&32&&a!==(a=t[5].x))&&c(l,"x",a),(!G||L&32&&p!==(p=t[5].y))&&c(l,"y",p),(!G||L&32&&d!==(d=t[5].w))&&c(l,"width",d),(!G||L&32&&m!==(m=t[5].h))&&c(l,"height",m),(!G||L&32&&x!==(x=t[5].x))&&c($,"x",x),(!G||L&32&&k!==(k=t[5].y))&&c($,"y",k),(!G||L&32&&I!==(I=t[5].w))&&c($,"width",I),(!G||L&32&&Y!==(Y=t[5].h))&&c($,"height",Y),(!G||L&2)&&c(j,"style",t[1]),(!G||L&32&&H!==(H=t[5].x))&&c(j,"x",H),(!G||L&32&&A!==(A=t[5].y))&&c(j,"y",A),(!G||L&32&&_!==(_=t[5].w))&&c(j,"width",_),(!G||L&32&&f!==(f=t[5].h))&&c(j,"height",f),(!G||L&32&&w!==(w=t[5].x))&&c(y,"x",w),(!G||L&32&&v!==(v=t[5].y))&&c(y,"y",v),(!G||L&32&&N!==(N=t[5].w))&&c(y,"width",N),(!G||L&32&&P!==(P=t[5].x+t[5].w))&&c(E,"x",P),(!G||L&32&&b!==(b=t[5].y))&&c(E,"y",b),(!G||L&32&&D!==(D=t[5].h))&&c(E,"height",D),(!G||L&32&&R!==(R=t[5].x))&&c(F,"x",R),(!G||L&32&&M!==(M=t[5].y+t[5].h))&&c(F,"y",M),(!G||L&32&&S!==(S=t[5].w))&&c(F,"width",S),(!G||L&32&&at!==(at=t[5].x))&&c(V,"x",at),(!G||L&32&&xt!==(xt=t[5].y))&&c(V,"y",xt),(!G||L&32&&K!==(K=t[5].h))&&c(V,"height",K);const Tt={};L&32&&(Tt.x=t[5].x),L&32&&(Tt.y=t[5].y),L&8&&(Tt.scale=t[3]),nt.$set(Tt);const St={};L&32&&(St.x=t[5].x+t[5].w),L&32&&(St.y=t[5].y),L&8&&(St.scale=t[3]),rt.$set(St);const dt={};L&32&&(dt.x=t[5].x+t[5].w),L&32&&(dt.y=t[5].y+t[5].h),L&8&&(dt.scale=t[3]),et.$set(dt);const Ot={};L&32&&(Ot.x=t[5].x),L&32&&(Ot.y=t[5].y+t[5].h),L&8&&(Ot.scale=t[3]),B.$set(Ot)},i(z){G||(it(nt.$$.fragment,z),it(rt.$$.fragment,z),it(et.$$.fragment,z),it(B.$$.fragment,z),G=!0)},o(z){ht(nt.$$.fragment,z),ht(rt.$$.fragment,z),ht(et.$$.fragment,z),ht(B.$$.fragment,z),G=!1},d(z){z&&(W(e),W(T),W($),W(U),W(j),W(h),W(y),W(O),W(E),W(C),W(F),W(J),W(V),W(tt),W(X),W(ft),W(st)),bt(nt,z),bt(rt,z),bt(et,z),bt(B,z),Z=!1,Nt(lt)}}}function ti(t){let e,n;return e=new ke({props:{shape:t[0],transform:t[2],editor:t[7],svgEl:t[4],$$slots:{default:[Jr,({grab:r})=>({12:r}),({grab:r})=>r?4096:0]},$$scope:{ctx:t}}}),e.$on("grab",t[9]),e.$on("change",t[10]),e.$on("release",t[11]),{c(){Rt(e.$$.fragment)},m(r,i){$t(e,r,i),n=!0},p(r,[i]){const s={};i&1&&(s.shape=r[0]),i&4&&(s.transform=r[2]),i&16&&(s.svgEl=r[4]),i&12394&&(s.$$scope={dirty:i,ctx:r}),e.$set(s)},i(r){n||(it(e.$$.fragment,r),n=!0)},o(r){ht(e.$$.fragment,r),n=!1},d(r){bt(e,r)}}}function ei(t,e,n){let r,i,{shape:s}=e,{computedStyle:o}=e,{transform:u}=e,{viewportScale:l=1}=e,{svgEl:a}=e;const p=(x,k,I)=>{const Y=x.geometry.bounds;let[U,j]=[Y.minX,Y.minY],[H,A]=[Y.maxX,Y.maxY];const[_,f]=I;if(k==="SHAPE")U+=_,H+=_,j+=f,A+=f;else{switch(k){case"TOP":case"TOP_LEFT":case"TOP_RIGHT":{j+=f;break}case"BOTTOM":case"BOTTOM_LEFT":case"BOTTOM_RIGHT":{A+=f;break}}switch(k){case"LEFT":case"TOP_LEFT":case"BOTTOM_LEFT":{U+=_;break}case"RIGHT":case"TOP_RIGHT":case"BOTTOM_RIGHT":{H+=_;break}}}const h=Math.min(U,H),y=Math.min(j,A),w=Math.abs(H-U),v=Math.abs(A-j);return{...x,geometry:{x:h,y,w,h:v,bounds:{minX:h,minY:y,maxX:h+w,maxY:y+v}}}},d=`rect-mask-${Math.random().toString(36).substring(2,12)}`;function m(x){vt.call(this,t,x)}function T(x){vt.call(this,t,x)}function $(x){vt.call(this,t,x)}return t.$$set=x=>{"shape"in x&&n(0,s=x.shape),"computedStyle"in x&&n(1,o=x.computedStyle),"transform"in x&&n(2,u=x.transform),"viewportScale"in x&&n(3,l=x.viewportScale),"svgEl"in x&&n(4,a=x.svgEl)},t.$$.update=()=>{t.$$.dirty&1&&n(5,r=s.geometry),t.$$.dirty&40&&n(6,i=Le(r.bounds,2/l))},[s,o,u,l,a,r,i,p,d,m,T,$]}class ni extends Jt{constructor(e){super(),Vt(this,e,ei,ti,Qt,{shape:0,computedStyle:1,transform:2,viewportScale:3,svgEl:4})}}var ln=Object.prototype.hasOwnProperty;function Se(t,e){var n,r;if(t===e)return!0;if(t&&e&&(n=t.constructor)===e.constructor){if(n===Date)return t.getTime()===e.getTime();if(n===RegExp)return t.toString()===e.toString();if(n===Array){if((r=t.length)===e.length)for(;r--&&Se(t[r],e[r]););return r===-1}if(!n||typeof t=="object"){r=0;for(n in t)if(ln.call(t,n)&&++r&&!ln.call(e,n)||!(n in e)||!Se(t[n],e[n]))return!1;return Object.keys(e).length===r}}return t!==t&&e!==e}const ri=12,ii=(t,e)=>t.polygons.reduce((n,r,i)=>{const s=r.rings.reduce((o,u,l)=>{const a=u.points.map((p,d)=>{const m=d===u.points.length-1?u.points[0]:u.points[d+1],T=(p[0]+m[0])/2,$=(p[1]+m[1])/2,x=Math.sqrt(Math.pow(m[0]-T,2)+Math.pow(m[1]-$,2))>ri/e;return{point:[T,$],visible:x,elementIdx:i,ringIdx:l,pointIdx:d}});return[...o,...a]},[]);return[...n,...s]},[]);function ve(t){const e=t.slice(),n=e[10][e[6]];return e[29]=n.point,e}function cn(t,e,n){const r=t.slice();return r[30]=e[n],r[32]=n,r}function un(t,e,n){const r=t.slice();return r[33]=e[n],r[35]=n,r}function hn(t,e,n){const r=t.slice();return r[29]=e[n],r[37]=n,r}function Te(t){const e=t.slice(),n=e[10][e[6]];return e[29]=n.point,e}function Oe(t){const e=t.slice(),n=e[10][e[6]];return e[29]=n.point,e}function fn(t){let e,n,r,i;return{c(){e=q("circle"),c(e,"cx",n=t[29][0]),c(e,"cy",r=t[29][1]),c(e,"r",i=ie/t[3]),c(e,"class","svelte-1vxo6dc")},m(s,o){Q(s,e,o)},p(s,o){o[0]&1088&&n!==(n=s[29][0])&&c(e,"cx",n),o[0]&1088&&r!==(r=s[29][1])&&c(e,"cy",r),o[0]&8&&i!==(i=ie/s[3])&&c(e,"r",i)},d(s){s&&W(e)}}}function pn(t){let e,n,r,i,s,o,u,l,a,p;return{c(){e=q("mask"),n=q("rect"),u=q("circle"),c(n,"x",r=t[9].x),c(n,"y",i=t[9].y),c(n,"width",s=t[9].w),c(n,"height",o=t[9].h),c(n,"class","svelte-1vxo6dc"),c(u,"cx",l=t[29][0]),c(u,"cy",a=t[29][1]),c(u,"r",p=ie/t[3]),c(u,"class","svelte-1vxo6dc"),c(e,"id",`${t[18]}-${t[32]}-inner`),c(e,"class","a9s-multipolygon-editor-mask svelte-1vxo6dc")},m(d,m){Q(d,e,m),ut(e,n),ut(e,u)},p(d,m){m[0]&512&&r!==(r=d[9].x)&&c(n,"x",r),m[0]&512&&i!==(i=d[9].y)&&c(n,"y",i),m[0]&512&&s!==(s=d[9].w)&&c(n,"width",s),m[0]&512&&o!==(o=d[9].h)&&c(n,"height",o),m[0]&1088&&l!==(l=d[29][0])&&c(u,"cx",l),m[0]&1088&&a!==(a=d[29][1])&&c(u,"cy",a),m[0]&8&&p!==(p=ie/d[3])&&c(u,"r",p)},d(d){d&&W(e)}}}function dn(t){let e,n;function r(...i){return t[19](t[32],t[35],t[37],...i)}return e=new Bt({props:{class:"a9s-corner-handle",x:t[29][0],y:t[29][1],scale:t[3],selected:t[8].some(r)}}),e.$on("pointerenter",t[11]),e.$on("pointerleave",t[12]),e.$on("pointerdown",t[14]),e.$on("pointerdown",function(){gt(t[28](`HANDLE-${t[32]}-${t[35]}-${t[37]}`))&&t[28](`HANDLE-${t[32]}-${t[35]}-${t[37]}`).apply(this,arguments)}),e.$on("pointerup",t[15](t[32],t[35],t[37])),{c(){Rt(e.$$.fragment)},m(i,s){$t(e,i,s),n=!0},p(i,s){t=i;const o={};s[0]&32&&(o.x=t[29][0]),s[0]&32&&(o.y=t[29][1]),s[0]&8&&(o.scale=t[3]),s[0]&256&&(o.selected=t[8].some(r)),e.$set(o)},i(i){n||(it(e.$$.fragment,i),n=!0)},o(i){ht(e.$$.fragment,i),n=!1},d(i){bt(e,i)}}}function yn(t){let e,n,r=Ht(t[33].points),i=[];for(let o=0;o<r.length;o+=1)i[o]=dn(hn(t,r,o));const s=o=>ht(i[o],1,1,()=>{i[o]=null});return{c(){for(let o=0;o<i.length;o+=1)i[o].c();e=se()},m(o,u){for(let l=0;l<i.length;l+=1)i[l]&&i[l].m(o,u);Q(o,e,u),n=!0},p(o,u){if(u[0]&268491048){r=Ht(o[33].points);let l;for(l=0;l<r.length;l+=1){const a=hn(o,r,l);i[l]?(i[l].p(a,u),it(i[l],1)):(i[l]=dn(a),i[l].c(),it(i[l],1),i[l].m(e.parentNode,e))}for(Kt(),l=r.length;l<i.length;l+=1)s(l);Wt()}},i(o){if(!n){for(let u=0;u<r.length;u+=1)it(i[u]);n=!0}},o(o){i=i.filter(Boolean);for(let u=0;u<i.length;u+=1)ht(i[u]);n=!1},d(o){o&&W(e),ue(i,o)}}}function mn(t){let e,n,r,i,s,o,u,l,a,p,d,m,T,$,x,k,I,Y=t[6]!==void 0&&!t[7]&&fn(Oe(t)),U=t[6]!==void 0&&!t[7]&&pn(Te(t)),j=Ht(t[30].rings),H=[];for(let _=0;_<j.length;_+=1)H[_]=yn(un(t,j,_));const A=_=>ht(H[_],1,1,()=>{H[_]=null});return{c(){e=q("g"),n=q("defs"),r=q("mask"),i=q("rect"),a=q("path"),Y&&Y.c(),U&&U.c(),d=q("path"),T=q("path");for(let _=0;_<H.length;_+=1)H[_].c();c(i,"x",s=t[9].x),c(i,"y",o=t[9].y),c(i,"width",u=t[9].w),c(i,"height",l=t[9].h),c(i,"class","svelte-1vxo6dc"),c(a,"d",p=Gt(t[30])),c(a,"class","svelte-1vxo6dc"),c(r,"id",`${t[18]}-${t[32]}-outer`),c(r,"class","a9s-multipolygon-editor-mask svelte-1vxo6dc"),c(d,"class","a9s-outer"),c(d,"mask",`url(#${t[18]}-${t[32]}-outer)`),c(d,"fill-rule","evenodd"),c(d,"d",m=Gt(t[30])),c(T,"class","a9s-inner"),c(T,"mask",`url(#${t[18]}-${t[32]}-inner)`),c(T,"style",t[1]),c(T,"fill-rule","evenodd"),c(T,"d",$=Gt(t[30]))},m(_,f){Q(_,e,f),ut(e,n),ut(n,r),ut(r,i),ut(r,a),Y&&Y.m(r,null),U&&U.m(n,null),ut(e,d),ut(e,T);for(let h=0;h<H.length;h+=1)H[h]&&H[h].m(e,null);x=!0,k||(I=[ot(d,"pointerup",t[13]),ot(d,"pointerdown",function(){gt(t[28]("SHAPE"))&&t[28]("SHAPE").apply(this,arguments)}),ot(T,"pointerup",t[13]),ot(T,"pointerdown",function(){gt(t[28]("SHAPE"))&&t[28]("SHAPE").apply(this,arguments)})],k=!0)},p(_,f){if(t=_,(!x||f[0]&512&&s!==(s=t[9].x))&&c(i,"x",s),(!x||f[0]&512&&o!==(o=t[9].y))&&c(i,"y",o),(!x||f[0]&512&&u!==(u=t[9].w))&&c(i,"width",u),(!x||f[0]&512&&l!==(l=t[9].h))&&c(i,"height",l),(!x||f[0]&32&&p!==(p=Gt(t[30])))&&c(a,"d",p),t[6]!==void 0&&!t[7]?Y?Y.p(Oe(t),f):(Y=fn(Oe(t)),Y.c(),Y.m(r,null)):Y&&(Y.d(1),Y=null),t[6]!==void 0&&!t[7]?U?U.p(Te(t),f):(U=pn(Te(t)),U.c(),U.m(n,null)):U&&(U.d(1),U=null),(!x||f[0]&32&&m!==(m=Gt(t[30])))&&c(d,"d",m),(!x||f[0]&2)&&c(T,"style",t[1]),(!x||f[0]&32&&$!==($=Gt(t[30])))&&c(T,"d",$),f[0]&268491048){j=Ht(t[30].rings);let h;for(h=0;h<j.length;h+=1){const y=un(t,j,h);H[h]?(H[h].p(y,f),it(H[h],1)):(H[h]=yn(y),H[h].c(),it(H[h],1),H[h].m(e,null))}for(Kt(),h=j.length;h<H.length;h+=1)A(h);Wt()}},i(_){if(!x){for(let f=0;f<j.length;f+=1)it(H[f]);x=!0}},o(_){H=H.filter(Boolean);for(let f=0;f<H.length;f+=1)ht(H[f]);x=!1},d(_){_&&W(e),Y&&Y.d(),U&&U.d(),ue(H,_),k=!1,Nt(I)}}}function gn(t){let e,n;return e=new kn({props:{x:t[29][0],y:t[29][1],scale:t[3]}}),e.$on("pointerdown",function(){gt(t[17](t[6]))&&t[17](t[6]).apply(this,arguments)}),{c(){Rt(e.$$.fragment)},m(r,i){$t(e,r,i),n=!0},p(r,i){t=r;const s={};i[0]&1088&&(s.x=t[29][0]),i[0]&1088&&(s.y=t[29][1]),i[0]&8&&(s.scale=t[3]),e.$set(s)},i(r){n||(it(e.$$.fragment,r),n=!0)},o(r){ht(e.$$.fragment,r),n=!1},d(r){bt(e,r)}}}function si(t){let e,n,r,i=Ht(t[5].polygons),s=[];for(let l=0;l<i.length;l+=1)s[l]=mn(cn(t,i,l));const o=l=>ht(s[l],1,1,()=>{s[l]=null});let u=t[6]!==void 0&&!t[7]&&gn(ve(t));return{c(){for(let l=0;l<s.length;l+=1)s[l].c();e=Et(),u&&u.c(),n=se()},m(l,a){for(let p=0;p<s.length;p+=1)s[p]&&s[p].m(l,a);Q(l,e,a),u&&u.m(l,a),Q(l,n,a),r=!0},p(l,a){if(a[0]&268763114){i=Ht(l[5].polygons);let p;for(p=0;p<i.length;p+=1){const d=cn(l,i,p);s[p]?(s[p].p(d,a),it(s[p],1)):(s[p]=mn(d),s[p].c(),it(s[p],1),s[p].m(e.parentNode,e))}for(Kt(),p=i.length;p<s.length;p+=1)o(p);Wt()}l[6]!==void 0&&!l[7]?u?(u.p(ve(l),a),a[0]&192&&it(u,1)):(u=gn(ve(l)),u.c(),it(u,1),u.m(n.parentNode,n)):u&&(Kt(),ht(u,1,1,()=>{u=null}),Wt())},i(l){if(!r){for(let a=0;a<i.length;a+=1)it(s[a]);it(u),r=!0}},o(l){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)ht(s[a]);ht(u),r=!1},d(l){l&&(W(e),W(n)),ue(s,l),u&&u.d(l)}}}function oi(t){let e,n;return e=new ke({props:{shape:t[0],transform:t[2],editor:t[16],svgEl:t[4],$$slots:{default:[si,({grab:r})=>({28:r}),({grab:r})=>[r?268435456:0]]},$$scope:{ctx:t}}}),e.$on("change",t[20]),e.$on("grab",t[21]),e.$on("release",t[22]),{c(){Rt(e.$$.fragment)},m(r,i){$t(e,r,i),n=!0},p(r,i){const s={};i[0]&1&&(s.shape=r[0]),i[0]&4&&(s.transform=r[2]),i[0]&16&&(s.svgEl=r[4]),i[0]&268437482|i[1]&128&&(s.$$scope={dirty:i,ctx:r}),e.$set(s)},i(r){n||(it(e.$$.fragment,r),n=!0)},o(r){ht(e.$$.fragment,r),n=!1},d(r){bt(e,r)}}}const ai=250,li=1e3,ie=4.5;function ci(t,e,n){let r,i,s;const o=Me();let{shape:u}=e,{computedStyle:l}=e,{transform:a}=e,{viewportScale:p=1}=e,{svgEl:d}=e,m,T=!1,$,x=[];const k=()=>n(7,T=!0),I=()=>n(7,T=!1),Y=E=>{if(x.length>0){n(6,m=void 0);return}const[P,b]=a.elementToImage(E.offsetX,E.offsetY),D=M=>Math.pow(M[0]-P,2)+Math.pow(M[1]-b,2),C=ar(r).reduce((M,S)=>D(S)<D(M)?S:M),F=i.filter(M=>M.visible).reduce((M,S)=>D(S.point)<D(M.point)?S:M),R=Math.pow(li/p,2);D(C)<R||D(F.point)<R?n(6,m=i.indexOf(F)):n(6,m=void 0)},U=()=>{document.activeElement!==d&&d.focus()},j=()=>{n(8,x=[]),U()},H=E=>{n(7,T=!0),E.preventDefault(),E.stopPropagation(),$=performance.now()},A=(E,P,b)=>D=>{if(!$||Ut||performance.now()-$>ai)return;const C=R=>R.polygon===E&&R.ring===P&&R.point===b,F=x.some(C);D.metaKey||D.ctrlKey||D.shiftKey?F?n(8,x=x.filter(R=>!C(R))):n(8,x=[...x,{polygon:E,ring:P,point:b}]):F&&x.length>1?n(8,x=[{polygon:E,ring:P,point:b}]):F?n(8,x=[]):n(8,x=[{polygon:E,ring:P,point:b}]),U()},_=(E,P,b)=>{U();const D=E.geometry.polygons;let C;if(P==="SHAPE")C=D.map(F=>{const R=F.rings.map((S,J)=>({points:S.points.map((V,at)=>[V[0]+b[0],V[1]+b[1]])})),M=Lt(R[0].points);return{rings:R,bounds:M}});else{const[F,R,M,S]=P.split("-").map(J=>parseInt(J));C=D.map((J,V)=>{if(V===R){const at=J.rings.map((K,tt)=>tt===M?{points:K.points.map((nt,X)=>X===S?[nt[0]+b[0],nt[1]+b[1]]:nt)}:K),xt=Lt(at[0].points);return{rings:at,bounds:xt}}else return J})}return{...E,geometry:{polygons:C,bounds:ye(C)}}},f=E=>async P=>{P.stopPropagation();const b=i[E],D=r.polygons.map((F,R)=>{if(R===b.elementIdx){const M=F.rings.map((J,V)=>V===b.ringIdx?{points:[...J.points.slice(0,b.pointIdx+1),b.point,...J.points.slice(b.pointIdx+1)]}:J),S=Lt(M[0].points);return{rings:M,bounds:S}}else return F});o("change",{...u,geometry:{polygons:D,bounds:ye(D)}}),await Rn();const C=[...document.querySelectorAll(".a9s-handle")][E+1];if(C!=null&&C.firstChild){const F=new PointerEvent("pointerdown",{bubbles:!0,cancelable:!0,clientX:P.clientX,clientY:P.clientY,pointerId:P.pointerId,pointerType:P.pointerType,isPrimary:P.isPrimary,buttons:P.buttons});C.firstChild.dispatchEvent(F)}},h=()=>{const E=r.polygons.map((P,b)=>{if(x.some(D=>D.polygon===b)){const D=P.rings.map((F,R)=>x.some(M=>M.polygon===b&&M.ring===R)&&F.points.length>3?{points:F.points.filter((M,S)=>!x.some(J=>J.polygon===b&&J.ring===R&&J.point===S))}:F),C=Lt(D[0].points);return{rings:D,bounds:C}}else return P});!Se(r.polygons,E)&&(o("change",{...u,geometry:{polygons:E,bounds:ye(E)}}),n(8,x=[]))};$n(()=>{if(Ut)return;const E=P=>{(P.key==="Delete"||P.key==="Backspace")&&(P.preventDefault(),h())};return d.addEventListener("pointermove",Y),d.addEventListener("keydown",E),()=>{d.removeEventListener("pointermove",Y),d.removeEventListener("keydown",E)}});const y=`polygon-mask-${Math.random().toString(36).substring(2,12)}`,w=(E,P,b,{polygon:D,ring:C,point:F})=>D===E&&C===P&&F===b;function v(E){vt.call(this,t,E)}function N(E){vt.call(this,t,E)}function O(E){vt.call(this,t,E)}return t.$$set=E=>{"shape"in E&&n(0,u=E.shape),"computedStyle"in E&&n(1,l=E.computedStyle),"transform"in E&&n(2,a=E.transform),"viewportScale"in E&&n(3,p=E.viewportScale),"svgEl"in E&&n(4,d=E.svgEl)},t.$$.update=()=>{t.$$.dirty[0]&1&&n(5,r=u.geometry),t.$$.dirty[0]&40&&n(10,i=Ut?[]:ii(r,p)),t.$$.dirty[0]&40&&n(9,s=Le(r.bounds,ie/p))},[u,l,a,p,d,r,m,T,x,s,i,k,I,j,H,A,_,f,y,w,v,N,O]}class ui extends Jt{constructor(e){super(),Vt(this,e,ci,oi,Qt,{shape:0,computedStyle:1,transform:2,viewportScale:3,svgEl:4},null,[-1,-1])}}kt.RECTANGLE,kt.POLYGON,kt.MULTIPOLYGLON;typeof navigator>"u"||navigator.userAgent.indexOf("Mac OS X");var Ee={exports:{}},xn;function hi(){return xn||(xn=1,function(t){(function(){function e(u,l){var a=u.x-l.x,p=u.y-l.y;return a*a+p*p}function n(u,l,a){var p=l.x,d=l.y,m=a.x-p,T=a.y-d;if(m!==0||T!==0){var $=((u.x-p)*m+(u.y-d)*T)/(m*m+T*T);$>1?(p=a.x,d=a.y):$>0&&(p+=m*$,d+=T*$)}return m=u.x-p,T=u.y-d,m*m+T*T}function r(u,l){for(var a=u[0],p=[a],d,m=1,T=u.length;m<T;m++)d=u[m],e(d,a)>l&&(p.push(d),a=d);return a!==d&&p.push(d),p}function i(u,l,a,p,d){for(var m=p,T,$=l+1;$<a;$++){var x=n(u[$],u[l],u[a]);x>m&&(T=$,m=x)}m>p&&(T-l>1&&i(u,l,T,p,d),d.push(u[T]),a-T>1&&i(u,T,a,p,d))}function s(u,l){var a=u.length-1,p=[u[0]];return i(u,0,a,l,p),p.push(u[a]),p}function o(u,l,a){if(u.length<=2)return u;var p=l!==void 0?l*l:1;return u=a?u:r(u,p),u=s(u,p),u}t.exports=o,t.exports.default=o})()}(Ee)),Ee.exports}var fi=hi();const pi=vn(fi),di=()=>({readFromURL:e=>new Promise(n=>{jn.parse(e,{download:!0,header:!0,complete:r=>{const i=r.data.filter(({pixel_geometry:s})=>!!s).map(s=>{const{pixel_geometry:o,score:u,text:l}=s,a=zn.parse(o);if(a.type!=="Polygon")throw new Error(`Unsupported type: ${a.type}`);const p=a.coordinates[0].map(([T,$])=>({x:T,y:$})),d=pi(p,1,!0).map(({x:T,y:$})=>[T,$]),m={type:kt.POLYGON,geometry:{bounds:Lt(d),points:d}};return{bodies:[{value:l},{purpose:"scoring",value:u}],target:{selector:m}}});n(i)}})})}),yi=di(),_n=10;window.onload=function(){const t=Pn({id:"openseadragon",prefixUrl:"https://cdn.jsdelivr.net/npm/openseadragon@3.1/build/openseadragon/images/",gestureSettingsMouse:{clickToZoom:!1},tileSources:{type:"image",url:"maps/novus_atlas.jpg"},minZoomLevel:.1,maxZoomLevel:100}),e=document.getElementById("tooltip"),n=Un(t,{userSelectAction:Hn.NONE,style:{stroke:"#00aa00",strokeOpacity:.7,fill:"#00ee00",fillOpacity:.18}});yi.readFromURL("maps/novus_atlas_predictions.csv").then(r=>n.setAnnotations(r)),document.body.addEventListener("pointermove",r=>{e.style.left=`${r.clientX+_n}px`,e.style.top=`${r.clientY+_n}px`}),n.on("mouseEnterAnnotation",function(r){var o,u;const i=(o=r.bodies.find(l=>!l.purpose))==null?void 0:o.value,s=(u=r.bodies.find(l=>l.purpose==="scoring"))==null?void 0:u.value;e.innerHTML=`${i} <span class="score">(${s})</span>`,e.style.display="block"}),n.on("mouseLeaveAnnotation",function(r){e.style.display="none"})};
