import{g as Tn,O as Un,d as Hn,$ as Dn}from"./dep-annotorious-Brk2qYCS.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var ue={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/var Fn=ue.exports,He;function Yn(){return He||(He=1,function(t,e){((n,r)=>{t.exports=r()})(Fn,function n(){var r=typeof self<"u"?self:typeof window<"u"?window:r!==void 0?r:{},i,s=!r.document&&!!r.postMessage,o=r.IS_PAPA_WORKER||!1,u={},l=0,a={};function h(p){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(f){var m=H(f);m.chunkSize=parseInt(m.chunkSize),f.step||f.chunk||(m.chunkSize=null),this._handle=new _(m),(this._handle.streamer=this)._config=m}).call(this,p),this.parseChunk=function(f,m){var $=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<$){let N=this._config.newline;N||(T=this._config.quoteChar||'"',N=this._handle.guessLineEndings(f,T)),f=[...f.split(N).slice($)].join(N)}this.isFirstChunk&&v(this._config.beforeFirstChunk)&&(T=this._config.beforeFirstChunk(f))!==void 0&&(f=T),this.isFirstChunk=!1,this._halted=!1;var $=this._partialLine+f,T=(this._partialLine="",this._handle.parse($,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(f=T.meta.cursor,$=(this._finished||(this._partialLine=$.substring(f-this._baseIndex),this._baseIndex=f),T&&T.data&&(this._rowCount+=T.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),o)r.postMessage({results:T,workerId:a.WORKER_ID,finished:$});else if(v(this._config.chunk)&&!m){if(this._config.chunk(T,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=T=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(T.data),this._completeResults.errors=this._completeResults.errors.concat(T.errors),this._completeResults.meta=T.meta),this._completed||!$||!v(this._config.complete)||T&&T.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),$||T&&T.meta.paused||this._nextChunk(),T}this._halted=!0},this._sendError=function(f){v(this._config.error)?this._config.error(f):o&&this._config.error&&r.postMessage({workerId:a.WORKER_ID,error:f,finished:!1})}}function d(p){var f;(p=p||{}).chunkSize||(p.chunkSize=a.RemoteChunkSize),h.call(this,p),this._nextChunk=s?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(m){this._input=m,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(f=new XMLHttpRequest,this._config.withCredentials&&(f.withCredentials=this._config.withCredentials),s||(f.onload=A(this._chunkLoaded,this),f.onerror=A(this._chunkError,this)),f.open(this._config.downloadRequestBody?"POST":"GET",this._input,!s),this._config.downloadRequestHeaders){var m,$=this._config.downloadRequestHeaders;for(m in $)f.setRequestHeader(m,$[m])}var T;this._config.chunkSize&&(T=this._start+this._config.chunkSize-1,f.setRequestHeader("Range","bytes="+this._start+"-"+T));try{f.send(this._config.downloadRequestBody)}catch(N){this._chunkError(N.message)}s&&f.status===0&&this._chunkError()}},this._chunkLoaded=function(){f.readyState===4&&(f.status<200||400<=f.status?this._chunkError():(this._start+=this._config.chunkSize||f.responseText.length,this._finished=!this._config.chunkSize||this._start>=(m=>(m=m.getResponseHeader("Content-Range"))!==null?parseInt(m.substring(m.lastIndexOf("/")+1)):-1)(f),this.parseChunk(f.responseText)))},this._chunkError=function(m){m=f.statusText||m,this._sendError(new Error(m))}}function y(p){(p=p||{}).chunkSize||(p.chunkSize=a.LocalChunkSize),h.call(this,p);var f,m,$=typeof FileReader<"u";this.stream=function(T){this._input=T,m=T.slice||T.webkitSlice||T.mozSlice,$?((f=new FileReader).onload=A(this._chunkLoaded,this),f.onerror=A(this._chunkError,this)):f=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var T=this._input,N=(this._config.chunkSize&&(N=Math.min(this._start+this._config.chunkSize,this._input.size),T=m.call(T,this._start,N)),f.readAsText(T,this._config.encoding));$||this._chunkLoaded({target:{result:N}})},this._chunkLoaded=function(T){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(T.target.result)},this._chunkError=function(){this._sendError(f.error)}}function g(p){var f;h.call(this,p=p||{}),this.stream=function(m){return f=m,this._nextChunk()},this._nextChunk=function(){var m,$;if(!this._finished)return m=this._config.chunkSize,f=m?($=f.substring(0,m),f.substring(m)):($=f,""),this._finished=!f,this.parseChunk($)}}function w(p){h.call(this,p=p||{});var f=[],m=!0,$=!1;this.pause=function(){h.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){h.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(T){this._input=T,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){$&&f.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),f.length?this.parseChunk(f.shift()):m=!0},this._streamData=A(function(T){try{f.push(typeof T=="string"?T:T.toString(this._config.encoding)),m&&(m=!1,this._checkIsFinished(),this.parseChunk(f.shift()))}catch(N){this._streamError(N)}},this),this._streamError=A(function(T){this._streamCleanUp(),this._sendError(T)},this),this._streamEnd=A(function(){this._streamCleanUp(),$=!0,this._streamData("")},this),this._streamCleanUp=A(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function _(p){var f,m,$,T,N=Math.pow(2,53),O=-N,E=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,P=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,b=this,D=0,C=0,F=!1,R=!1,S=[],M={data:[],errors:[],meta:{}};function J(W){return p.skipEmptyLines==="greedy"?W.join("").trim()==="":W.length===1&&W[0].length===0}function V(){if(M&&$&&(xt("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),$=!1),p.skipEmptyLines&&(M.data=M.data.filter(function(X){return!J(X)})),at()){let X=function(rt,ft){v(p.transformHeader)&&(rt=p.transformHeader(rt,ft)),S.push(rt)};if(M)if(Array.isArray(M.data[0])){for(var W=0;at()&&W<M.data.length;W++)M.data[W].forEach(X);M.data.splice(0,1)}else M.data.forEach(X)}function tt(X,rt){for(var ft=p.header?{}:[],et=0;et<X.length;et++){var st=et,B=X[et],B=((G,Z)=>(ut=>(p.dynamicTypingFunction&&p.dynamicTyping[ut]===void 0&&(p.dynamicTyping[ut]=p.dynamicTypingFunction(ut)),(p.dynamicTyping[ut]||p.dynamicTyping)===!0))(G)?Z==="true"||Z==="TRUE"||Z!=="false"&&Z!=="FALSE"&&((ut=>{if(E.test(ut)&&(ut=parseFloat(ut),O<ut&&ut<N))return 1})(Z)?parseFloat(Z):P.test(Z)?new Date(Z):Z===""?null:Z):Z)(st=p.header?et>=S.length?"__parsed_extra":S[et]:st,B=p.transform?p.transform(B,st):B);st==="__parsed_extra"?(ft[st]=ft[st]||[],ft[st].push(B)):ft[st]=B}return p.header&&(et>S.length?xt("FieldMismatch","TooManyFields","Too many fields: expected "+S.length+" fields but parsed "+et,C+rt):et<S.length&&xt("FieldMismatch","TooFewFields","Too few fields: expected "+S.length+" fields but parsed "+et,C+rt)),ft}var nt;M&&(p.header||p.dynamicTyping||p.transform)&&(nt=1,!M.data.length||Array.isArray(M.data[0])?(M.data=M.data.map(tt),nt=M.data.length):M.data=tt(M.data,0),p.header&&M.meta&&(M.meta.fields=S),C+=nt)}function at(){return p.header&&S.length===0}function xt(W,tt,nt,X){W={type:W,code:tt,message:nt},X!==void 0&&(W.row=X),M.errors.push(W)}v(p.step)&&(T=p.step,p.step=function(W){M=W,at()?V():(V(),M.data.length!==0&&(D+=W.data.length,p.preview&&D>p.preview?m.abort():(M.data=M.data[0],T(M,b))))}),this.parse=function(W,tt,nt){var X=p.quoteChar||'"',X=(p.newline||(p.newline=this.guessLineEndings(W,X)),$=!1,p.delimiter?v(p.delimiter)&&(p.delimiter=p.delimiter(W),M.meta.delimiter=p.delimiter):((X=((rt,ft,et,st,B)=>{var G,Z,ut,z;B=B||[",","	","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var L=0;L<B.length;L++){for(var Tt,St=B[L],dt=0,Ot=0,_t=0,wt=(ut=void 0,new I({comments:st,delimiter:St,newline:ft,preview:10}).parse(rt)),It=0;It<wt.data.length;It++)et&&J(wt.data[It])?_t++:(Tt=wt.data[It].length,Ot+=Tt,ut===void 0?ut=Tt:0<Tt&&(dt+=Math.abs(Tt-ut),ut=Tt));0<wt.data.length&&(Ot/=wt.data.length-_t),(Z===void 0||dt<=Z)&&(z===void 0||z<Ot)&&1.99<Ot&&(Z=dt,G=St,z=Ot)}return{successful:!!(p.delimiter=G),bestDelimiter:G}})(W,p.newline,p.skipEmptyLines,p.comments,p.delimitersToGuess)).successful?p.delimiter=X.bestDelimiter:($=!0,p.delimiter=a.DefaultDelimiter),M.meta.delimiter=p.delimiter),H(p));return p.preview&&p.header&&X.preview++,f=W,m=new I(X),M=m.parse(f,tt,nt),V(),F?{meta:{paused:!0}}:M||{meta:{paused:!1}}},this.paused=function(){return F},this.pause=function(){F=!0,m.abort(),f=v(p.chunk)?"":f.substring(m.getCharIndex())},this.resume=function(){b.streamer._halted?(F=!1,b.streamer.parseChunk(f,!0)):setTimeout(b.resume,3)},this.aborted=function(){return R},this.abort=function(){R=!0,m.abort(),M.meta.aborted=!0,v(p.complete)&&p.complete(M),f=""},this.guessLineEndings=function(rt,X){rt=rt.substring(0,1048576);var X=new RegExp(k(X)+"([^]*?)"+k(X),"gm"),nt=(rt=rt.replace(X,"")).split("\r"),X=rt.split(`
`),rt=1<X.length&&X[0].length<nt[0].length;if(nt.length===1||rt)return`
`;for(var ft=0,et=0;et<nt.length;et++)nt[et][0]===`
`&&ft++;return ft>=nt.length/2?`\r
`:"\r"}}function k(p){return p.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function I(p){var f=(p=p||{}).delimiter,m=p.newline,$=p.comments,T=p.step,N=p.preview,O=p.fastMode,E=null,P=!1,b=p.quoteChar==null?'"':p.quoteChar,D=b;if(p.escapeChar!==void 0&&(D=p.escapeChar),(typeof f!="string"||-1<a.BAD_DELIMITERS.indexOf(f))&&(f=","),$===f)throw new Error("Comment character same as delimiter");$===!0?$="#":(typeof $!="string"||-1<a.BAD_DELIMITERS.indexOf($))&&($=!1),m!==`
`&&m!=="\r"&&m!==`\r
`&&(m=`
`);var C=0,F=!1;this.parse=function(R,S,M){if(typeof R!="string")throw new Error("Input must be a string");var J=R.length,V=f.length,at=m.length,xt=$.length,W=v(T),tt=[],nt=[],X=[],rt=C=0;if(!R)return dt();if(O||O!==!1&&R.indexOf(b)===-1){for(var ft=R.split(m),et=0;et<ft.length;et++){if(X=ft[et],C+=X.length,et!==ft.length-1)C+=m.length;else if(M)return dt();if(!$||X.substring(0,xt)!==$){if(W){if(tt=[],z(X.split(f)),Ot(),F)return dt()}else z(X.split(f));if(N&&N<=et)return tt=tt.slice(0,N),dt(!0)}}return dt()}for(var st=R.indexOf(f,C),B=R.indexOf(m,C),G=new RegExp(k(D)+k(b),"g"),Z=R.indexOf(b,C);;)if(R[C]===b)for(Z=C,C++;;){if((Z=R.indexOf(b,Z+1))===-1)return M||nt.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:tt.length,index:C}),Tt();if(Z===J-1)return Tt(R.substring(C,Z).replace(G,b));if(b===D&&R[Z+1]===D)Z++;else if(b===D||Z===0||R[Z-1]!==D){st!==-1&&st<Z+1&&(st=R.indexOf(f,Z+1));var ut=L((B=B!==-1&&B<Z+1?R.indexOf(m,Z+1):B)===-1?st:Math.min(st,B));if(R.substr(Z+1+ut,V)===f){X.push(R.substring(C,Z).replace(G,b)),R[C=Z+1+ut+V]!==b&&(Z=R.indexOf(b,C)),st=R.indexOf(f,C),B=R.indexOf(m,C);break}if(ut=L(B),R.substring(Z+1+ut,Z+1+ut+at)===m){if(X.push(R.substring(C,Z).replace(G,b)),St(Z+1+ut+at),st=R.indexOf(f,C),Z=R.indexOf(b,C),W&&(Ot(),F))return dt();if(N&&tt.length>=N)return dt(!0);break}nt.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:tt.length,index:C}),Z++}}else if($&&X.length===0&&R.substring(C,C+xt)===$){if(B===-1)return dt();C=B+at,B=R.indexOf(m,C),st=R.indexOf(f,C)}else if(st!==-1&&(st<B||B===-1))X.push(R.substring(C,st)),C=st+V,st=R.indexOf(f,C);else{if(B===-1)break;if(X.push(R.substring(C,B)),St(B+at),W&&(Ot(),F))return dt();if(N&&tt.length>=N)return dt(!0)}return Tt();function z(_t){tt.push(_t),rt=C}function L(_t){var wt=0;return wt=_t!==-1&&(_t=R.substring(Z+1,_t))&&_t.trim()===""?_t.length:wt}function Tt(_t){return M||(_t===void 0&&(_t=R.substring(C)),X.push(_t),C=J,z(X),W&&Ot()),dt()}function St(_t){C=_t,z(X),X=[],B=R.indexOf(m,C)}function dt(_t){if(p.header&&!S&&tt.length&&!P){var wt=tt[0],It=Object.create(null),fe=new Set(wt);let Pe=!1;for(let Xt=0;Xt<wt.length;Xt++){let Mt=wt[Xt];if(It[Mt=v(p.transformHeader)?p.transformHeader(Mt,Xt):Mt]){let te,Ue=It[Mt];for(;te=Mt+"_"+Ue,Ue++,fe.has(te););fe.add(te),wt[Xt]=te,It[Mt]++,Pe=!0,(E=E===null?{}:E)[te]=Mt}else It[Mt]=1,wt[Xt]=Mt;fe.add(Mt)}Pe&&console.warn("Duplicate headers found and renamed."),P=!0}return{data:tt,errors:nt,meta:{delimiter:f,linebreak:m,aborted:F,truncated:!!_t,cursor:rt+(S||0),renamedHeaders:E}}}function Ot(){T(dt()),tt=[],nt=[]}},this.abort=function(){F=!0},this.getCharIndex=function(){return C}}function Y(p){var f=p.data,m=u[f.workerId],$=!1;if(f.error)m.userError(f.error,f.file);else if(f.results&&f.results.data){var T={abort:function(){$=!0,U(f.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:j,resume:j};if(v(m.userStep)){for(var N=0;N<f.results.data.length&&(m.userStep({data:f.results.data[N],errors:f.results.errors,meta:f.results.meta},T),!$);N++);delete f.results}else v(m.userChunk)&&(m.userChunk(f.results,T,f.file),delete f.results)}f.finished&&!$&&U(f.workerId,f.results)}function U(p,f){var m=u[p];v(m.userComplete)&&m.userComplete(f),m.terminate(),delete u[p]}function j(){throw new Error("Not implemented.")}function H(p){if(typeof p!="object"||p===null)return p;var f,m=Array.isArray(p)?[]:{};for(f in p)m[f]=H(p[f]);return m}function A(p,f){return function(){p.apply(f,arguments)}}function v(p){return typeof p=="function"}return a.parse=function(p,f){var m=(f=f||{}).dynamicTyping||!1;if(v(m)&&(f.dynamicTypingFunction=m,m={}),f.dynamicTyping=m,f.transform=!!v(f.transform)&&f.transform,!f.worker||!a.WORKERS_SUPPORTED)return m=null,a.NODE_STREAM_INPUT,typeof p=="string"?(p=($=>$.charCodeAt(0)!==65279?$:$.slice(1))(p),m=new(f.download?d:g)(f)):p.readable===!0&&v(p.read)&&v(p.on)?m=new w(f):(r.File&&p instanceof File||p instanceof Object)&&(m=new y(f)),m.stream(p);(m=(()=>{var $;return!!a.WORKERS_SUPPORTED&&($=(()=>{var T=r.URL||r.webkitURL||null,N=n.toString();return a.BLOB_URL||(a.BLOB_URL=T.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",N,")();"],{type:"text/javascript"})))})(),($=new r.Worker($)).onmessage=Y,$.id=l++,u[$.id]=$)})()).userStep=f.step,m.userChunk=f.chunk,m.userComplete=f.complete,m.userError=f.error,f.step=v(f.step),f.chunk=v(f.chunk),f.complete=v(f.complete),f.error=v(f.error),delete f.worker,m.postMessage({input:p,config:f,workerId:m.id})},a.unparse=function(p,f){var m=!1,$=!0,T=",",N=`\r
`,O='"',E=O+O,P=!1,b=null,D=!1,C=((()=>{if(typeof f=="object"){if(typeof f.delimiter!="string"||a.BAD_DELIMITERS.filter(function(S){return f.delimiter.indexOf(S)!==-1}).length||(T=f.delimiter),typeof f.quotes!="boolean"&&typeof f.quotes!="function"&&!Array.isArray(f.quotes)||(m=f.quotes),typeof f.skipEmptyLines!="boolean"&&typeof f.skipEmptyLines!="string"||(P=f.skipEmptyLines),typeof f.newline=="string"&&(N=f.newline),typeof f.quoteChar=="string"&&(O=f.quoteChar),typeof f.header=="boolean"&&($=f.header),Array.isArray(f.columns)){if(f.columns.length===0)throw new Error("Option columns is empty");b=f.columns}f.escapeChar!==void 0&&(E=f.escapeChar+O),f.escapeFormulae instanceof RegExp?D=f.escapeFormulae:typeof f.escapeFormulae=="boolean"&&f.escapeFormulae&&(D=/^[=+\-@\t\r].*$/)}})(),new RegExp(k(O),"g"));if(typeof p=="string"&&(p=JSON.parse(p)),Array.isArray(p)){if(!p.length||Array.isArray(p[0]))return F(null,p,P);if(typeof p[0]=="object")return F(b||Object.keys(p[0]),p,P)}else if(typeof p=="object")return typeof p.data=="string"&&(p.data=JSON.parse(p.data)),Array.isArray(p.data)&&(p.fields||(p.fields=p.meta&&p.meta.fields||b),p.fields||(p.fields=Array.isArray(p.data[0])?p.fields:typeof p.data[0]=="object"?Object.keys(p.data[0]):[]),Array.isArray(p.data[0])||typeof p.data[0]=="object"||(p.data=[p.data])),F(p.fields||[],p.data||[],P);throw new Error("Unable to serialize unrecognized input");function F(S,M,J){var V="",at=(typeof S=="string"&&(S=JSON.parse(S)),typeof M=="string"&&(M=JSON.parse(M)),Array.isArray(S)&&0<S.length),xt=!Array.isArray(M[0]);if(at&&$){for(var W=0;W<S.length;W++)0<W&&(V+=T),V+=R(S[W],W);0<M.length&&(V+=N)}for(var tt=0;tt<M.length;tt++){var nt=(at?S:M[tt]).length,X=!1,rt=at?Object.keys(M[tt]).length===0:M[tt].length===0;if(J&&!at&&(X=J==="greedy"?M[tt].join("").trim()==="":M[tt].length===1&&M[tt][0].length===0),J==="greedy"&&at){for(var ft=[],et=0;et<nt;et++){var st=xt?S[et]:et;ft.push(M[tt][st])}X=ft.join("").trim()===""}if(!X){for(var B=0;B<nt;B++){0<B&&!rt&&(V+=T);var G=at&&xt?S[B]:B;V+=R(M[tt][G],B)}tt<M.length-1&&(!J||0<nt&&!rt)&&(V+=N)}}return V}function R(S,M){var J,V;return S==null?"":S.constructor===Date?JSON.stringify(S).slice(1,25):(V=!1,D&&typeof S=="string"&&D.test(S)&&(S="'"+S,V=!0),J=S.toString().replace(C,E),(V=V||m===!0||typeof m=="function"&&m(S,M)||Array.isArray(m)&&m[M]||((at,xt)=>{for(var W=0;W<xt.length;W++)if(-1<at.indexOf(xt[W]))return!0;return!1})(J,a.BAD_DELIMITERS)||-1<J.indexOf(T)||J.charAt(0)===" "||J.charAt(J.length-1)===" ")?O+J+O:J)}},a.RECORD_SEP="",a.UNIT_SEP="",a.BYTE_ORDER_MARK="\uFEFF",a.BAD_DELIMITERS=["\r",`
`,'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!s&&!!r.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=I,a.ParserHandle=_,a.NetworkStreamer=d,a.FileStreamer=y,a.StringStreamer=g,a.ReadableStreamStreamer=w,r.jQuery&&((i=r.jQuery).fn.parse=function(p){var f=p.config||{},m=[];return this.each(function(N){if(!(i(this).prop("tagName").toUpperCase()==="INPUT"&&i(this).attr("type").toLowerCase()==="file"&&r.FileReader)||!this.files||this.files.length===0)return!0;for(var O=0;O<this.files.length;O++)m.push({file:this.files[O],inputElem:this,instanceConfig:i.extend({},f)})}),$(),this;function $(){if(m.length===0)v(p.complete)&&p.complete();else{var N,O,E,P,b=m[0];if(v(p.before)){var D=p.before(b.file,b.inputElem);if(typeof D=="object"){if(D.action==="abort")return N="AbortError",O=b.file,E=b.inputElem,P=D.reason,void(v(p.error)&&p.error({name:N},O,E,P));if(D.action==="skip")return void T();typeof D.config=="object"&&(b.instanceConfig=i.extend(b.instanceConfig,D.config))}else if(D==="skip")return void T()}var C=b.instanceConfig.complete;b.instanceConfig.complete=function(F){v(C)&&C(F,b.file,b.inputElem),T()},a.parse(b.file,b.instanceConfig)}}function T(){m.splice(0,1),$()}}),o&&(r.onmessage=function(p){p=p.data,a.WORKER_ID===void 0&&p&&(a.WORKER_ID=p.workerId),typeof p.input=="string"?r.postMessage({workerId:a.WORKER_ID,results:a.parse(p.input,p.config),finished:!0}):(r.File&&p.input instanceof File||p.input instanceof Object)&&(p=a.parse(p.input,p.config))&&r.postMessage({workerId:a.WORKER_ID,results:p,finished:!0})}),(d.prototype=Object.create(h.prototype)).constructor=d,(y.prototype=Object.create(h.prototype)).constructor=y,(g.prototype=Object.create(g.prototype)).constructor=g,(w.prototype=Object.create(h.prototype)).constructor=w,a})}(ue)),ue.exports}var jn=Yn();const De=Tn(jn);var pe,Fe;function Xn(){if(Fe)return pe;Fe=1;let t=/[-+]?([0-9]*\.[0-9]+|[0-9]+)([eE][-+]?[0-9]+)?/,e=new RegExp("^"+t.source+"(\\s"+t.source+"){1,}");const n=i=>{let s=i.split(";"),o=s.pop(),u=(s.shift()||"").split("=").pop(),l=0;function a(A){let v=o.substring(l).match(A);return v?(l+=v[0].length,v[0]):null}function h(A){return A&&u.match(/\d+/)&&(A.crs={type:"name",properties:{name:"urn:ogc:def:crs:EPSG::"+u}}),A}function d(){a(/^\s*/)}function y(){d();let A=0,v=[],p=[v],f=v,m;for(;m=a(/^(\()/)||a(/^(\))/)||a(/^(,)/)||a(e);){if(m==="(")p.push(f),f=[],p[p.length-1].push(f),A++;else if(m===")"){if(f.length===0||(f=p.pop(),!f))return null;if(A--,A===0)break}else if(m===",")f=[],p[p.length-1].push(f);else if(!m.split(/\s/g).some(isNaN))Array.prototype.push.apply(f,m.split(/\s/g).map(parseFloat));else return null;d()}return A!==0?null:v}function g(){let A=[],v,p;for(;p=a(e)||a(/^(,)/);)p===","?(A.push(v),v=[]):p.split(/\s/g).some(isNaN)||(v||(v=[]),Array.prototype.push.apply(v,p.split(/\s/g).map(parseFloat))),d();if(v)A.push(v);else return null;return A.length?A:null}function w(){if(!a(/^(point(\sz)?)/i)||(d(),!a(/^(\()/)))return null;let A=g();return!A||(d(),!a(/^(\))/))?null:{type:"Point",coordinates:A[0]}}function _(){if(!a(/^(multipoint(\sz)?)/i))return null;d(),o="MULTIPOINT ("+o.substring(o.indexOf("(")+1,o.length-1).replace(/\(/g,"").replace(/\)/g,"")+")";let v=y();return v?(d(),{type:"MultiPoint",coordinates:v}):null}function k(){if(!a(/^(multilinestring(\sz)?)/i))return null;d();let A=y();return A?(d(),{type:"MultiLineString",coordinates:A}):null}function I(){if(!a(/^(linestring(\sz)?)/i)||(d(),!a(/^(\()/)))return null;let A=g();return!A||!a(/^(\))/)?null:{type:"LineString",coordinates:A}}function Y(){if(!a(/^(polygon(\sz)?)/i))return null;d();let A=y();return A?{type:"Polygon",coordinates:A}:null}function U(){if(!a(/^(multipolygon(\sz)?)/i))return null;d();let A=y();return A?{type:"MultiPolygon",coordinates:A}:null}function j(){let A=[],v;if(!a(/^(geometrycollection)/i)||(d(),!a(/^(\()/)))return null;for(;v=H();)A.push(v),d(),a(/^(,)/),d();return a(/^(\))/)?{type:"GeometryCollection",geometries:A}:null}function H(){return w()||I()||Y()||_()||k()||U()||j()}return h(H())},r=i=>{i.type==="Feature"&&(i=i.geometry);function s(d){return d.join(" ")}function o(d){return d.map(s).join(", ")}function u(d){return d.map(o).map(a).join(", ")}function l(d){return d.map(u).map(a).join(", ")}function a(d){return"("+d+")"}let h=i;switch(h.type){case"Point":return h.coordinates&&h.coordinates.length===3?"POINT Z ("+s(h.coordinates)+")":"POINT ("+s(h.coordinates)+")";case"LineString":return h.coordinates&&h.coordinates[0]&&h.coordinates[0].length===3?"LINESTRING Z ("+o(h.coordinates)+")":"LINESTRING ("+o(h.coordinates)+")";case"Polygon":return h.coordinates&&h.coordinates[0]&&h.coordinates[0][0]&&h.coordinates[0][0].length===3?"POLYGON Z ("+u(h.coordinates)+")":"POLYGON ("+u(h.coordinates)+")";case"MultiPoint":return h.coordinates&&h.coordinates[0]&&h.coordinates[0].length===3?"MULTIPOINT Z ("+o(h.coordinates)+")":"MULTIPOINT ("+o(h.coordinates)+")";case"MultiLineString":return h.coordinates&&h.coordinates[0]&&h.coordinates[0][0]&&h.coordinates[0][0].length===3?"MULTILINESTRING Z ("+u(h.coordinates)+")":"MULTILINESTRING ("+u(h.coordinates)+")";case"MultiPolygon":return h.coordinates&&h.coordinates[0]&&h.coordinates[0][0]&&h.coordinates[0][0]&&h.coordinates[0][0][0].length===3?"MULTIPOLYGON Z ("+l(h.coordinates)+")":"MULTIPOLYGON ("+l(h.coordinates)+")";case"GeometryCollection":return"GEOMETRYCOLLECTION ("+h.geometries.map(r).join(", ")+")";default:throw new Error("stringify requires a valid GeoJSON Feature or geometry object as input")}};return pe={parse:n,stringify:r},pe}var zn=Xn(),Gn=Object.defineProperty,qn=(t,e,n)=>e in t?Gn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,pt=(t,e,n)=>qn(t,typeof e!="symbol"?e+"":e,n);function jt(){}function we(t,e){for(const n in e)t[n]=e[n];return t}function On(t){return t()}function Ye(){return Object.create(null)}function Nt(t){t.forEach(On)}function gt(t){return typeof t=="function"}function Qt(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Bn(t){return Object.keys(t).length===0}function Zn(t,e,n,r){if(t){const i=En(t,e,n,r);return t[0](i)}}function En(t,e,n,r){return t[1]&&r?we(n.ctx.slice(),t[1](r(e))):n.ctx}function Wn(t,e,n,r){if(t[2]&&r){const i=t[2](r(n));if(e.dirty===void 0)return i;if(typeof i=="object"){const s=[],o=Math.max(e.dirty.length,i.length);for(let u=0;u<o;u+=1)s[u]=e.dirty[u]|i[u];return s}return e.dirty|i}return e.dirty}function Kn(t,e,n,r,i,s){if(i){const o=En(e,n,r,s);t.p(o,i)}}function Qn(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let r=0;r<n;r++)e[r]=-1;return e}return-1}function je(t){const e={};for(const n in t)n[0]!=="$"&&(e[n]=t[n]);return e}function oe(t){return t??""}function ct(t,e){t.appendChild(e)}function Q(t,e,n){t.insertBefore(e,n||null)}function K(t){t.parentNode&&t.parentNode.removeChild(t)}function ce(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function q(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function wn(t){return document.createTextNode(t)}function Et(){return wn(" ")}function se(){return wn("")}function ot(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function c(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function Vn(t){return Array.from(t.childNodes)}function Xe(t,e,n){t.classList.toggle(e,!!n)}function Jn(t,e,{bubbles:n=!1,cancelable:r=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:r})}let ne;function ee(t){ne=t}function $n(){if(!ne)throw new Error("Function called outside component initialization");return ne}function bn(t){$n().$$.on_mount.push(t)}function Me(){const t=$n();return(e,n,{cancelable:r=!1}={})=>{const i=t.$$.callbacks[e];if(i){const s=Jn(e,n,{cancelable:r});return i.slice().forEach(o=>{o.call(t,s)}),!s.defaultPrevented}return!0}}function vt(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(r=>r.call(this,e))}const qt=[],ze=[];let Zt=[];const Ge=[],Nn=Promise.resolve();let $e=!1;function Rn(){$e||($e=!0,Nn.then(Cn))}function An(){return Rn(),Nn}function be(t){Zt.push(t)}const de=new Set;let zt=0;function Cn(){if(zt!==0)return;const t=ne;do{try{for(;zt<qt.length;){const e=qt[zt];zt++,ee(e),tr(e.$$)}}catch(e){throw qt.length=0,zt=0,e}for(ee(null),qt.length=0,zt=0;ze.length;)ze.pop()();for(let e=0;e<Zt.length;e+=1){const n=Zt[e];de.has(n)||(de.add(n),n())}Zt.length=0}while(qt.length);for(;Ge.length;)Ge.pop()();$e=!1,de.clear(),ee(t)}function tr(t){if(t.fragment!==null){t.update(),Nt(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(be)}}function er(t){const e=[],n=[];Zt.forEach(r=>t.indexOf(r)===-1?e.push(r):n.push(r)),n.forEach(r=>r()),Zt=e}const le=new Set;let Yt;function Wt(){Yt={r:0,c:[],p:Yt}}function Kt(){Yt.r||Nt(Yt.c),Yt=Yt.p}function it(t,e){t&&t.i&&(le.delete(t),t.i(e))}function ht(t,e,n,r){if(t&&t.o){if(le.has(t))return;le.add(t),Yt.c.push(()=>{le.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}function Ht(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function Rt(t){t&&t.c()}function $t(t,e,n){const{fragment:r,after_update:i}=t.$$;r&&r.m(e,n),be(()=>{const s=t.$$.on_mount.map(On).filter(gt);t.$$.on_destroy?t.$$.on_destroy.push(...s):Nt(s),t.$$.on_mount=[]}),i.forEach(be)}function bt(t,e){const n=t.$$;n.fragment!==null&&(er(n.after_update),Nt(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function nr(t,e){t.$$.dirty[0]===-1&&(qt.push(t),Rn(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Vt(t,e,n,r,i,s,o=null,u=[-1]){const l=ne;ee(t);const a=t.$$={fragment:null,ctx:[],props:s,update:jt,not_equal:i,bound:Ye(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:Ye(),dirty:u,skip_bound:!1,root:e.target||l.$$.root};o&&o(a.root);let h=!1;if(a.ctx=n?n(t,e.props||{},(d,y,...g)=>{const w=g.length?g[0]:y;return a.ctx&&i(a.ctx[d],a.ctx[d]=w)&&(!a.skip_bound&&a.bound[d]&&a.bound[d](w),h&&nr(t,d)),y}):[],a.update(),h=!0,Nt(a.before_update),a.fragment=r?r(a.ctx):!1,e.target){if(e.hydrate){const d=Vn(e.target);a.fragment&&a.fragment.l(d),d.forEach(K)}else a.fragment&&a.fragment.c();e.intro&&it(t.$$.fragment),$t(t,e.target,e.anchor),Cn()}ee(l)}class Jt{constructor(){pt(this,"$$"),pt(this,"$$set")}$destroy(){bt(this,1),this.$destroy=jt}$on(e,n){if(!gt(n))return jt;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(e){this.$$set&&!Bn(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const rr="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(rr);var kt=(t=>(t.ELLIPSE="ELLIPSE",t.MULTIPOLYGLON="MULTIPOLYGON",t.POLYGON="POLYGON",t.RECTANGLE="RECTANGLE",t))(kt||{}),ir={exports:{}};(function(t){(function(){function e(u,l){var a=u.x-l.x,h=u.y-l.y;return a*a+h*h}function n(u,l,a){var h=l.x,d=l.y,y=a.x-h,g=a.y-d;if(y!==0||g!==0){var w=((u.x-h)*y+(u.y-d)*g)/(y*y+g*g);w>1?(h=a.x,d=a.y):w>0&&(h+=y*w,d+=g*w)}return y=u.x-h,g=u.y-d,y*y+g*g}function r(u,l){for(var a=u[0],h=[a],d,y=1,g=u.length;y<g;y++)d=u[y],e(d,a)>l&&(h.push(d),a=d);return a!==d&&h.push(d),h}function i(u,l,a,h,d){for(var y=h,g,w=l+1;w<a;w++){var _=n(u[w],u[l],u[a]);_>y&&(g=w,y=_)}y>h&&(g-l>1&&i(u,l,g,h,d),d.push(u[g]),a-g>1&&i(u,g,a,h,d))}function s(u,l){var a=u.length-1,h=[u[0]];return i(u,0,a,l,h),h.push(u[a]),h}function o(u,l,a){if(u.length<=2)return u;var h=l!==void 0?l*l:1;return u=a?u:r(u,h),u=s(u,h),u}t.exports=o,t.exports.default=o})()})(ir);const he=(t,e)=>e,Lt=t=>{let e=1/0,n=1/0,r=-1/0,i=-1/0;return t.forEach(([s,o])=>{e=Math.min(e,s),n=Math.min(n,o),r=Math.max(r,s),i=Math.max(i,o)}),{minX:e,minY:n,maxX:r,maxY:i}},Ne=t=>{let e=0,n=t.length-1;for(let r=0;r<t.length;r++)e+=(t[n][0]+t[r][0])*(t[n][1]-t[r][1]),n=r;return Math.abs(.5*e)},Re=(t,e,n)=>{let r=!1;for(let i=0,s=t.length-1;i<t.length;s=i++){const o=t[i][0],u=t[i][1],l=t[s][0],a=t[s][1];u>n!=a>n&&e<(l-o)*(n-u)/(a-u)+o&&(r=!r)}return r},sr=(t,e=!0)=>{let n="M ";return t.forEach(([r,i],s)=>{s===0?n+=`${r},${i}`:n+=` L ${r},${i}`}),e&&(n+=" Z"),n},or={area:t=>Math.PI*t.geometry.rx*t.geometry.ry,intersects:(t,e,n)=>{const{cx:r,cy:i,rx:s,ry:o}=t.geometry,u=0,l=Math.cos(u),a=Math.sin(u),h=e-r,d=n-i,y=l*h+a*d,g=a*h-l*d;return y*y/(s*s)+g*g/(o*o)<=1}};he(kt.ELLIPSE,or);const ar={area:t=>{const{polygons:e}=t.geometry;return e.reduce((n,r)=>{const[i,...s]=r.rings,o=Ne(i.points),u=s.reduce((l,a)=>l+Ne(a.points),0);return n+o-u},0)},intersects:(t,e,n)=>{const{polygons:r}=t.geometry;for(const i of r){const[s,...o]=i.rings;if(Re(s.points,e,n)){let u=!1;for(const l of o)if(Re(l.points,e,n)){u=!0;break}if(!u)return!0}}return!1}},ye=t=>{const e=t.reduce((n,r)=>[...n,...r.rings[0].points],[]);return Lt(e)},Gt=t=>t.rings.map(e=>sr(e.points)).join(" "),ur=t=>t.polygons.reduce((e,n)=>[...e,...n.rings.reduce((r,i)=>[...r,...i.points],[])],[]);he(kt.MULTIPOLYGLON,ar);const lr={area:t=>{const e=t.geometry.points;return Ne(e)},intersects:(t,e,n)=>{const r=t.geometry.points;return Re(r,e,n)}};he(kt.POLYGON,lr);const cr={area:t=>t.geometry.w*t.geometry.h,intersects:(t,e,n)=>e>=t.geometry.x&&e<=t.geometry.x+t.geometry.w&&n>=t.geometry.y&&n<=t.geometry.y+t.geometry.h};he(kt.RECTANGLE,cr);const yt=" ";function hr(t){let e="";Array.isArray(t)||(t=[t]);for(let n=0;n<t.length;n++){const r=t[n];if(r.type===x.CLOSE_PATH)e+="z";else if(r.type===x.HORIZ_LINE_TO)e+=(r.relative?"h":"H")+r.x;else if(r.type===x.VERT_LINE_TO)e+=(r.relative?"v":"V")+r.y;else if(r.type===x.MOVE_TO)e+=(r.relative?"m":"M")+r.x+yt+r.y;else if(r.type===x.LINE_TO)e+=(r.relative?"l":"L")+r.x+yt+r.y;else if(r.type===x.CURVE_TO)e+=(r.relative?"c":"C")+r.x1+yt+r.y1+yt+r.x2+yt+r.y2+yt+r.x+yt+r.y;else if(r.type===x.SMOOTH_CURVE_TO)e+=(r.relative?"s":"S")+r.x2+yt+r.y2+yt+r.x+yt+r.y;else if(r.type===x.QUAD_TO)e+=(r.relative?"q":"Q")+r.x1+yt+r.y1+yt+r.x+yt+r.y;else if(r.type===x.SMOOTH_QUAD_TO)e+=(r.relative?"t":"T")+r.x+yt+r.y;else if(r.type===x.ARC)e+=(r.relative?"a":"A")+r.rX+yt+r.rY+yt+r.xRot+yt+ +r.lArcFlag+yt+ +r.sweepFlag+yt+r.x+yt+r.y;else throw new Error(`Unexpected command type "${r==null?void 0:r.type}" at index ${n}.`)}return e}function Ae([t,e],n){return[t*Math.cos(n)-e*Math.sin(n),t*Math.sin(n)+e*Math.cos(n)]}function At(...t){for(let e=0;e<t.length;e++)if(typeof t[e]!="number")throw new Error(`assertNumbers arguments[${e}] is not a number. ${typeof t[e]} == typeof ${t[e]}`);return!0}const Pt=Math.PI;function Ie(t,e,n){t.lArcFlag=t.lArcFlag===0?0:1,t.sweepFlag=t.sweepFlag===0?0:1;let{rX:r,rY:i}=t;const{x:s,y:o}=t;if(Math.abs(r)<1e-10||Math.abs(i)<1e-10){t.rX=0,t.rY=0,t.cX=(e+s)/2,t.cY=(n+o)/2,t.phi1=0,t.phi2=0;return}r=Math.abs(t.rX),i=Math.abs(t.rY);const u=t.xRot/180*Pt,[l,a]=Ae([(e-s)/2,(n-o)/2],-u),h=Math.pow(l,2)/Math.pow(r,2)+Math.pow(a,2)/Math.pow(i,2);1<h&&(r*=Math.sqrt(h),i*=Math.sqrt(h)),t.rX=r,t.rY=i;const d=Math.pow(r,2)*Math.pow(a,2)+Math.pow(i,2)*Math.pow(l,2),y=(t.lArcFlag!==t.sweepFlag?1:-1)*Math.sqrt(Math.max(0,(Math.pow(r,2)*Math.pow(i,2)-d)/d)),g=r*a/i*y,w=-i*l/r*y,_=Ae([g,w],u);t.cX=_[0]+(e+s)/2,t.cY=_[1]+(n+o)/2,t.phi1=Math.atan2((a-w)/i,(l-g)/r),t.phi2=Math.atan2((-a-w)/i,(-l-g)/r),t.sweepFlag===0&&t.phi2>t.phi1&&(t.phi2-=2*Pt),t.sweepFlag===1&&t.phi2<t.phi1&&(t.phi2+=2*Pt),t.phi1*=180/Pt,t.phi2*=180/Pt}function qe(t,e,n){At(t,e,n);const r=t*t+e*e-n*n;if(0>r)return[];if(r===0)return[[t*n/(t*t+e*e),e*n/(t*t+e*e)]];const i=Math.sqrt(r);return[[(t*n+e*i)/(t*t+e*e),(e*n-t*i)/(t*t+e*e)],[(t*n-e*i)/(t*t+e*e),(e*n+t*i)/(t*t+e*e)]]}const Ft=Math.PI/180;function Be(t,e,n){return(1-n)*t+n*e}function Ze(t,e,n,r){return t+Math.cos(r/180*Pt)*e+Math.sin(r/180*Pt)*n}function We(t,e,n,r){const i=e-t,s=n-e,o=r-n,u=3*i+3*o-6*s,l=(s-i)*6,a=3*i;return Math.abs(u)<1e-6?Math.abs(l)<1e-6?[]:[-a/l]:fr(l/u,a/u,1e-6)}function Ke(t,e,n,r,i){const s=1-i,o=s*s*s,u=3*s*s*i,l=3*s*i*i,a=i*i*i;return t*o+e*u+n*l+r*a}function fr(t,e,n=1e-6){const r=t*t/4-e;if(r<-n)return[];if(r<=n)return[-t/2];const i=Math.sqrt(r);return[-(t/2)-i,-(t/2)+i]}function pr(t,e,n){t.cX||Ie(t,e,n);const r=t.xRot/180*Pt;if(Math.abs(t.rX)<1e-10||Math.abs(t.rY)<1e-10)return[{relative:t.relative,type:x.CURVE_TO,x1:e+(t.x-e)/3,y1:n+(t.y-n)/3,x2:e+2*(t.x-e)/3,y2:n+2*(t.y-n)/3,x:t.x,y:t.y}];const i=Math.min(t.phi1,t.phi2),s=Math.max(t.phi1,t.phi2),o=s-i,u=Math.ceil(o/90),l=new Array(u);let a=e,h=n;const d=(y,g)=>{const[w,_]=Ae([y*t.rX,g*t.rY],r);return[t.cX+w,t.cY+_]};for(let y=0;y<u;y++){const g=Be(t.phi1,t.phi2,y/u),w=Be(t.phi1,t.phi2,(y+1)/u),_=w-g,k=4/3*Math.tan(_*Ft/4),I=Math.cos(g*Ft)-k*Math.sin(g*Ft),Y=Math.sin(g*Ft)+k*Math.cos(g*Ft),U=Math.cos(w*Ft),j=Math.sin(w*Ft),H=U+k*j,A=j-k*U,v=d(I,Y),p=d(H,A),f=d(U,j),m={relative:t.relative,type:x.CURVE_TO,x:f[0],y:f[1],x1:v[0],y1:v[1],x2:p[0],y2:p[1]};t.relative&&(m.x1-=a,m.y1-=h,m.x2-=a,m.y2-=h,m.x-=a,m.y-=h),a=f[0],h=f[1],l[y]=m}return l}function me(t,e,n){const r=e[0]-t[0],i=e[1]-t[1],s=n[0]-t[0],o=n[1]-t[1],u=r*o-i*s;if(!(Math.abs(u)<1e-10))return!1;const l=r*s+i*o,a=r*r+i*i,h=s*s+o*o;return 0<=l&&l<=h&&a<=h}function dr(t,e=!0){if(t.length<2)return t;const n=mt.INFO((s,o,u)=>({...s,x:s.x??o,y:s.y??u,relative:s.relative??!1})),r=[];let i=[];for(const s of t){const o=n(s);o.type===x.MOVE_TO&&i.length>0&&(e?r.push(...ae(i)):r.unshift(...ae(i)),i=[]),i.push(o)}return i.length>0&&(e?r.push(...ae(i)):r.unshift(...ae(i))),r}function ae(t){var e;const n=((e=t[t.length-1])==null?void 0:e.type)===x.CLOSE_PATH,r=n?t.length-2:t.length-1,i=[{type:x.MOVE_TO,relative:!1,x:t[r].x,y:t[r].y}];for(let s=r;s>0;s--){const o=t[s],u=t[s-1];if(o.relative)throw new Error("Relative command are not supported convert first with `toAbs()`");switch(o.type){case x.HORIZ_LINE_TO:i.push({type:x.HORIZ_LINE_TO,relative:!1,x:u.x});break;case x.VERT_LINE_TO:i.push({type:x.VERT_LINE_TO,relative:!1,y:u.y});break;case x.LINE_TO:case x.MOVE_TO:i.push({type:x.LINE_TO,relative:!1,x:u.x,y:u.y});break;case x.CURVE_TO:i.push({type:x.CURVE_TO,relative:!1,x:u.x,y:u.y,x1:o.x2,y1:o.y2,x2:o.x1,y2:o.y1});break;case x.SMOOTH_CURVE_TO:throw new Error("Unsupported command: S (smooth cubic bezier)");case x.SMOOTH_QUAD_TO:throw new Error("Unsupported command: T (smooth quadratic bezier)");case x.ARC:throw new Error("Unsupported command: A (arc)");case x.QUAD_TO:throw new Error("Unsupported command: Q (quadratic bezier)")}}return n&&i.push({type:x.CLOSE_PATH}),i}function yr(t=1e13){At(t);function e(n){return Math.round(n*t)/t}return function(n){return"x1"in n&&typeof n.x1<"u"&&(n.x1=e(n.x1)),"y1"in n&&typeof n.y1<"u"&&(n.y1=e(n.y1)),"x2"in n&&typeof n.x2<"u"&&(n.x2=e(n.x2)),"y2"in n&&typeof n.y2<"u"&&(n.y2=e(n.y2)),"x"in n&&typeof n.x<"u"&&(n.x=e(n.x)),"y"in n&&typeof n.y<"u"&&(n.y=e(n.y)),"rX"in n&&typeof n.rX<"u"&&(n.rX=e(n.rX)),"rY"in n&&typeof n.rY<"u"&&(n.rY=e(n.rY)),n}}function Sn(){return Ct((t,e,n)=>(t.relative&&(typeof t.x1<"u"&&(t.x1+=e),typeof t.y1<"u"&&(t.y1+=n),typeof t.x2<"u"&&(t.x2+=e),typeof t.y2<"u"&&(t.y2+=n),typeof t.x<"u"&&(t.x+=e),typeof t.y<"u"&&(t.y+=n),t.relative=!1),t))}function mr(){return Ct((t,e,n)=>(t.relative||(typeof t.x1<"u"&&(t.x1-=e),typeof t.y1<"u"&&(t.y1-=n),typeof t.x2<"u"&&(t.x2-=e),typeof t.y2<"u"&&(t.y2-=n),typeof t.x<"u"&&(t.x-=e),typeof t.y<"u"&&(t.y-=n),t.relative=!0),t))}function gr(t=!0,e=!0,n=!0,r=!0){return Ct((i,s,o,u,l)=>{if(isNaN(u)&&!(i.type&x.MOVE_TO))throw new Error("path must start with moveto");if(e&&i.type&x.HORIZ_LINE_TO&&(i.type=x.LINE_TO,i.y=i.relative?0:o),n&&i.type&x.VERT_LINE_TO&&(i.type=x.LINE_TO,i.x=i.relative?0:s),t&&i.type&x.CLOSE_PATH&&(i.type=x.LINE_TO,i.x=i.relative?u-s:u,i.y=i.relative?l-o:l),i.type&x.ARC&&(i.rX===0||i.rY===0)&&(i.type=x.LINE_TO,delete i.rX,delete i.rY,delete i.xRot,delete i.lArcFlag,delete i.sweepFlag),r&&i.type&x.QUAD_TO){const a=[s,o],h=i.relative?[s+i.x1,o+i.y1]:[i.x1,i.y1],d=i.relative?[s+i.x,o+i.y]:[i.x,i.y];me(a,h,d)&&(i.type=x.LINE_TO,delete i.x1,delete i.y1)}if(r&&i.type&x.CURVE_TO){const a=[s,o],h=i.relative?[s+i.x1,o+i.y1]:[i.x1,i.y1],d=i.relative?[s+i.x2,o+i.y2]:[i.x2,i.y2],y=i.relative?[s+i.x,o+i.y]:[i.x,i.y];me(a,h,y)&&me(a,d,y)&&(i.type=x.LINE_TO,delete i.x1,delete i.y1,delete i.x2,delete i.y2)}return i})}function Mn(){let t=NaN,e=NaN,n=NaN,r=NaN;return Ct((i,s,o)=>(i.type&x.SMOOTH_CURVE_TO&&(i.type=x.CURVE_TO,t=isNaN(t)?s:t,e=isNaN(e)?o:e,i.x1=i.relative?s-t:2*s-t,i.y1=i.relative?o-e:2*o-e),i.type&x.CURVE_TO?(t=i.relative?s+i.x2:i.x2,e=i.relative?o+i.y2:i.y2):(t=NaN,e=NaN),i.type&x.SMOOTH_QUAD_TO&&(i.type=x.QUAD_TO,n=isNaN(n)?s:n,r=isNaN(r)?o:r,i.x1=i.relative?s-n:2*s-n,i.y1=i.relative?o-r:2*o-r),i.type&x.QUAD_TO?(n=i.relative?s+i.x1:i.x1,r=i.relative?o+i.y1:i.y1):(n=NaN,r=NaN),i))}function In(){let t=NaN,e=NaN;return Ct((n,r,i)=>{if(n.type&x.SMOOTH_QUAD_TO&&(n.type=x.QUAD_TO,t=isNaN(t)?r:t,e=isNaN(e)?i:e,n.x1=n.relative?r-t:2*r-t,n.y1=n.relative?i-e:2*i-e),n.type&x.QUAD_TO){t=n.relative?r+n.x1:n.x1,e=n.relative?i+n.y1:n.y1;const s=n.x1,o=n.y1;n.type=x.CURVE_TO,n.x1=((n.relative?0:r)+s*2)/3,n.y1=((n.relative?0:i)+o*2)/3,n.x2=(n.x+s*2)/3,n.y2=(n.y+o*2)/3}else t=NaN,e=NaN;return n})}function Ct(t){let e=0,n=0,r=NaN,i=NaN;return function(s){if(isNaN(r)&&!(s.type&x.MOVE_TO))throw new Error("path must start with moveto");const o=t(s,e,n,r,i);return s.type&x.CLOSE_PATH&&(e=r,n=i),"x"in s&&typeof s.x<"u"&&(e=s.relative?e+s.x:s.x),"y"in s&&typeof s.y<"u"&&(n=s.relative?n+s.y:s.y),s.type&x.MOVE_TO&&(r=e,i=n),o}}function xr(t=0){At(t);let e=NaN,n=NaN,r=NaN,i=NaN;return Ct((s,o,u,l,a)=>{const h=Math.abs;let d=!1,y=0,g=0;if(s.type&x.SMOOTH_CURVE_TO&&(y=isNaN(e)?0:o-e,g=isNaN(n)?0:u-n),s.type&(x.CURVE_TO|x.SMOOTH_CURVE_TO)?(e=s.relative?o+s.x2:s.x2,n=s.relative?u+s.y2:s.y2):(e=NaN,n=NaN),s.type&x.SMOOTH_QUAD_TO?(r=isNaN(r)?o:2*o-r,i=isNaN(i)?u:2*u-i):s.type&x.QUAD_TO?(r=s.relative?o+s.x1:s.x1,i=s.relative?u+s.y1:s.y2):(r=NaN,i=NaN),s.type&x.LINE_COMMANDS||s.type&x.ARC&&(s.rX===0||s.rY===0||!s.lArcFlag)||s.type&x.CURVE_TO||s.type&x.SMOOTH_CURVE_TO||s.type&x.QUAD_TO||s.type&x.SMOOTH_QUAD_TO){const w=typeof s.x>"u"?0:s.relative?s.x:s.x-o,_=typeof s.y>"u"?0:s.relative?s.y:s.y-u;y=isNaN(r)?typeof s.x1>"u"?y:s.relative?s.x:s.x1-o:r-o,g=isNaN(i)?typeof s.y1>"u"?g:s.relative?s.y:s.y1-u:i-u;const k=typeof s.x2>"u"?0:s.relative?s.x:s.x2-o,I=typeof s.y2>"u"?0:s.relative?s.y:s.y2-u;h(w)<=t&&h(_)<=t&&h(y)<=t&&h(g)<=t&&h(k)<=t&&h(I)<=t&&(d=!0)}return s.type&x.CLOSE_PATH&&h(o-l)<=t&&h(u-a)<=t&&(d=!0),d?[]:s})}function Dt(t,e,n,r,i,s){return At(t,e,n,r,i,s),Ct((o,u,l,a)=>{const h=o.x1,d=o.x2,y=o.relative&&!isNaN(a),g=typeof o.x<"u"?o.x:y?0:u,w=typeof o.y<"u"?o.y:y?0:l;o.type&x.HORIZ_LINE_TO&&e!==0&&(o.type=x.LINE_TO,o.y=o.relative?0:l),o.type&x.VERT_LINE_TO&&n!==0&&(o.type=x.LINE_TO,o.x=o.relative?0:u),typeof o.x<"u"&&(o.x=o.x*t+w*n+(y?0:i)),typeof o.y<"u"&&(o.y=g*e+o.y*r+(y?0:s)),typeof o.x1<"u"&&(o.x1=o.x1*t+o.y1*n+(y?0:i)),typeof o.y1<"u"&&(o.y1=h*e+o.y1*r+(y?0:s)),typeof o.x2<"u"&&(o.x2=o.x2*t+o.y2*n+(y?0:i)),typeof o.y2<"u"&&(o.y2=d*e+o.y2*r+(y?0:s));function _(I){return I*I}const k=t*r-e*n;if(typeof o.xRot<"u"&&(t!==1||e!==0||n!==0||r!==1))if(k===0)delete o.rX,delete o.rY,delete o.xRot,delete o.lArcFlag,delete o.sweepFlag,o.type=x.LINE_TO;else{const I=o.xRot*Math.PI/180,Y=Math.sin(I),U=Math.cos(I),j=1/_(o.rX),H=1/_(o.rY),A=_(U)*j+_(Y)*H,v=2*Y*U*(j-H),p=_(Y)*j+_(U)*H,f=A*r*r-v*e*r+p*e*e,m=v*(t*r+e*n)-2*(A*n*r+p*t*e),$=A*n*n-v*t*n+p*t*t,T=(Math.atan2(m,f-$)+Math.PI)%Math.PI/2,N=Math.sin(T),O=Math.cos(T);o.rX=Math.abs(k)/Math.sqrt(f*_(O)+m*N*O+$*_(N)),o.rY=Math.abs(k)/Math.sqrt(f*_(N)-m*N*O+$*_(O)),o.xRot=T*180/Math.PI}return typeof o.sweepFlag<"u"&&0>k&&(o.sweepFlag=+!o.sweepFlag),o})}function _r(t,e=0,n=0){At(t,e,n);const r=Math.sin(t),i=Math.cos(t);return Dt(i,r,-r,i,e-e*i+n*r,n-e*r-n*i)}function vr(t,e=0){return At(t,e),Dt(1,0,0,1,t,e)}function Tr(t,e=t){return At(t,e),Dt(t,0,0,e,0,0)}function Or(t){return At(t),Dt(1,0,Math.tan(t),1,0,0)}function Er(t){return At(t),Dt(1,Math.tan(t),0,1,0,0)}function wr(t=0){return At(t),Dt(-1,0,0,1,t,0)}function $r(t=0){return At(t),Dt(1,0,0,-1,0,t)}function br(){return Ct((t,e,n)=>x.ARC===t.type?pr(t,t.relative?0:e,t.relative?0:n):t)}function Nr(){return Ct((t,e,n)=>(t.relative&&(e=0,n=0),x.ARC===t.type&&Ie(t,e,n),t))}function Ln(){return t=>({...t})}function Rr(){const t=Ln(),e=Sn(),n=In(),r=Mn(),i=Ct((s,o,u)=>{const l=r(n(e(t(s))));function a(d){d>i.maxX&&(i.maxX=d),d<i.minX&&(i.minX=d)}function h(d){d>i.maxY&&(i.maxY=d),d<i.minY&&(i.minY=d)}if(l.type&x.DRAWING_COMMANDS&&(a(o),h(u)),l.type&x.HORIZ_LINE_TO&&a(l.x),l.type&x.VERT_LINE_TO&&h(l.y),l.type&x.LINE_TO&&(a(l.x),h(l.y)),l.type&x.CURVE_TO){a(l.x),h(l.y);const d=We(o,l.x1,l.x2,l.x);for(const g of d)0<g&&1>g&&a(Ke(o,l.x1,l.x2,l.x,g));const y=We(u,l.y1,l.y2,l.y);for(const g of y)0<g&&1>g&&h(Ke(u,l.y1,l.y2,l.y,g))}if(l.type&x.ARC){a(l.x),h(l.y),Ie(l,o,u);const d=l.xRot/180*Math.PI,y=Math.cos(d)*l.rX,g=Math.sin(d)*l.rX,w=-Math.sin(d)*l.rY,_=Math.cos(d)*l.rY,[k,I]=l.phi1<l.phi2?[l.phi1,l.phi2]:-180>l.phi2?[l.phi2+360,l.phi1+360]:[l.phi2,l.phi1],Y=([H,A])=>{const v=Math.atan2(A,H)*180/Math.PI;return v<k?v+360:v},U=qe(w,-y,0).map(Y);for(const H of U)H>k&&H<I&&a(Ze(l.cX,y,w,H));const j=qe(_,-g,0).map(Y);for(const H of j)H>k&&H<I&&h(Ze(l.cY,g,_,H))}return s});return i.minX=1/0,i.maxX=-1/0,i.minY=1/0,i.maxY=-1/0,i}const mt={ROUND:yr,TO_ABS:Sn,TO_REL:mr,NORMALIZE_HVZ:gr,NORMALIZE_ST:Mn,QT_TO_C:In,INFO:Ct,SANITIZE:xr,MATRIX:Dt,ROTATE:_r,TRANSLATE:vr,SCALE:Tr,SKEW_X:Or,SKEW_Y:Er,X_AXIS_SYMMETRY:wr,Y_AXIS_SYMMETRY:$r,A_TO_C:br,ANNOTATE_ARCS:Nr,CLONE:Ln,CALCULATE_BOUNDS:Rr,REVERSE_PATH:dr};class kn{round(e){return this.transform(mt.ROUND(e))}toAbs(){return this.transform(mt.TO_ABS())}toRel(){return this.transform(mt.TO_REL())}normalizeHVZ(e,n,r){return this.transform(mt.NORMALIZE_HVZ(e,n,r))}normalizeST(){return this.transform(mt.NORMALIZE_ST())}qtToC(){return this.transform(mt.QT_TO_C())}aToC(){return this.transform(mt.A_TO_C())}sanitize(e){return this.transform(mt.SANITIZE(e))}translate(e,n){return this.transform(mt.TRANSLATE(e,n))}scale(e,n){return this.transform(mt.SCALE(e,n))}rotate(e,n,r){return this.transform(mt.ROTATE(e,n,r))}matrix(e,n,r,i,s,o){return this.transform(mt.MATRIX(e,n,r,i,s,o))}skewX(e){return this.transform(mt.SKEW_X(e))}skewY(e){return this.transform(mt.SKEW_Y(e))}xSymmetry(e){return this.transform(mt.X_AXIS_SYMMETRY(e))}ySymmetry(e){return this.transform(mt.Y_AXIS_SYMMETRY(e))}annotateArcs(){return this.transform(mt.ANNOTATE_ARCS())}}const Ar=t=>t===" "||t==="	"||t==="\r"||t===`
`,Qe=t=>48<=t.charCodeAt(0)&&t.charCodeAt(0)<=57;class Cr extends kn{constructor(){super(),pt(this,"curNumber",""),pt(this,"curCommandType",-1),pt(this,"curCommandRelative",!1),pt(this,"canParseCommandOrComma",!0),pt(this,"curNumberHasExp",!1),pt(this,"curNumberHasExpDigits",!1),pt(this,"curNumberHasDecimal",!1),pt(this,"curArgs",[])}finish(e=[]){if(this.parse(" ",e),this.curArgs.length!==0||!this.canParseCommandOrComma)throw new SyntaxError("Unterminated command at the path end.");return e}parse(e,n=[]){const r=i=>{n.push(i),this.curArgs.length=0,this.canParseCommandOrComma=!0};for(let i=0;i<e.length;i++){const s=e[i],o=this.curCommandType===x.ARC&&(this.curArgs.length===3||this.curArgs.length===4)&&this.curNumber.length===1&&(this.curNumber==="0"||this.curNumber==="1"),u=Qe(s)&&(this.curNumber==="0"&&s==="0"||o);if(Qe(s)&&!u){this.curNumber+=s,this.curNumberHasExpDigits=this.curNumberHasExp;continue}if(s==="e"||s==="E"){this.curNumber+=s,this.curNumberHasExp=!0;continue}if((s==="-"||s==="+")&&this.curNumberHasExp&&!this.curNumberHasExpDigits){this.curNumber+=s;continue}if(s==="."&&!this.curNumberHasExp&&!this.curNumberHasDecimal&&!o){this.curNumber+=s,this.curNumberHasDecimal=!0;continue}if(this.curNumber&&this.curCommandType!==-1){const l=Number(this.curNumber);if(isNaN(l))throw new SyntaxError(`Invalid number ending at ${i}`);if(this.curCommandType===x.ARC){if(this.curArgs.length===0||this.curArgs.length===1){if(0>l)throw new SyntaxError(`Expected positive number, got "${l}" at index "${i}"`)}else if((this.curArgs.length===3||this.curArgs.length===4)&&this.curNumber!=="0"&&this.curNumber!=="1")throw new SyntaxError(`Expected a flag, got "${this.curNumber}" at index "${i}"`)}this.curArgs.push(l),this.curArgs.length===Sr[this.curCommandType]&&(x.HORIZ_LINE_TO===this.curCommandType?r({type:x.HORIZ_LINE_TO,relative:this.curCommandRelative,x:l}):x.VERT_LINE_TO===this.curCommandType?r({type:x.VERT_LINE_TO,relative:this.curCommandRelative,y:l}):this.curCommandType===x.MOVE_TO||this.curCommandType===x.LINE_TO||this.curCommandType===x.SMOOTH_QUAD_TO?(r({type:this.curCommandType,relative:this.curCommandRelative,x:this.curArgs[0],y:this.curArgs[1]}),x.MOVE_TO===this.curCommandType&&(this.curCommandType=x.LINE_TO)):this.curCommandType===x.CURVE_TO?r({type:x.CURVE_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x2:this.curArgs[2],y2:this.curArgs[3],x:this.curArgs[4],y:this.curArgs[5]}):this.curCommandType===x.SMOOTH_CURVE_TO?r({type:x.SMOOTH_CURVE_TO,relative:this.curCommandRelative,x2:this.curArgs[0],y2:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===x.QUAD_TO?r({type:x.QUAD_TO,relative:this.curCommandRelative,x1:this.curArgs[0],y1:this.curArgs[1],x:this.curArgs[2],y:this.curArgs[3]}):this.curCommandType===x.ARC&&r({type:x.ARC,relative:this.curCommandRelative,rX:this.curArgs[0],rY:this.curArgs[1],xRot:this.curArgs[2],lArcFlag:this.curArgs[3],sweepFlag:this.curArgs[4],x:this.curArgs[5],y:this.curArgs[6]})),this.curNumber="",this.curNumberHasExpDigits=!1,this.curNumberHasExp=!1,this.curNumberHasDecimal=!1,this.canParseCommandOrComma=!0}if(!Ar(s)){if(s===","&&this.canParseCommandOrComma){this.canParseCommandOrComma=!1;continue}if(s==="+"||s==="-"||s==="."){this.curNumber=s,this.curNumberHasDecimal=s===".";continue}if(u){this.curNumber=s,this.curNumberHasDecimal=!1;continue}if(this.curArgs.length!==0)throw new SyntaxError(`Unterminated command at index ${i}.`);if(!this.canParseCommandOrComma)throw new SyntaxError(`Unexpected character "${s}" at index ${i}. Command cannot follow comma`);if(this.canParseCommandOrComma=!1,s==="z"||s==="Z"){n.push({type:x.CLOSE_PATH}),this.canParseCommandOrComma=!0,this.curCommandType=-1;continue}else if(s==="h"||s==="H")this.curCommandType=x.HORIZ_LINE_TO,this.curCommandRelative=s==="h";else if(s==="v"||s==="V")this.curCommandType=x.VERT_LINE_TO,this.curCommandRelative=s==="v";else if(s==="m"||s==="M")this.curCommandType=x.MOVE_TO,this.curCommandRelative=s==="m";else if(s==="l"||s==="L")this.curCommandType=x.LINE_TO,this.curCommandRelative=s==="l";else if(s==="c"||s==="C")this.curCommandType=x.CURVE_TO,this.curCommandRelative=s==="c";else if(s==="s"||s==="S")this.curCommandType=x.SMOOTH_CURVE_TO,this.curCommandRelative=s==="s";else if(s==="q"||s==="Q")this.curCommandType=x.QUAD_TO,this.curCommandRelative=s==="q";else if(s==="t"||s==="T")this.curCommandType=x.SMOOTH_QUAD_TO,this.curCommandRelative=s==="t";else if(s==="a"||s==="A")this.curCommandType=x.ARC,this.curCommandRelative=s==="a";else throw new SyntaxError(`Unexpected character "${s}" at index ${i}.`)}}return n}transform(e){return Object.create(this,{parse:{value(n,r=[]){const i=Object.getPrototypeOf(this).parse.call(this,n);for(const s of i){const o=e(s);Array.isArray(o)?r.push(...o):r.push(o)}return r}}})}}const lt=class Ce extends kn{constructor(e){super(),pt(this,"commands"),typeof e=="string"?this.commands=Ce.parse(e):this.commands=e}encode(){return Ce.encode(this.commands)}getBounds(){const e=mt.CALCULATE_BOUNDS();return this.transform(e),e}transform(e){const n=[];for(const r of this.commands){const i=e(r);Array.isArray(i)?n.push(...i):n.push(i)}return this.commands=n,this}reverse(e=!0){return this.commands=mt.REVERSE_PATH(this.commands,e),this}static encode(e){return hr(e)}static parse(e){const n=new Cr,r=[];return n.parse(e,r),n.finish(r),r}};pt(lt,"CLOSE_PATH",1),pt(lt,"MOVE_TO",2),pt(lt,"HORIZ_LINE_TO",4),pt(lt,"VERT_LINE_TO",8),pt(lt,"LINE_TO",16),pt(lt,"CURVE_TO",32),pt(lt,"SMOOTH_CURVE_TO",64),pt(lt,"QUAD_TO",128),pt(lt,"SMOOTH_QUAD_TO",256),pt(lt,"ARC",512),pt(lt,"LINE_COMMANDS",lt.LINE_TO|lt.HORIZ_LINE_TO|lt.VERT_LINE_TO),pt(lt,"DRAWING_COMMANDS",lt.HORIZ_LINE_TO|lt.VERT_LINE_TO|lt.LINE_TO|lt.CURVE_TO|lt.SMOOTH_CURVE_TO|lt.QUAD_TO|lt.SMOOTH_QUAD_TO|lt.ARC);let x=lt;const Sr={[x.MOVE_TO]:2,[x.LINE_TO]:2,[x.HORIZ_LINE_TO]:1,[x.VERT_LINE_TO]:1,[x.CLOSE_PATH]:0,[x.QUAD_TO]:4,[x.SMOOTH_QUAD_TO]:2,[x.CURVE_TO]:6,[x.SMOOTH_CURVE_TO]:4,[x.ARC]:7},Mr=[];for(let t=0;t<256;++t)Mr.push((t+256).toString(16).slice(1));typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const Ir=[];for(let t=0;t<256;++t)Ir.push((t+256).toString(16).slice(1));typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const Lr="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let kr=(t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t|=0));for(;t--;)e+=Lr[n[t]&63];return e};kr();const Le=(t,e=0)=>{const{minX:n,minY:r,maxX:i,maxY:s}=t;return{x:n-e,y:r-e,w:i-n+2*e,h:s-r+2*e}},Ut=typeof window>"u"||typeof navigator>"u"?!1:"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,Pr=t=>({}),Ve=t=>({grab:t[0]});function Ur(t){let e,n,r,i;const s=t[8].default,o=Zn(s,t,t[7],Ve);return{c(){e=q("g"),o&&o.c(),c(e,"class","a9s-annotation selected")},m(u,l){Q(u,e,l),o&&o.m(e,null),n=!0,r||(i=[ot(e,"pointerup",t[2]),ot(e,"pointermove",t[1])],r=!0)},p(u,[l]){o&&o.p&&(!n||l&128)&&Kn(o,s,u,u[7],n?Wn(s,u[7],l,Pr):Qn(u[7]),Ve)},i(u){n||(it(o,u),n=!0)},o(u){ht(o,u),n=!1},d(u){u&&K(e),o&&o.d(u),r=!1,Nt(i)}}}function Hr(t,e,n){let{$$slots:r={},$$scope:i}=e;const s=Me();let{shape:o}=e,{editor:u}=e,{transform:l}=e,{svgEl:a}=e,h,d,y;const g=k=>I=>{if(h=k,a){const{left:Y,top:U}=a.getBoundingClientRect(),j=I.clientX-Y,H=I.clientY-U;d=l.elementToImage(j,H)}else{const{offsetX:Y,offsetY:U}=I;d=l.elementToImage(Y,U)}y=o,I.target.setPointerCapture(I.pointerId),s("grab",I)},w=k=>{if(h){const[I,Y]=l.elementToImage(k.offsetX,k.offsetY),U=[I-d[0],Y-d[1]];n(3,o=u(y,h,U)),s("change",o)}},_=k=>{k.target.releasePointerCapture(k.pointerId),h=void 0,y=o,s("release",k)};return t.$$set=k=>{"shape"in k&&n(3,o=k.shape),"editor"in k&&n(4,u=k.editor),"transform"in k&&n(5,l=k.transform),"svgEl"in k&&n(6,a=k.svgEl),"$$scope"in k&&n(7,i=k.$$scope)},[g,w,_,o,u,l,a,i,r]}class ke extends Jt{constructor(e){super(),Vt(this,e,Hr,Ur,Qt,{shape:3,editor:4,transform:5,svgEl:6})}}function Dr(t){let e,n,r,i,s,o,u,l,a=t[3]&&Je(t);return{c(){e=q("g"),n=q("circle"),a&&a.c(),i=q("circle"),c(n,"class","a9s-handle-buffer svelte-160z737"),c(n,"cx",t[0]),c(n,"cy",t[1]),c(n,"r",r=t[5]+6/t[2]),c(i,"class",s=oe(`a9s-handle-dot${t[3]?" selected":""}`)+" svelte-160z737"),c(i,"cx",t[0]),c(i,"cy",t[1]),c(i,"r",t[5]),c(e,"class",o=oe(`a9s-handle ${t[8].class||""}`.trim())+" svelte-160z737")},m(h,d){Q(h,e,d),ct(e,n),a&&a.m(e,null),ct(e,i),u||(l=[ot(n,"pointerenter",t[11]),ot(n,"pointerleave",t[12]),ot(n,"pointerdown",t[13]),ot(n,"pointerdown",t[6]),ot(n,"pointerup",t[14]),ot(n,"pointerup",t[7])],u=!0)},p(h,d){d&1&&c(n,"cx",h[0]),d&2&&c(n,"cy",h[1]),d&36&&r!==(r=h[5]+6/h[2])&&c(n,"r",r),h[3]?a?a.p(h,d):(a=Je(h),a.c(),a.m(e,i)):a&&(a.d(1),a=null),d&8&&s!==(s=oe(`a9s-handle-dot${h[3]?" selected":""}`)+" svelte-160z737")&&c(i,"class",s),d&1&&c(i,"cx",h[0]),d&2&&c(i,"cy",h[1]),d&32&&c(i,"r",h[5]),d&256&&o!==(o=oe(`a9s-handle ${h[8].class||""}`.trim())+" svelte-160z737")&&c(e,"class",o)},d(h){h&&K(e),a&&a.d(),u=!1,Nt(l)}}}function Fr(t){let e,n,r,i,s,o,u,l,a;return{c(){e=q("g"),n=q("circle"),i=q("circle"),o=q("circle"),c(n,"cx",t[0]),c(n,"cy",t[1]),c(n,"r",r=t[5]*10),c(n,"class","a9s-touch-halo svelte-160z737"),Xe(n,"touched",t[4]),c(i,"cx",t[0]),c(i,"cy",t[1]),c(i,"r",s=t[5]+10/t[2]),c(i,"class","a9s-handle-buffer svelte-160z737"),c(o,"class","a9s-handle-dot svelte-160z737"),c(o,"cx",t[0]),c(o,"cy",t[1]),c(o,"r",u=t[5]+2/t[2]),c(e,"class","a9s-touch-handle")},m(h,d){Q(h,e,d),ct(e,n),ct(e,i),ct(e,o),l||(a=[ot(i,"pointerdown",t[9]),ot(i,"pointerup",t[10]),ot(i,"pointerdown",t[6]),ot(i,"pointerup",t[7])],l=!0)},p(h,d){d&1&&c(n,"cx",h[0]),d&2&&c(n,"cy",h[1]),d&32&&r!==(r=h[5]*10)&&c(n,"r",r),d&16&&Xe(n,"touched",h[4]),d&1&&c(i,"cx",h[0]),d&2&&c(i,"cy",h[1]),d&36&&s!==(s=h[5]+10/h[2])&&c(i,"r",s),d&1&&c(o,"cx",h[0]),d&2&&c(o,"cy",h[1]),d&36&&u!==(u=h[5]+2/h[2])&&c(o,"r",u)},d(h){h&&K(e),l=!1,Nt(a)}}}function Je(t){let e,n;return{c(){e=q("circle"),c(e,"class","a9s-handle-selected svelte-160z737"),c(e,"cx",t[0]),c(e,"cy",t[1]),c(e,"r",n=t[5]+8/t[2])},m(r,i){Q(r,e,i)},p(r,i){i&1&&c(e,"cx",r[0]),i&2&&c(e,"cy",r[1]),i&36&&n!==(n=r[5]+8/r[2])&&c(e,"r",n)},d(r){r&&K(e)}}}function Yr(t){let e;function n(i,s){return Ut?Fr:Dr}let r=n()(t);return{c(){r.c(),e=se()},m(i,s){r.m(i,s),Q(i,e,s)},p(i,[s]){r.p(i,s)},i:jt,o:jt,d(i){i&&K(e),r.d(i)}}}function jr(t,e,n){let r,{x:i}=e,{y:s}=e,{scale:o}=e,{selected:u=void 0}=e,l=!1;const a=I=>{I.pointerType==="touch"&&n(4,l=!0)},h=()=>n(4,l=!1);function d(I){vt.call(this,t,I)}function y(I){vt.call(this,t,I)}function g(I){vt.call(this,t,I)}function w(I){vt.call(this,t,I)}function _(I){vt.call(this,t,I)}function k(I){vt.call(this,t,I)}return t.$$set=I=>{n(8,e=we(we({},e),je(I))),"x"in I&&n(0,i=I.x),"y"in I&&n(1,s=I.y),"scale"in I&&n(2,o=I.scale),"selected"in I&&n(3,u=I.selected)},t.$$.update=()=>{t.$$.dirty&4&&n(5,r=4/o)},e=je(e),[i,s,o,u,l,r,a,h,e,d,y,g,w,_,k]}class Bt extends Jt{constructor(e){super(),Vt(this,e,jr,Yr,Qt,{x:0,y:1,scale:2,selected:3})}}function Xr(t){let e,n,r,i,s,o,u;return{c(){e=q("g"),n=q("circle"),i=q("circle"),s=q("circle"),c(n,"class","a9s-polygon-midpoint-buffer svelte-12ykj76"),c(n,"cx",t[0]),c(n,"cy",t[1]),c(n,"r",r=1.75*t[2]),c(i,"class","a9s-polygon-midpoint-outer svelte-12ykj76"),c(i,"cx",t[0]),c(i,"cy",t[1]),c(i,"r",t[2]),c(s,"class","a9s-polygon-midpoint-inner svelte-12ykj76"),c(s,"cx",t[0]),c(s,"cy",t[1]),c(s,"r",t[2]),c(e,"class","a9s-polygon-midpoint svelte-12ykj76")},m(l,a){Q(l,e,a),ct(e,n),ct(e,i),ct(e,s),o||(u=[ot(n,"pointerdown",t[5]),ot(n,"pointerdown",t[3])],o=!0)},p(l,a){a&1&&c(n,"cx",l[0]),a&2&&c(n,"cy",l[1]),a&4&&r!==(r=1.75*l[2])&&c(n,"r",r),a&1&&c(i,"cx",l[0]),a&2&&c(i,"cy",l[1]),a&4&&c(i,"r",l[2]),a&1&&c(s,"cx",l[0]),a&2&&c(s,"cy",l[1]),a&4&&c(s,"r",l[2])},d(l){l&&K(e),o=!1,Nt(u)}}}function zr(t){let e;return{c(){e=q("circle"),c(e,"cx",t[0]),c(e,"cy",t[1]),c(e,"r",t[2])},m(n,r){Q(n,e,r)},p(n,r){r&1&&c(e,"cx",n[0]),r&2&&c(e,"cy",n[1]),r&4&&c(e,"r",n[2])},d(n){n&&K(e)}}}function Gr(t){let e;function n(i,s){return Ut?zr:Xr}let r=n()(t);return{c(){r.c(),e=se()},m(i,s){r.m(i,s),Q(i,e,s)},p(i,[s]){r.p(i,s)},i:jt,o:jt,d(i){i&&K(e),r.d(i)}}}function qr(t,e,n){let r,{x:i}=e,{y:s}=e,{scale:o}=e;const u=a=>{a.pointerType};function l(a){vt.call(this,t,a)}return t.$$set=a=>{"x"in a&&n(0,i=a.x),"y"in a&&n(1,s=a.y),"scale"in a&&n(4,o=a.scale)},t.$$.update=()=>{t.$$.dirty&16&&n(2,r=4/o)},[i,s,r,u,o,l]}class Pn extends Jt{constructor(e){super(),Vt(this,e,qr,Gr,Qt,{x:0,y:1,scale:4})}}function ge(t){const e=t.slice(),n=e[10][e[6]];return e[28]=n.point,e}function tn(t,e,n){const r=t.slice();return r[28]=e[n],r[30]=n,r}function xe(t){const e=t.slice(),n=e[10][e[6]];return e[28]=n.point,e}function _e(t){const e=t.slice(),n=e[10][e[6]];return e[28]=n.point,e}function en(t){let e,n,r,i;return{c(){e=q("circle"),c(e,"cx",n=t[28][0]),c(e,"cy",r=t[28][1]),c(e,"r",i=re/t[3]),c(e,"class","svelte-1h2slbm")},m(s,o){Q(s,e,o)},p(s,o){o[0]&1088&&n!==(n=s[28][0])&&c(e,"cx",n),o[0]&1088&&r!==(r=s[28][1])&&c(e,"cy",r),o[0]&8&&i!==(i=re/s[3])&&c(e,"r",i)},d(s){s&&K(e)}}}function nn(t){let e,n,r,i,s,o,u,l,a,h;return{c(){e=q("mask"),n=q("rect"),u=q("circle"),c(n,"x",r=t[9].x),c(n,"y",i=t[9].y),c(n,"width",s=t[9].w),c(n,"height",o=t[9].h),c(n,"class","svelte-1h2slbm"),c(u,"cx",l=t[28][0]),c(u,"cy",a=t[28][1]),c(u,"r",h=re/t[3]),c(u,"class","svelte-1h2slbm"),c(e,"id",`${t[19]}-inner`),c(e,"class","a9s-polygon-editor-mask svelte-1h2slbm")},m(d,y){Q(d,e,y),ct(e,n),ct(e,u)},p(d,y){y[0]&512&&r!==(r=d[9].x)&&c(n,"x",r),y[0]&512&&i!==(i=d[9].y)&&c(n,"y",i),y[0]&512&&s!==(s=d[9].w)&&c(n,"width",s),y[0]&512&&o!==(o=d[9].h)&&c(n,"height",o),y[0]&1088&&l!==(l=d[28][0])&&c(u,"cx",l),y[0]&1088&&a!==(a=d[28][1])&&c(u,"cy",a),y[0]&8&&h!==(h=re/d[3])&&c(u,"r",h)},d(d){d&&K(e)}}}function rn(t){let e,n;return e=new Bt({props:{class:"a9s-corner-handle",x:t[28][0],y:t[28][1],scale:t[3],selected:t[8].includes(t[30])}}),e.$on("pointerenter",t[11]),e.$on("pointerleave",t[12]),e.$on("pointerdown",t[15]),e.$on("pointerdown",function(){gt(t[27](`HANDLE-${t[30]}`))&&t[27](`HANDLE-${t[30]}`).apply(this,arguments)}),e.$on("pointerup",t[16](t[30])),{c(){Rt(e.$$.fragment)},m(r,i){$t(e,r,i),n=!0},p(r,i){t=r;const s={};i[0]&32&&(s.x=t[28][0]),i[0]&32&&(s.y=t[28][1]),i[0]&8&&(s.scale=t[3]),i[0]&256&&(s.selected=t[8].includes(t[30])),e.$set(s)},i(r){n||(it(e.$$.fragment,r),n=!0)},o(r){ht(e.$$.fragment,r),n=!1},d(r){bt(e,r)}}}function sn(t){let e,n;return e=new Pn({props:{x:t[28][0],y:t[28][1],scale:t[3]}}),e.$on("pointerdown",function(){gt(t[18](t[6]))&&t[18](t[6]).apply(this,arguments)}),{c(){Rt(e.$$.fragment)},m(r,i){$t(e,r,i),n=!0},p(r,i){t=r;const s={};i[0]&1088&&(s.x=t[28][0]),i[0]&1088&&(s.y=t[28][1]),i[0]&8&&(s.scale=t[3]),e.$set(s)},i(r){n||(it(e.$$.fragment,r),n=!0)},o(r){ht(e.$$.fragment,r),n=!1},d(r){bt(e,r)}}}function Br(t){let e,n,r,i,s,o,u,l,a,h,d,y,g,w,_,k,I,Y,U,j,H,A=t[6]!==void 0&&!t[7]&&en(_e(t)),v=t[6]!==void 0&&!t[7]&&nn(xe(t)),p=Ht(t[5].points),f=[];for(let T=0;T<p.length;T+=1)f[T]=rn(tn(t,p,T));const m=T=>ht(f[T],1,1,()=>{f[T]=null});let $=t[6]!==void 0&&!t[7]&&sn(ge(t));return{c(){e=q("defs"),n=q("mask"),r=q("rect"),l=q("polygon"),A&&A.c(),v&&v.c(),h=Et(),d=q("polygon"),g=Et(),w=q("polygon"),k=Et();for(let T=0;T<f.length;T+=1)f[T].c();I=Et(),$&&$.c(),Y=se(),c(r,"x",i=t[9].x),c(r,"y",s=t[9].y),c(r,"width",o=t[9].w),c(r,"height",u=t[9].h),c(r,"class","svelte-1h2slbm"),c(l,"points",a=t[5].points.map(on).join(" ")),c(l,"class","svelte-1h2slbm"),c(n,"id",`${t[19]}-outer`),c(n,"class","a9s-polygon-editor-mask svelte-1h2slbm"),c(d,"class","a9s-outer"),c(d,"mask",`url(#${t[19]}-outer)`),c(d,"points",y=t[5].points.map(an).join(" ")),c(w,"class","a9s-inner a9s-shape-handle"),c(w,"mask",`url(#${t[19]}-inner)`),c(w,"style",t[1]),c(w,"points",_=t[5].points.map(un).join(" "))},m(T,N){Q(T,e,N),ct(e,n),ct(n,r),ct(n,l),A&&A.m(n,null),v&&v.m(e,null),Q(T,h,N),Q(T,d,N),Q(T,g,N),Q(T,w,N),Q(T,k,N);for(let O=0;O<f.length;O+=1)f[O]&&f[O].m(T,N);Q(T,I,N),$&&$.m(T,N),Q(T,Y,N),U=!0,j||(H=[ot(d,"pointerup",t[14]),ot(d,"pointerdown",function(){gt(t[27]("SHAPE"))&&t[27]("SHAPE").apply(this,arguments)}),ot(w,"pointermove",t[13]),ot(w,"pointerup",t[14]),ot(w,"pointerdown",function(){gt(t[27]("SHAPE"))&&t[27]("SHAPE").apply(this,arguments)})],j=!0)},p(T,N){if(t=T,(!U||N[0]&512&&i!==(i=t[9].x))&&c(r,"x",i),(!U||N[0]&512&&s!==(s=t[9].y))&&c(r,"y",s),(!U||N[0]&512&&o!==(o=t[9].w))&&c(r,"width",o),(!U||N[0]&512&&u!==(u=t[9].h))&&c(r,"height",u),(!U||N[0]&32&&a!==(a=t[5].points.map(on).join(" ")))&&c(l,"points",a),t[6]!==void 0&&!t[7]?A?A.p(_e(t),N):(A=en(_e(t)),A.c(),A.m(n,null)):A&&(A.d(1),A=null),t[6]!==void 0&&!t[7]?v?v.p(xe(t),N):(v=nn(xe(t)),v.c(),v.m(e,null)):v&&(v.d(1),v=null),(!U||N[0]&32&&y!==(y=t[5].points.map(an).join(" ")))&&c(d,"points",y),(!U||N[0]&2)&&c(w,"style",t[1]),(!U||N[0]&32&&_!==(_=t[5].points.map(un).join(" ")))&&c(w,"points",_),N[0]&134322472){p=Ht(t[5].points);let O;for(O=0;O<p.length;O+=1){const E=tn(t,p,O);f[O]?(f[O].p(E,N),it(f[O],1)):(f[O]=rn(E),f[O].c(),it(f[O],1),f[O].m(I.parentNode,I))}for(Wt(),O=p.length;O<f.length;O+=1)m(O);Kt()}t[6]!==void 0&&!t[7]?$?($.p(ge(t),N),N[0]&192&&it($,1)):($=sn(ge(t)),$.c(),it($,1),$.m(Y.parentNode,Y)):$&&(Wt(),ht($,1,1,()=>{$=null}),Kt())},i(T){if(!U){for(let N=0;N<p.length;N+=1)it(f[N]);it($),U=!0}},o(T){f=f.filter(Boolean);for(let N=0;N<f.length;N+=1)ht(f[N]);ht($),U=!1},d(T){T&&(K(e),K(h),K(d),K(g),K(w),K(k),K(I),K(Y)),A&&A.d(),v&&v.d(),ce(f,T),$&&$.d(T),j=!1,Nt(H)}}}function Zr(t){let e,n;return e=new ke({props:{shape:t[0],transform:t[2],editor:t[17],svgEl:t[4],$$slots:{default:[Br,({grab:r})=>({27:r}),({grab:r})=>[r?134217728:0]]},$$scope:{ctx:t}}}),e.$on("change",t[20]),e.$on("grab",t[21]),e.$on("release",t[22]),{c(){Rt(e.$$.fragment)},m(r,i){$t(e,r,i),n=!0},p(r,i){const s={};i[0]&1&&(s.shape=r[0]),i[0]&4&&(s.transform=r[2]),i[0]&16&&(s.svgEl=r[4]),i[0]&134219754|i[1]&1&&(s.$$scope={dirty:i,ctx:r}),e.$set(s)},i(r){n||(it(e.$$.fragment,r),n=!0)},o(r){ht(e.$$.fragment,r),n=!1},d(r){bt(e,r)}}}const Wr=250,Kr=1e3,Qr=12,re=4.5,on=t=>t.join(","),an=t=>t.join(","),un=t=>t.join(",");function Vr(t,e,n){let r,i,s;const o=Me();let{shape:u}=e,{computedStyle:l}=e,{transform:a}=e,{viewportScale:h=1}=e,{svgEl:d}=e,y,g=!1,w,_=[];const k=()=>n(7,g=!0),I=()=>n(7,g=!1),Y=O=>{if(_.length>0||!i.some(R=>R.visible)){n(6,y=void 0);return}const[E,P]=a.elementToImage(O.offsetX,O.offsetY),b=R=>Math.pow(R[0]-E,2)+Math.pow(R[1]-P,2),D=r.points.reduce((R,S)=>b(S)<b(R)?S:R),C=i.filter(R=>R.visible).reduce((R,S)=>b(S.point)<b(R.point)?S:R),F=Math.pow(Kr/h,2);b(D)<F||b(C.point)<F?n(6,y=i.indexOf(C)):n(6,y=void 0)},U=()=>{document.activeElement!==d&&d.focus()},j=()=>{n(8,_=[]),U()},H=O=>{n(7,g=!0),O.preventDefault(),O.stopPropagation(),w=performance.now()},A=O=>E=>{if(!w||Ut||performance.now()-w>Wr)return;const P=_.includes(O);E.metaKey||E.ctrlKey||E.shiftKey?P?n(8,_=_.filter(b=>b!==O)):n(8,_=[..._,O]):P&&_.length>1?n(8,_=[O]):P?n(8,_=[]):n(8,_=[O]),U()},v=(O,E,P)=>{U();let b;const D=O.geometry;_.length>1?b=D.points.map(([F,R],S)=>_.includes(S)?[F+P[0],R+P[1]]:[F,R]):E==="SHAPE"?b=D.points.map(([F,R])=>[F+P[0],R+P[1]]):b=D.points.map(([F,R],S)=>E===`HANDLE-${S}`?[F+P[0],R+P[1]]:[F,R]);const C=Lt(b);return{...O,geometry:{points:b,bounds:C}}},p=O=>async E=>{E.stopPropagation();const P=[...r.points.slice(0,O+1),i[O].point,...r.points.slice(O+1)],b=Lt(P);o("change",{...u,geometry:{points:P,bounds:b}}),await An();const D=[...document.querySelectorAll(".a9s-handle")][O+1];if(D!=null&&D.firstChild){const C=new PointerEvent("pointerdown",{bubbles:!0,cancelable:!0,clientX:E.clientX,clientY:E.clientY,pointerId:E.pointerId,pointerType:E.pointerType,isPrimary:E.isPrimary,buttons:E.buttons});D.firstChild.dispatchEvent(C)}},f=()=>{if(r.points.length<4)return;const O=r.points.filter((P,b)=>!_.includes(b)),E=Lt(O);o("change",{...u,geometry:{points:O,bounds:E}}),n(8,_=[])};bn(()=>{if(Ut)return;const O=E=>{(E.key==="Delete"||E.key==="Backspace")&&(E.preventDefault(),f())};return d.addEventListener("pointermove",Y),d.addEventListener("keydown",O),()=>{d.removeEventListener("pointermove",Y),d.removeEventListener("keydown",O)}});const m=`polygon-mask-${Math.random().toString(36).substring(2,12)}`;function $(O){vt.call(this,t,O)}function T(O){vt.call(this,t,O)}function N(O){vt.call(this,t,O)}return t.$$set=O=>{"shape"in O&&n(0,u=O.shape),"computedStyle"in O&&n(1,l=O.computedStyle),"transform"in O&&n(2,a=O.transform),"viewportScale"in O&&n(3,h=O.viewportScale),"svgEl"in O&&n(4,d=O.svgEl)},t.$$.update=()=>{t.$$.dirty[0]&1&&n(5,r=u.geometry),t.$$.dirty[0]&40&&n(10,i=Ut?[]:r.points.map((O,E)=>{const P=E===r.points.length-1?r.points[0]:r.points[E+1],b=(O[0]+P[0])/2,D=(O[1]+P[1])/2,C=Math.sqrt(Math.pow(P[0]-b,2)+Math.pow(P[1]-D,2))>Qr/h;return{point:[b,D],visible:C}})),t.$$.dirty[0]&40&&n(9,s=Le(r.bounds,re/h))},[u,l,a,h,d,r,y,g,_,s,i,k,I,Y,j,H,A,v,p,m,$,T,N]}class Jr extends Jt{constructor(e){super(),Vt(this,e,Vr,Zr,Qt,{shape:0,computedStyle:1,transform:2,viewportScale:3,svgEl:4},null,[-1,-1])}}function ti(t){let e,n,r,i,s,o,u,l,a,h,d,y,g,w,_,k,I,Y,U,j,H,A,v,p,f,m,$,T,N,O,E,P,b,D,C,F,R,S,M,J,V,at,xt,W,tt,nt,X,rt,ft,et,st,B,G,Z,ut;return nt=new Bt({props:{class:"a9s-corner-handle-topleft",x:t[5].x,y:t[5].y,scale:t[3]}}),nt.$on("pointerdown",function(){gt(t[12]("TOP_LEFT"))&&t[12]("TOP_LEFT").apply(this,arguments)}),rt=new Bt({props:{class:"a9s-corner-handle-topright",x:t[5].x+t[5].w,y:t[5].y,scale:t[3]}}),rt.$on("pointerdown",function(){gt(t[12]("TOP_RIGHT"))&&t[12]("TOP_RIGHT").apply(this,arguments)}),et=new Bt({props:{class:"a9s-corner-handle-bottomright",x:t[5].x+t[5].w,y:t[5].y+t[5].h,scale:t[3]}}),et.$on("pointerdown",function(){gt(t[12]("BOTTOM_RIGHT"))&&t[12]("BOTTOM_RIGHT").apply(this,arguments)}),B=new Bt({props:{class:"a9s-corner-handle-bottomleft",x:t[5].x,y:t[5].y+t[5].h,scale:t[3]}}),B.$on("pointerdown",function(){gt(t[12]("BOTTOM_LEFT"))&&t[12]("BOTTOM_LEFT").apply(this,arguments)}),{c(){e=q("defs"),n=q("mask"),r=q("rect"),l=q("rect"),g=Et(),w=q("rect"),U=Et(),j=q("rect"),f=Et(),m=q("rect"),O=Et(),E=q("rect"),C=Et(),F=q("rect"),J=Et(),V=q("rect"),tt=Et(),Rt(nt.$$.fragment),X=Et(),Rt(rt.$$.fragment),ft=Et(),Rt(et.$$.fragment),st=Et(),Rt(B.$$.fragment),c(r,"class","rect-mask-bg svelte-1njczvj"),c(r,"x",i=t[6].x),c(r,"y",s=t[6].y),c(r,"width",o=t[6].w),c(r,"height",u=t[6].h),c(l,"class","rect-mask-fg svelte-1njczvj"),c(l,"x",a=t[5].x),c(l,"y",h=t[5].y),c(l,"width",d=t[5].w),c(l,"height",y=t[5].h),c(n,"id",t[8]),c(n,"class","a9s-rectangle-editor-mask svelte-1njczvj"),c(w,"class","a9s-outer"),c(w,"mask",`url(#${t[8]})`),c(w,"x",_=t[5].x),c(w,"y",k=t[5].y),c(w,"width",I=t[5].w),c(w,"height",Y=t[5].h),c(j,"class","a9s-inner a9s-shape-handle"),c(j,"style",t[1]),c(j,"x",H=t[5].x),c(j,"y",A=t[5].y),c(j,"width",v=t[5].w),c(j,"height",p=t[5].h),c(m,"class","a9s-edge-handle a9s-edge-handle-top"),c(m,"x",$=t[5].x),c(m,"y",T=t[5].y),c(m,"height",1),c(m,"width",N=t[5].w),c(E,"class","a9s-edge-handle a9s-edge-handle-right"),c(E,"x",P=t[5].x+t[5].w),c(E,"y",b=t[5].y),c(E,"height",D=t[5].h),c(E,"width",1),c(F,"class","a9s-edge-handle a9s-edge-handle-bottom"),c(F,"x",R=t[5].x),c(F,"y",S=t[5].y+t[5].h),c(F,"height",1),c(F,"width",M=t[5].w),c(V,"class","a9s-edge-handle a9s-edge-handle-left"),c(V,"x",at=t[5].x),c(V,"y",xt=t[5].y),c(V,"height",W=t[5].h),c(V,"width",1)},m(z,L){Q(z,e,L),ct(e,n),ct(n,r),ct(n,l),Q(z,g,L),Q(z,w,L),Q(z,U,L),Q(z,j,L),Q(z,f,L),Q(z,m,L),Q(z,O,L),Q(z,E,L),Q(z,C,L),Q(z,F,L),Q(z,J,L),Q(z,V,L),Q(z,tt,L),$t(nt,z,L),Q(z,X,L),$t(rt,z,L),Q(z,ft,L),$t(et,z,L),Q(z,st,L),$t(B,z,L),G=!0,Z||(ut=[ot(w,"pointerdown",function(){gt(t[12]("SHAPE"))&&t[12]("SHAPE").apply(this,arguments)}),ot(j,"pointerdown",function(){gt(t[12]("SHAPE"))&&t[12]("SHAPE").apply(this,arguments)}),ot(m,"pointerdown",function(){gt(t[12]("TOP"))&&t[12]("TOP").apply(this,arguments)}),ot(E,"pointerdown",function(){gt(t[12]("RIGHT"))&&t[12]("RIGHT").apply(this,arguments)}),ot(F,"pointerdown",function(){gt(t[12]("BOTTOM"))&&t[12]("BOTTOM").apply(this,arguments)}),ot(V,"pointerdown",function(){gt(t[12]("LEFT"))&&t[12]("LEFT").apply(this,arguments)})],Z=!0)},p(z,L){t=z,(!G||L&64&&i!==(i=t[6].x))&&c(r,"x",i),(!G||L&64&&s!==(s=t[6].y))&&c(r,"y",s),(!G||L&64&&o!==(o=t[6].w))&&c(r,"width",o),(!G||L&64&&u!==(u=t[6].h))&&c(r,"height",u),(!G||L&32&&a!==(a=t[5].x))&&c(l,"x",a),(!G||L&32&&h!==(h=t[5].y))&&c(l,"y",h),(!G||L&32&&d!==(d=t[5].w))&&c(l,"width",d),(!G||L&32&&y!==(y=t[5].h))&&c(l,"height",y),(!G||L&32&&_!==(_=t[5].x))&&c(w,"x",_),(!G||L&32&&k!==(k=t[5].y))&&c(w,"y",k),(!G||L&32&&I!==(I=t[5].w))&&c(w,"width",I),(!G||L&32&&Y!==(Y=t[5].h))&&c(w,"height",Y),(!G||L&2)&&c(j,"style",t[1]),(!G||L&32&&H!==(H=t[5].x))&&c(j,"x",H),(!G||L&32&&A!==(A=t[5].y))&&c(j,"y",A),(!G||L&32&&v!==(v=t[5].w))&&c(j,"width",v),(!G||L&32&&p!==(p=t[5].h))&&c(j,"height",p),(!G||L&32&&$!==($=t[5].x))&&c(m,"x",$),(!G||L&32&&T!==(T=t[5].y))&&c(m,"y",T),(!G||L&32&&N!==(N=t[5].w))&&c(m,"width",N),(!G||L&32&&P!==(P=t[5].x+t[5].w))&&c(E,"x",P),(!G||L&32&&b!==(b=t[5].y))&&c(E,"y",b),(!G||L&32&&D!==(D=t[5].h))&&c(E,"height",D),(!G||L&32&&R!==(R=t[5].x))&&c(F,"x",R),(!G||L&32&&S!==(S=t[5].y+t[5].h))&&c(F,"y",S),(!G||L&32&&M!==(M=t[5].w))&&c(F,"width",M),(!G||L&32&&at!==(at=t[5].x))&&c(V,"x",at),(!G||L&32&&xt!==(xt=t[5].y))&&c(V,"y",xt),(!G||L&32&&W!==(W=t[5].h))&&c(V,"height",W);const Tt={};L&32&&(Tt.x=t[5].x),L&32&&(Tt.y=t[5].y),L&8&&(Tt.scale=t[3]),nt.$set(Tt);const St={};L&32&&(St.x=t[5].x+t[5].w),L&32&&(St.y=t[5].y),L&8&&(St.scale=t[3]),rt.$set(St);const dt={};L&32&&(dt.x=t[5].x+t[5].w),L&32&&(dt.y=t[5].y+t[5].h),L&8&&(dt.scale=t[3]),et.$set(dt);const Ot={};L&32&&(Ot.x=t[5].x),L&32&&(Ot.y=t[5].y+t[5].h),L&8&&(Ot.scale=t[3]),B.$set(Ot)},i(z){G||(it(nt.$$.fragment,z),it(rt.$$.fragment,z),it(et.$$.fragment,z),it(B.$$.fragment,z),G=!0)},o(z){ht(nt.$$.fragment,z),ht(rt.$$.fragment,z),ht(et.$$.fragment,z),ht(B.$$.fragment,z),G=!1},d(z){z&&(K(e),K(g),K(w),K(U),K(j),K(f),K(m),K(O),K(E),K(C),K(F),K(J),K(V),K(tt),K(X),K(ft),K(st)),bt(nt,z),bt(rt,z),bt(et,z),bt(B,z),Z=!1,Nt(ut)}}}function ei(t){let e,n;return e=new ke({props:{shape:t[0],transform:t[2],editor:t[7],svgEl:t[4],$$slots:{default:[ti,({grab:r})=>({12:r}),({grab:r})=>r?4096:0]},$$scope:{ctx:t}}}),e.$on("grab",t[9]),e.$on("change",t[10]),e.$on("release",t[11]),{c(){Rt(e.$$.fragment)},m(r,i){$t(e,r,i),n=!0},p(r,[i]){const s={};i&1&&(s.shape=r[0]),i&4&&(s.transform=r[2]),i&16&&(s.svgEl=r[4]),i&12394&&(s.$$scope={dirty:i,ctx:r}),e.$set(s)},i(r){n||(it(e.$$.fragment,r),n=!0)},o(r){ht(e.$$.fragment,r),n=!1},d(r){bt(e,r)}}}function ni(t,e,n){let r,i,{shape:s}=e,{computedStyle:o}=e,{transform:u}=e,{viewportScale:l=1}=e,{svgEl:a}=e;const h=(_,k,I)=>{const Y=_.geometry.bounds;let[U,j]=[Y.minX,Y.minY],[H,A]=[Y.maxX,Y.maxY];const[v,p]=I;if(k==="SHAPE")U+=v,H+=v,j+=p,A+=p;else{switch(k){case"TOP":case"TOP_LEFT":case"TOP_RIGHT":{j+=p;break}case"BOTTOM":case"BOTTOM_LEFT":case"BOTTOM_RIGHT":{A+=p;break}}switch(k){case"LEFT":case"TOP_LEFT":case"BOTTOM_LEFT":{U+=v;break}case"RIGHT":case"TOP_RIGHT":case"BOTTOM_RIGHT":{H+=v;break}}}const f=Math.min(U,H),m=Math.min(j,A),$=Math.abs(H-U),T=Math.abs(A-j);return{..._,geometry:{x:f,y:m,w:$,h:T,bounds:{minX:f,minY:m,maxX:f+$,maxY:m+T}}}},d=`rect-mask-${Math.random().toString(36).substring(2,12)}`;function y(_){vt.call(this,t,_)}function g(_){vt.call(this,t,_)}function w(_){vt.call(this,t,_)}return t.$$set=_=>{"shape"in _&&n(0,s=_.shape),"computedStyle"in _&&n(1,o=_.computedStyle),"transform"in _&&n(2,u=_.transform),"viewportScale"in _&&n(3,l=_.viewportScale),"svgEl"in _&&n(4,a=_.svgEl)},t.$$.update=()=>{t.$$.dirty&1&&n(5,r=s.geometry),t.$$.dirty&40&&n(6,i=Le(r.bounds,2/l))},[s,o,u,l,a,r,i,h,d,y,g,w]}class ri extends Jt{constructor(e){super(),Vt(this,e,ni,ei,Qt,{shape:0,computedStyle:1,transform:2,viewportScale:3,svgEl:4})}}var ln=Object.prototype.hasOwnProperty;function Se(t,e){var n,r;if(t===e)return!0;if(t&&e&&(n=t.constructor)===e.constructor){if(n===Date)return t.getTime()===e.getTime();if(n===RegExp)return t.toString()===e.toString();if(n===Array){if((r=t.length)===e.length)for(;r--&&Se(t[r],e[r]););return r===-1}if(!n||typeof t=="object"){r=0;for(n in t)if(ln.call(t,n)&&++r&&!ln.call(e,n)||!(n in e)||!Se(t[n],e[n]))return!1;return Object.keys(e).length===r}}return t!==t&&e!==e}const ii=12,si=(t,e)=>t.polygons.reduce((n,r,i)=>{const s=r.rings.reduce((o,u,l)=>{const a=u.points.map((h,d)=>{const y=d===u.points.length-1?u.points[0]:u.points[d+1],g=(h[0]+y[0])/2,w=(h[1]+y[1])/2,_=Math.sqrt(Math.pow(y[0]-g,2)+Math.pow(y[1]-w,2))>ii/e;return{point:[g,w],visible:_,elementIdx:i,ringIdx:l,pointIdx:d}});return[...o,...a]},[]);return[...n,...s]},[]);function ve(t){const e=t.slice(),n=e[10][e[6]];return e[29]=n.point,e}function cn(t,e,n){const r=t.slice();return r[30]=e[n],r[32]=n,r}function hn(t,e,n){const r=t.slice();return r[33]=e[n],r[35]=n,r}function fn(t,e,n){const r=t.slice();return r[29]=e[n],r[37]=n,r}function Te(t){const e=t.slice(),n=e[10][e[6]];return e[29]=n.point,e}function Oe(t){const e=t.slice(),n=e[10][e[6]];return e[29]=n.point,e}function pn(t){let e,n,r,i;return{c(){e=q("circle"),c(e,"cx",n=t[29][0]),c(e,"cy",r=t[29][1]),c(e,"r",i=ie/t[3]),c(e,"class","svelte-1vxo6dc")},m(s,o){Q(s,e,o)},p(s,o){o[0]&1088&&n!==(n=s[29][0])&&c(e,"cx",n),o[0]&1088&&r!==(r=s[29][1])&&c(e,"cy",r),o[0]&8&&i!==(i=ie/s[3])&&c(e,"r",i)},d(s){s&&K(e)}}}function dn(t){let e,n,r,i,s,o,u,l,a,h;return{c(){e=q("mask"),n=q("rect"),u=q("circle"),c(n,"x",r=t[9].x),c(n,"y",i=t[9].y),c(n,"width",s=t[9].w),c(n,"height",o=t[9].h),c(n,"class","svelte-1vxo6dc"),c(u,"cx",l=t[29][0]),c(u,"cy",a=t[29][1]),c(u,"r",h=ie/t[3]),c(u,"class","svelte-1vxo6dc"),c(e,"id",`${t[18]}-${t[32]}-inner`),c(e,"class","a9s-multipolygon-editor-mask svelte-1vxo6dc")},m(d,y){Q(d,e,y),ct(e,n),ct(e,u)},p(d,y){y[0]&512&&r!==(r=d[9].x)&&c(n,"x",r),y[0]&512&&i!==(i=d[9].y)&&c(n,"y",i),y[0]&512&&s!==(s=d[9].w)&&c(n,"width",s),y[0]&512&&o!==(o=d[9].h)&&c(n,"height",o),y[0]&1088&&l!==(l=d[29][0])&&c(u,"cx",l),y[0]&1088&&a!==(a=d[29][1])&&c(u,"cy",a),y[0]&8&&h!==(h=ie/d[3])&&c(u,"r",h)},d(d){d&&K(e)}}}function yn(t){let e,n;function r(...i){return t[19](t[32],t[35],t[37],...i)}return e=new Bt({props:{class:"a9s-corner-handle",x:t[29][0],y:t[29][1],scale:t[3],selected:t[8].some(r)}}),e.$on("pointerenter",t[11]),e.$on("pointerleave",t[12]),e.$on("pointerdown",t[14]),e.$on("pointerdown",function(){gt(t[28](`HANDLE-${t[32]}-${t[35]}-${t[37]}`))&&t[28](`HANDLE-${t[32]}-${t[35]}-${t[37]}`).apply(this,arguments)}),e.$on("pointerup",t[15](t[32],t[35],t[37])),{c(){Rt(e.$$.fragment)},m(i,s){$t(e,i,s),n=!0},p(i,s){t=i;const o={};s[0]&32&&(o.x=t[29][0]),s[0]&32&&(o.y=t[29][1]),s[0]&8&&(o.scale=t[3]),s[0]&256&&(o.selected=t[8].some(r)),e.$set(o)},i(i){n||(it(e.$$.fragment,i),n=!0)},o(i){ht(e.$$.fragment,i),n=!1},d(i){bt(e,i)}}}function mn(t){let e,n,r=Ht(t[33].points),i=[];for(let o=0;o<r.length;o+=1)i[o]=yn(fn(t,r,o));const s=o=>ht(i[o],1,1,()=>{i[o]=null});return{c(){for(let o=0;o<i.length;o+=1)i[o].c();e=se()},m(o,u){for(let l=0;l<i.length;l+=1)i[l]&&i[l].m(o,u);Q(o,e,u),n=!0},p(o,u){if(u[0]&268491048){r=Ht(o[33].points);let l;for(l=0;l<r.length;l+=1){const a=fn(o,r,l);i[l]?(i[l].p(a,u),it(i[l],1)):(i[l]=yn(a),i[l].c(),it(i[l],1),i[l].m(e.parentNode,e))}for(Wt(),l=r.length;l<i.length;l+=1)s(l);Kt()}},i(o){if(!n){for(let u=0;u<r.length;u+=1)it(i[u]);n=!0}},o(o){i=i.filter(Boolean);for(let u=0;u<i.length;u+=1)ht(i[u]);n=!1},d(o){o&&K(e),ce(i,o)}}}function gn(t){let e,n,r,i,s,o,u,l,a,h,d,y,g,w,_,k,I,Y=t[6]!==void 0&&!t[7]&&pn(Oe(t)),U=t[6]!==void 0&&!t[7]&&dn(Te(t)),j=Ht(t[30].rings),H=[];for(let v=0;v<j.length;v+=1)H[v]=mn(hn(t,j,v));const A=v=>ht(H[v],1,1,()=>{H[v]=null});return{c(){e=q("g"),n=q("defs"),r=q("mask"),i=q("rect"),a=q("path"),Y&&Y.c(),U&&U.c(),d=q("path"),g=q("path");for(let v=0;v<H.length;v+=1)H[v].c();c(i,"x",s=t[9].x),c(i,"y",o=t[9].y),c(i,"width",u=t[9].w),c(i,"height",l=t[9].h),c(i,"class","svelte-1vxo6dc"),c(a,"d",h=Gt(t[30])),c(a,"class","svelte-1vxo6dc"),c(r,"id",`${t[18]}-${t[32]}-outer`),c(r,"class","a9s-multipolygon-editor-mask svelte-1vxo6dc"),c(d,"class","a9s-outer"),c(d,"mask",`url(#${t[18]}-${t[32]}-outer)`),c(d,"fill-rule","evenodd"),c(d,"d",y=Gt(t[30])),c(g,"class","a9s-inner"),c(g,"mask",`url(#${t[18]}-${t[32]}-inner)`),c(g,"style",t[1]),c(g,"fill-rule","evenodd"),c(g,"d",w=Gt(t[30]))},m(v,p){Q(v,e,p),ct(e,n),ct(n,r),ct(r,i),ct(r,a),Y&&Y.m(r,null),U&&U.m(n,null),ct(e,d),ct(e,g);for(let f=0;f<H.length;f+=1)H[f]&&H[f].m(e,null);_=!0,k||(I=[ot(d,"pointerup",t[13]),ot(d,"pointerdown",function(){gt(t[28]("SHAPE"))&&t[28]("SHAPE").apply(this,arguments)}),ot(g,"pointerup",t[13]),ot(g,"pointerdown",function(){gt(t[28]("SHAPE"))&&t[28]("SHAPE").apply(this,arguments)})],k=!0)},p(v,p){if(t=v,(!_||p[0]&512&&s!==(s=t[9].x))&&c(i,"x",s),(!_||p[0]&512&&o!==(o=t[9].y))&&c(i,"y",o),(!_||p[0]&512&&u!==(u=t[9].w))&&c(i,"width",u),(!_||p[0]&512&&l!==(l=t[9].h))&&c(i,"height",l),(!_||p[0]&32&&h!==(h=Gt(t[30])))&&c(a,"d",h),t[6]!==void 0&&!t[7]?Y?Y.p(Oe(t),p):(Y=pn(Oe(t)),Y.c(),Y.m(r,null)):Y&&(Y.d(1),Y=null),t[6]!==void 0&&!t[7]?U?U.p(Te(t),p):(U=dn(Te(t)),U.c(),U.m(n,null)):U&&(U.d(1),U=null),(!_||p[0]&32&&y!==(y=Gt(t[30])))&&c(d,"d",y),(!_||p[0]&2)&&c(g,"style",t[1]),(!_||p[0]&32&&w!==(w=Gt(t[30])))&&c(g,"d",w),p[0]&268491048){j=Ht(t[30].rings);let f;for(f=0;f<j.length;f+=1){const m=hn(t,j,f);H[f]?(H[f].p(m,p),it(H[f],1)):(H[f]=mn(m),H[f].c(),it(H[f],1),H[f].m(e,null))}for(Wt(),f=j.length;f<H.length;f+=1)A(f);Kt()}},i(v){if(!_){for(let p=0;p<j.length;p+=1)it(H[p]);_=!0}},o(v){H=H.filter(Boolean);for(let p=0;p<H.length;p+=1)ht(H[p]);_=!1},d(v){v&&K(e),Y&&Y.d(),U&&U.d(),ce(H,v),k=!1,Nt(I)}}}function xn(t){let e,n;return e=new Pn({props:{x:t[29][0],y:t[29][1],scale:t[3]}}),e.$on("pointerdown",function(){gt(t[17](t[6]))&&t[17](t[6]).apply(this,arguments)}),{c(){Rt(e.$$.fragment)},m(r,i){$t(e,r,i),n=!0},p(r,i){t=r;const s={};i[0]&1088&&(s.x=t[29][0]),i[0]&1088&&(s.y=t[29][1]),i[0]&8&&(s.scale=t[3]),e.$set(s)},i(r){n||(it(e.$$.fragment,r),n=!0)},o(r){ht(e.$$.fragment,r),n=!1},d(r){bt(e,r)}}}function oi(t){let e,n,r,i=Ht(t[5].polygons),s=[];for(let l=0;l<i.length;l+=1)s[l]=gn(cn(t,i,l));const o=l=>ht(s[l],1,1,()=>{s[l]=null});let u=t[6]!==void 0&&!t[7]&&xn(ve(t));return{c(){for(let l=0;l<s.length;l+=1)s[l].c();e=Et(),u&&u.c(),n=se()},m(l,a){for(let h=0;h<s.length;h+=1)s[h]&&s[h].m(l,a);Q(l,e,a),u&&u.m(l,a),Q(l,n,a),r=!0},p(l,a){if(a[0]&268763114){i=Ht(l[5].polygons);let h;for(h=0;h<i.length;h+=1){const d=cn(l,i,h);s[h]?(s[h].p(d,a),it(s[h],1)):(s[h]=gn(d),s[h].c(),it(s[h],1),s[h].m(e.parentNode,e))}for(Wt(),h=i.length;h<s.length;h+=1)o(h);Kt()}l[6]!==void 0&&!l[7]?u?(u.p(ve(l),a),a[0]&192&&it(u,1)):(u=xn(ve(l)),u.c(),it(u,1),u.m(n.parentNode,n)):u&&(Wt(),ht(u,1,1,()=>{u=null}),Kt())},i(l){if(!r){for(let a=0;a<i.length;a+=1)it(s[a]);it(u),r=!0}},o(l){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)ht(s[a]);ht(u),r=!1},d(l){l&&(K(e),K(n)),ce(s,l),u&&u.d(l)}}}function ai(t){let e,n;return e=new ke({props:{shape:t[0],transform:t[2],editor:t[16],svgEl:t[4],$$slots:{default:[oi,({grab:r})=>({28:r}),({grab:r})=>[r?268435456:0]]},$$scope:{ctx:t}}}),e.$on("change",t[20]),e.$on("grab",t[21]),e.$on("release",t[22]),{c(){Rt(e.$$.fragment)},m(r,i){$t(e,r,i),n=!0},p(r,i){const s={};i[0]&1&&(s.shape=r[0]),i[0]&4&&(s.transform=r[2]),i[0]&16&&(s.svgEl=r[4]),i[0]&268437482|i[1]&128&&(s.$$scope={dirty:i,ctx:r}),e.$set(s)},i(r){n||(it(e.$$.fragment,r),n=!0)},o(r){ht(e.$$.fragment,r),n=!1},d(r){bt(e,r)}}}const ui=250,li=1e3,ie=4.5;function ci(t,e,n){let r,i,s;const o=Me();let{shape:u}=e,{computedStyle:l}=e,{transform:a}=e,{viewportScale:h=1}=e,{svgEl:d}=e,y,g=!1,w,_=[];const k=()=>n(7,g=!0),I=()=>n(7,g=!1),Y=E=>{if(_.length>0||!i.some(S=>S.visible)){n(6,y=void 0);return}const[P,b]=a.elementToImage(E.offsetX,E.offsetY),D=S=>Math.pow(S[0]-P,2)+Math.pow(S[1]-b,2),C=ur(r).reduce((S,M)=>D(M)<D(S)?M:S),F=i.filter(S=>S.visible).reduce((S,M)=>D(M.point)<D(S.point)?M:S),R=Math.pow(li/h,2);D(C)<R||D(F.point)<R?n(6,y=i.indexOf(F)):n(6,y=void 0)},U=()=>{document.activeElement!==d&&d.focus()},j=()=>{n(8,_=[]),U()},H=E=>{n(7,g=!0),E.preventDefault(),E.stopPropagation(),w=performance.now()},A=(E,P,b)=>D=>{if(!w||Ut||performance.now()-w>ui)return;const C=R=>R.polygon===E&&R.ring===P&&R.point===b,F=_.some(C);D.metaKey||D.ctrlKey||D.shiftKey?F?n(8,_=_.filter(R=>!C(R))):n(8,_=[..._,{polygon:E,ring:P,point:b}]):F&&_.length>1?n(8,_=[{polygon:E,ring:P,point:b}]):F?n(8,_=[]):n(8,_=[{polygon:E,ring:P,point:b}]),U()},v=(E,P,b)=>{U();const D=E.geometry.polygons;let C;if(P==="SHAPE")C=D.map(F=>{const R=F.rings.map((M,J)=>({points:M.points.map((V,at)=>[V[0]+b[0],V[1]+b[1]])})),S=Lt(R[0].points);return{rings:R,bounds:S}});else{const[F,R,S,M]=P.split("-").map(J=>parseInt(J));C=D.map((J,V)=>{if(V===R){const at=J.rings.map((W,tt)=>tt===S?{points:W.points.map((nt,X)=>X===M?[nt[0]+b[0],nt[1]+b[1]]:nt)}:W),xt=Lt(at[0].points);return{rings:at,bounds:xt}}else return J})}return{...E,geometry:{polygons:C,bounds:ye(C)}}},p=E=>async P=>{P.stopPropagation();const b=i[E],D=r.polygons.map((F,R)=>{if(R===b.elementIdx){const S=F.rings.map((J,V)=>V===b.ringIdx?{points:[...J.points.slice(0,b.pointIdx+1),b.point,...J.points.slice(b.pointIdx+1)]}:J),M=Lt(S[0].points);return{rings:S,bounds:M}}else return F});o("change",{...u,geometry:{polygons:D,bounds:ye(D)}}),await An();const C=[...document.querySelectorAll(".a9s-handle")][E+1];if(C!=null&&C.firstChild){const F=new PointerEvent("pointerdown",{bubbles:!0,cancelable:!0,clientX:P.clientX,clientY:P.clientY,pointerId:P.pointerId,pointerType:P.pointerType,isPrimary:P.isPrimary,buttons:P.buttons});C.firstChild.dispatchEvent(F)}},f=()=>{const E=r.polygons.map((P,b)=>{if(_.some(D=>D.polygon===b)){const D=P.rings.map((F,R)=>_.some(S=>S.polygon===b&&S.ring===R)&&F.points.length>3?{points:F.points.filter((S,M)=>!_.some(J=>J.polygon===b&&J.ring===R&&J.point===M))}:F),C=Lt(D[0].points);return{rings:D,bounds:C}}else return P});!Se(r.polygons,E)&&(o("change",{...u,geometry:{polygons:E,bounds:ye(E)}}),n(8,_=[]))};bn(()=>{if(Ut)return;const E=P=>{(P.key==="Delete"||P.key==="Backspace")&&(P.preventDefault(),f())};return d.addEventListener("pointermove",Y),d.addEventListener("keydown",E),()=>{d.removeEventListener("pointermove",Y),d.removeEventListener("keydown",E)}});const m=`polygon-mask-${Math.random().toString(36).substring(2,12)}`,$=(E,P,b,{polygon:D,ring:C,point:F})=>D===E&&C===P&&F===b;function T(E){vt.call(this,t,E)}function N(E){vt.call(this,t,E)}function O(E){vt.call(this,t,E)}return t.$$set=E=>{"shape"in E&&n(0,u=E.shape),"computedStyle"in E&&n(1,l=E.computedStyle),"transform"in E&&n(2,a=E.transform),"viewportScale"in E&&n(3,h=E.viewportScale),"svgEl"in E&&n(4,d=E.svgEl)},t.$$.update=()=>{t.$$.dirty[0]&1&&n(5,r=u.geometry),t.$$.dirty[0]&40&&n(10,i=Ut?[]:si(r,h)),t.$$.dirty[0]&40&&n(9,s=Le(r.bounds,ie/h))},[u,l,a,h,d,r,y,g,_,s,i,k,I,j,H,A,v,p,m,$,T,N,O]}class hi extends Jt{constructor(e){super(),Vt(this,e,ci,ai,Qt,{shape:0,computedStyle:1,transform:2,viewportScale:3,svgEl:4},null,[-1,-1])}}kt.RECTANGLE,kt.POLYGON,kt.MULTIPOLYGLON;typeof navigator>"u"||navigator.userAgent.indexOf("Mac OS X");var Ee={exports:{}},_n;function fi(){return _n||(_n=1,function(t){(function(){function e(u,l){var a=u.x-l.x,h=u.y-l.y;return a*a+h*h}function n(u,l,a){var h=l.x,d=l.y,y=a.x-h,g=a.y-d;if(y!==0||g!==0){var w=((u.x-h)*y+(u.y-d)*g)/(y*y+g*g);w>1?(h=a.x,d=a.y):w>0&&(h+=y*w,d+=g*w)}return y=u.x-h,g=u.y-d,y*y+g*g}function r(u,l){for(var a=u[0],h=[a],d,y=1,g=u.length;y<g;y++)d=u[y],e(d,a)>l&&(h.push(d),a=d);return a!==d&&h.push(d),h}function i(u,l,a,h,d){for(var y=h,g,w=l+1;w<a;w++){var _=n(u[w],u[l],u[a]);_>y&&(g=w,y=_)}y>h&&(g-l>1&&i(u,l,g,h,d),d.push(u[g]),a-g>1&&i(u,g,a,h,d))}function s(u,l){var a=u.length-1,h=[u[0]];return i(u,0,a,l,h),h.push(u[a]),h}function o(u,l,a){if(u.length<=2)return u;var h=l!==void 0?l*l:1;return u=a?u:r(u,h),u=s(u,h),u}t.exports=o,t.exports.default=o})()}(Ee)),Ee.exports}var pi=fi();const di=Tn(pi),yi=()=>{const t=r=>r.map(i=>{const{pixel_geometry:s,score:o,text:u}=i,l=zn.parse(s);if(l.type!=="Polygon")throw new Error(`Unsupported type: ${l.type}`);const a=l.coordinates[0].map(([y,g])=>({x:y,y:g})),h=di(a,1,!0).map(({x:y,y:g})=>[y,g]),d={type:kt.POLYGON,geometry:{bounds:Lt(h),points:h}};return{bodies:[{value:u},{purpose:"scoring",value:o}],target:{selector:d}}});return{read:r=>new Promise(i=>{De.parse(r,{header:!0,complete:s=>{const o=s.data.filter(({pixel_geometry:l})=>!!l),u=t(o);i(u)}})}),readFromURL:r=>new Promise(i=>{De.parse(r,{download:!0,header:!0,complete:s=>{const o=s.data.filter(({pixel_geometry:l})=>!!l),u=t(o);i(u)}})})}},mi=yi(),vn=10;window.onload=function(){const t=Un({id:"openseadragon",prefixUrl:"https://cdn.jsdelivr.net/npm/openseadragon@3.1/build/openseadragon/images/",gestureSettingsMouse:{clickToZoom:!1},tileSources:{type:"image",url:"maps/novus_atlas.jpg"},minZoomLevel:.1,maxZoomLevel:100}),e=document.getElementById("tooltip"),n=Hn(t,{userSelectAction:Dn.NONE,style:{stroke:"#00aa00",strokeOpacity:.7,fill:"#00ee00",fillOpacity:.18}});mi.readFromURL("maps/novus_atlas_predictions.csv").then(r=>n.setAnnotations(r)),document.body.addEventListener("pointermove",r=>{e.style.left=`${r.clientX+vn}px`,e.style.top=`${r.clientY+vn}px`}),n.on("mouseEnterAnnotation",function(r){var o,u;const i=(o=r.bodies.find(l=>!l.purpose))==null?void 0:o.value,s=(u=r.bodies.find(l=>l.purpose==="scoring"))==null?void 0:u.value;e.innerHTML=`${i} <span class="score">(${s})</span>`,e.style.display="block"}),n.on("mouseLeaveAnnotation",function(r){e.style.display="none"})};
